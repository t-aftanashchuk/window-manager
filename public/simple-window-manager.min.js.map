<<<<<<< HEAD
{"version":3,"file":"simple-window-manager.min.js","sources":["../src/html.js","../node_modules/eventemitter3/index.js","../node_modules/clicked/clicked.js","../src/Window.js","../src/images.js","../src/windowOptions.js","../src/Snap.js","../src/WindowManager.js"],"sourcesContent":["/**\r\n * shortcut to create an html element\r\n * @param {object} options\r\n * @param {type} [options.string=div]\r\n * @param {string} [options.className]\r\n * @param {object} [options.styles]\r\n * @param {HTMLElement} [options.parent]\r\n * @param {string} [options.html]\r\n * @param {[HTMLElement]} [options.childElements]\r\n * @returns {HTMLElement}\r\n */\r\nexport function html(options = {}) {\r\n    const object = document.createElement(options.type || 'div')\r\n    if (options.parent) {\r\n        options.parent.appendChild(object)\r\n    }\r\n    if (options.styles) {\r\n        Object.assign(object.style, options.styles)\r\n    }\r\n    if (options.className) {\r\n        object.className = options.className\r\n    }\r\n    if (options.html) {\r\n        object.innerHTML = options.html\r\n    }\r\n    if (options.childElements) {\r\n        if (!Array.isArray(options.childElements))\r\n            options.childElements = [options.childElements];\r\n\r\n        for (const child of options.childElements)\r\n            if (child) object.appendChild(child);\r\n    }\r\n    return object\r\n}","'use strict';\r\n\r\nvar has = Object.prototype.hasOwnProperty\r\n  , prefix = '~';\r\n\r\n/**\r\n * Constructor to create a storage for our `EE` objects.\r\n * An `Events` instance is a plain object whose properties are event names.\r\n *\r\n * @constructor\r\n * @private\r\n */\r\nfunction Events() {}\r\n\r\n//\r\n// We try to not inherit from `Object.prototype`. In some engines creating an\r\n// instance in this way is faster than calling `Object.create(null)` directly.\r\n// If `Object.create(null)` is not supported we prefix the event names with a\r\n// character to make sure that the built-in object properties are not\r\n// overridden or used as an attack vector.\r\n//\r\nif (Object.create) {\r\n  Events.prototype = Object.create(null);\r\n\r\n  //\r\n  // This hack is needed because the `__proto__` property is still inherited in\r\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\r\n  //\r\n  if (!new Events().__proto__) prefix = false;\r\n}\r\n\r\n/**\r\n * Representation of a single event listener.\r\n *\r\n * @param {Function} fn The listener function.\r\n * @param {*} context The context to invoke the listener with.\r\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\r\n * @constructor\r\n * @private\r\n */\r\nfunction EE(fn, context, once) {\r\n  this.fn = fn;\r\n  this.context = context;\r\n  this.once = once || false;\r\n}\r\n\r\n/**\r\n * Add a listener for a given event.\r\n *\r\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} context The context to invoke the listener with.\r\n * @param {Boolean} once Specify if the listener is a one-time listener.\r\n * @returns {EventEmitter}\r\n * @private\r\n */\r\nfunction addListener(emitter, event, fn, context, once) {\r\n  if (typeof fn !== 'function') {\r\n    throw new TypeError('The listener must be a function');\r\n  }\r\n\r\n  var listener = new EE(fn, context || emitter, once)\r\n    , evt = prefix ? prefix + event : event;\r\n\r\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\r\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\r\n  else emitter._events[evt] = [emitter._events[evt], listener];\r\n\r\n  return emitter;\r\n}\r\n\r\n/**\r\n * Clear event by name.\r\n *\r\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\r\n * @param {(String|Symbol)} evt The Event name.\r\n * @private\r\n */\r\nfunction clearEvent(emitter, evt) {\r\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\r\n  else delete emitter._events[evt];\r\n}\r\n\r\n/**\r\n * Minimal `EventEmitter` interface that is molded against the Node.js\r\n * `EventEmitter` interface.\r\n *\r\n * @constructor\r\n * @public\r\n */\r\nfunction EventEmitter() {\r\n  this._events = new Events();\r\n  this._eventsCount = 0;\r\n}\r\n\r\n/**\r\n * Return an array listing the events for which the emitter has registered\r\n * listeners.\r\n *\r\n * @returns {Array}\r\n * @public\r\n */\r\nEventEmitter.prototype.eventNames = function eventNames() {\r\n  var names = []\r\n    , events\r\n    , name;\r\n\r\n  if (this._eventsCount === 0) return names;\r\n\r\n  for (name in (events = this._events)) {\r\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\r\n  }\r\n\r\n  if (Object.getOwnPropertySymbols) {\r\n    return names.concat(Object.getOwnPropertySymbols(events));\r\n  }\r\n\r\n  return names;\r\n};\r\n\r\n/**\r\n * Return the listeners registered for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Array} The registered listeners.\r\n * @public\r\n */\r\nEventEmitter.prototype.listeners = function listeners(event) {\r\n  var evt = prefix ? prefix + event : event\r\n    , handlers = this._events[evt];\r\n\r\n  if (!handlers) return [];\r\n  if (handlers.fn) return [handlers.fn];\r\n\r\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\r\n    ee[i] = handlers[i].fn;\r\n  }\r\n\r\n  return ee;\r\n};\r\n\r\n/**\r\n * Return the number of listeners listening to a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Number} The number of listeners.\r\n * @public\r\n */\r\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\r\n  var evt = prefix ? prefix + event : event\r\n    , listeners = this._events[evt];\r\n\r\n  if (!listeners) return 0;\r\n  if (listeners.fn) return 1;\r\n  return listeners.length;\r\n};\r\n\r\n/**\r\n * Calls each of the listeners registered for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Boolean} `true` if the event had listeners, else `false`.\r\n * @public\r\n */\r\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\r\n  var evt = prefix ? prefix + event : event;\r\n\r\n  if (!this._events[evt]) return false;\r\n\r\n  var listeners = this._events[evt]\r\n    , len = arguments.length\r\n    , args\r\n    , i;\r\n\r\n  if (listeners.fn) {\r\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\r\n\r\n    switch (len) {\r\n      case 1: return listeners.fn.call(listeners.context), true;\r\n      case 2: return listeners.fn.call(listeners.context, a1), true;\r\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\r\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\r\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\r\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\r\n    }\r\n\r\n    for (i = 1, args = new Array(len -1); i < len; i++) {\r\n      args[i - 1] = arguments[i];\r\n    }\r\n\r\n    listeners.fn.apply(listeners.context, args);\r\n  } else {\r\n    var length = listeners.length\r\n      , j;\r\n\r\n    for (i = 0; i < length; i++) {\r\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\r\n\r\n      switch (len) {\r\n        case 1: listeners[i].fn.call(listeners[i].context); break;\r\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\r\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\r\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\r\n        default:\r\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\r\n            args[j - 1] = arguments[j];\r\n          }\r\n\r\n          listeners[i].fn.apply(listeners[i].context, args);\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n/**\r\n * Add a listener for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} [context=this] The context to invoke the listener with.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.on = function on(event, fn, context) {\r\n  return addListener(this, event, fn, context, false);\r\n};\r\n\r\n/**\r\n * Add a one-time listener for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} [context=this] The context to invoke the listener with.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.once = function once(event, fn, context) {\r\n  return addListener(this, event, fn, context, true);\r\n};\r\n\r\n/**\r\n * Remove the listeners of a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn Only remove the listeners that match this function.\r\n * @param {*} context Only remove the listeners that have this context.\r\n * @param {Boolean} once Only remove one-time listeners.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\r\n  var evt = prefix ? prefix + event : event;\r\n\r\n  if (!this._events[evt]) return this;\r\n  if (!fn) {\r\n    clearEvent(this, evt);\r\n    return this;\r\n  }\r\n\r\n  var listeners = this._events[evt];\r\n\r\n  if (listeners.fn) {\r\n    if (\r\n      listeners.fn === fn &&\r\n      (!once || listeners.once) &&\r\n      (!context || listeners.context === context)\r\n    ) {\r\n      clearEvent(this, evt);\r\n    }\r\n  } else {\r\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\r\n      if (\r\n        listeners[i].fn !== fn ||\r\n        (once && !listeners[i].once) ||\r\n        (context && listeners[i].context !== context)\r\n      ) {\r\n        events.push(listeners[i]);\r\n      }\r\n    }\r\n\r\n    //\r\n    // Reset the array, or remove it completely if we have no more listeners.\r\n    //\r\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\r\n    else clearEvent(this, evt);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove all listeners, or those of the specified event.\r\n *\r\n * @param {(String|Symbol)} [event] The event name.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\r\n  var evt;\r\n\r\n  if (event) {\r\n    evt = prefix ? prefix + event : event;\r\n    if (this._events[evt]) clearEvent(this, evt);\r\n  } else {\r\n    this._events = new Events();\r\n    this._eventsCount = 0;\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n//\r\n// Alias methods names because people roll like that.\r\n//\r\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\r\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\r\n\r\n//\r\n// Expose the prefix.\r\n//\r\nEventEmitter.prefixed = prefix;\r\n\r\n//\r\n// Allow `EventEmitter` to be imported as module namespace.\r\n//\r\nEventEmitter.EventEmitter = EventEmitter;\r\n\r\n//\r\n// Expose the module.\r\n//\r\nif ('undefined' !== typeof module) {\r\n  module.exports = EventEmitter;\r\n}\r\n","/**\r\n * Watcher for click, double-click, or long-click event for both mouse and touch\r\n * @example\r\n * import { clicked } from 'clicked'\r\n *\r\n * function handleClick()\r\n * {\r\n *    console.log('I was clicked.')\r\n * }\r\n *\r\n * const div = document.getElementById('clickme')\r\n * const c = clicked(div, handleClick, { threshold: 15 })\r\n *\r\n * // change callback\r\n * c.callback = () => console.log('different clicker')\r\n *\r\n * // destroy\r\n * c.destroy()\r\n *\r\n * // using built-in querySelector\r\n * clicked('#clickme', handleClick2)\r\n *\r\n * // watching for all types of clicks\r\n * function handleAllClicks(e) {\r\n *     switch (e.type)\r\n *     {\r\n *         case 'clicked': ...\r\n *         case 'double-clicked': ...\r\n *         case 'long-clicked': ...\r\n *     }\r\n *\r\n *     // view UIEvent that caused callback\r\n *     console.log(e.event)\r\n * }\r\n * clicked('#clickme', handleAllClicks, { doubleClicked: true, longClicked: true })\r\n */\r\n\r\n/** @type {object} */\r\nconst defaultOptions = {\r\n    threshold: 10,\r\n    clicked: true,\r\n    doubleClicked: false,\r\n    doubleClickedTime: 300,\r\n    longClicked: false,\r\n    longClickedTime: 500,\r\n    capture: false,\r\n    clickDown: false\r\n}\r\n\r\n/**\r\n * @param {HTMLElement|string} element or querySelector entry (e.g., #id-name or .class-name)\r\n * @param {ClickedCallback} callback called after a click, double click, or long click is registered\r\n * @param {object} [options]\r\n * @param {number} [options.threshold=10] if touch moves threshhold-pixels then the touch-click is cancelled\r\n * @param {boolean} [options.clicked=true] disable watcher for default clicked event\r\n * @param {boolean} [options.doubleClicked] enable watcher for double click\r\n * @param {number} [options.doubleClickedTime=500] wait time in millseconds for double click\r\n * @param {boolean} [options.longClicked] enable watcher for long click\r\n * @param {number} [options.longClickedTime=500] wait time for long click\r\n * @param {boolean} [options.clickDown] enable watcher for click start\r\n * @param {boolean} [options.capture]  events will be dispatched to this registered listener before being dispatched to any EventTarget beneath it in the DOM tree\r\n * @returns {Clicked}\r\n */\r\nexport function clicked(element, callback, options)\r\n{\r\n    return new Clicked(element, callback, options)\r\n}\r\n\r\nclass Clicked\r\n{\r\n    constructor(element, callback, options)\r\n    {\r\n        if (typeof element === 'string')\r\n        {\r\n            element = document.querySelector(element)\r\n            if (!element)\r\n            {\r\n                console.warn(`Unknown element: document.querySelector(${element}) in clicked()`)\r\n                return\r\n            }\r\n        }\r\n        this.options = Object.assign({}, defaultOptions, options)\r\n        this.events = {\r\n            mousedown: (e) => this.mousedown(e),\r\n            mouseup: (e) => this.mouseup(e),\r\n            mousemove: (e) => this.mousemove(e),\r\n            touchstart: (e) => this.touchstart(e),\r\n            touchmove: (e) => this.touchmove(e),\r\n            touchcancel: (e) => this.cancel(e),\r\n            touchend: (e) => this.touchend(e)\r\n        }\r\n        element.addEventListener('mousedown', this.events.mousedown, { capture: this.options.capture })\r\n        element.addEventListener('mouseup', this.events.mouseup, { capture: this.options.capture })\r\n        element.addEventListener('mousemove', this.events.mousemove, { capture: this.options.capture })\r\n        element.addEventListener('touchstart', this.events.touchstart, { passive: true, capture: this.options.capture })\r\n        element.addEventListener('touchmove', this.events.touchmove, { passive: true, capture: this.options.capture })\r\n        element.addEventListener('touchcancel', this.events.touchcancel, { capture: this.options.capture})\r\n        element.addEventListener('touchend', this.events.touchend, { capture: this.options.capture })\r\n        this.element = element\r\n        this.callback = callback\r\n    }\r\n\r\n    /**\r\n     * removes event listeners added by Clicked\r\n     */\r\n    destroy()\r\n    {\r\n        this.element.removeEventListener('mousedown', this.events.mousedown)\r\n        this.element.removeEventListener('mouseup', this.events.mouseup)\r\n        this.element.removeEventListener('mousemove', this.events.mousemove)\r\n        this.element.removeEventListener('touchstart', this.events.touchstart, { passive: true })\r\n        this.element.removeEventListener('touchmove', this.events.touchmove, { passive: true })\r\n        this.element.removeEventListener('touchcancel', this.events.touchcancel)\r\n        this.element.removeEventListener('touchend', this.events.touchend)\r\n    }\r\n\r\n    touchstart(e)\r\n    {\r\n        if (this.down === true)\r\n        {\r\n            this.cancel()\r\n        }\r\n        else\r\n        {\r\n            if (e.touches.length === 1)\r\n            {\r\n                this.handleDown(e.changedTouches[0].screenX, e.changedTouches[0].screenY)\r\n            }\r\n        }\r\n    }\r\n\r\n    pastThreshold(x, y)\r\n    {\r\n        return Math.abs(this.lastX - x) > this.options.threshold || Math.abs(this.lastY - y) > this.options.threshold\r\n    }\r\n\r\n    touchmove(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            if (e.touches.length !== 1)\r\n            {\r\n                this.cancel()\r\n            }\r\n            else\r\n            {\r\n                const x = e.changedTouches[0].screenX\r\n                const y = e.changedTouches[0].screenY\r\n                if (this.pastThreshold(x, y))\r\n                {\r\n                    this.cancel()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** cancel current event */\r\n    cancel()\r\n    {\r\n        this.down = false\r\n        if (this.doubleClickedTimeout)\r\n        {\r\n            clearTimeout(this.doubleClickedTimeout)\r\n            this.doubleClickedTimeout = null\r\n        }\r\n        if (this.longClickedTimeout)\r\n        {\r\n            clearTimeout(this.longClickedTimeout)\r\n            this.longClickedTimeout = null\r\n        }\r\n    }\r\n\r\n    touchend(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            e.preventDefault()\r\n            this.handleClicks(e, e.pointerId)\r\n        }\r\n    }\r\n\r\n    handleClicks(e)\r\n    {\r\n        if (this.options.doubleClicked)\r\n        {\r\n            this.doubleClickedTimeout = setTimeout(() => this.doubleClickedCancel(e), this.options.doubleClickedTime)\r\n        }\r\n        else if (this.options.clicked)\r\n        {\r\n            this.callback({ event: e, type: 'clicked' })\r\n        }\r\n        if (this.longClickedTimeout)\r\n        {\r\n            clearTimeout(this.longClickedTimeout)\r\n            this.longClickedTimeout = null\r\n        }\r\n        this.down = false\r\n    }\r\n\r\n    handleDown(e, x, y)\r\n    {\r\n        if (this.doubleClickedTimeout)\r\n        {\r\n            if (this.pastThreshold(x, y))\r\n            {\r\n                if (this.options.clicked)\r\n                {\r\n                    this.callback({ event: e, type: 'clicked' })\r\n                }\r\n                this.cancel()\r\n            }\r\n            else\r\n            {\r\n                this.callback({ event: e, type: 'double-clicked' })\r\n                this.cancel()\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.lastX = x\r\n            this.lastY = y\r\n            this.down = true\r\n            if (this.options.longClicked)\r\n            {\r\n                this.longClickedTimeout = setTimeout(() => this.longClicked(e), this.options.longClickedTime)\r\n            }\r\n            if (this.options.clickDown) {\r\n                this.callback({ event: e, type: 'click-down' })\r\n            }\r\n        }\r\n    }\r\n\r\n    longClicked(e)\r\n    {\r\n        this.longClikedTimeout = null\r\n        this.down = false\r\n        this.callback({ event: e, type: 'long-clicked' })\r\n    }\r\n\r\n    doubleClickedCancel(e)\r\n    {\r\n        this.doubleClickedTimeout = null\r\n        if (this.options.clicked)\r\n        {\r\n            this.callback({ event: e, type: 'double-clicked' })\r\n        }\r\n    }\r\n\r\n    mousedown(e)\r\n    {\r\n        if (this.down === true)\r\n        {\r\n            this.down = false\r\n        }\r\n        else\r\n        {\r\n            this.handleDown(e, e.screenX, e.screenY)\r\n        }\r\n    }\r\n\r\n    mousemove(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            const x = e.screenX\r\n            const y = e.screenY\r\n            if (this.pastThreshold(x, y))\r\n            {\r\n                this.cancel()\r\n            }\r\n        }\r\n    }\r\n\r\n    mouseup(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            e.preventDefault()\r\n            this.handleClicks(e)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Callback for\r\n * @callback Clicked~ClickedCallback\r\n * @param {UIEvent} event\r\n * @param {('clicked'|'double-clicked'|'long-clicked'|'click-down')} type\r\n */","import Events from 'eventemitter3'\r\nimport { clicked } from 'clicked'\r\n\r\nimport { html } from './html'\r\n\r\n\r\nconst ResizeDirections = {\r\n    Up: 'up',\r\n    Down: 'down',\r\n    Left: 'left',\r\n    Right: 'right',\r\n}\r\n\r\nconst demoHeaderStyles = {\r\n    'user-select': 'none',\r\n    'display': 'flex',\r\n    'flex-direction': 'row',\r\n    'align-items': 'center',\r\n    'justify-content': 'space-between',\r\n    'backgroundColor': 'yellowgreen',\r\n    'border': 0,\r\n    'padding': '0 8px',\r\n    'overflow': 'hidden',\r\n}\r\n\r\nconst demoButtonStyles = {\r\n    'display': 'inline-block',\r\n    'border': 0,\r\n    'margin': 0,\r\n    'margin-left': '15px',\r\n    'padding': 0,\r\n    'width': '12px',\r\n    'height': '12px',\r\n    'background-color': 'transparent',\r\n    'background-size': 'cover',\r\n    'background-repeat': 'no-repeat',\r\n    'opacity': .7,\r\n    'outline': 0\r\n}\r\n\r\nconst demoControlButtonsStyles = {\r\n    'display': 'flex',\r\n    'flex-direction': 'row',\r\n    'align-items': 'center',\r\n    'padding-left': '10px'\r\n}\r\n\r\nconst RESIZE_PREFIX = 'resize'\r\n\r\n/**\r\n * Window class returned by WindowManager.createWindow()\r\n * @extends EventEmitter\r\n * @fires open\r\n * @fires focus\r\n * @fires blur\r\n * @fires close\r\n * @fires maximize\r\n * @fires maximize-restore\r\n * @fires move\r\n * @fires move-start\r\n * @fires move-end\r\n * @fires resize\r\n * @fires resize-start\r\n * @fires resize-end\r\n * @fires move-x\r\n * @fires move-y\r\n * @fires resize-width\r\n * @fires resize-height\r\n */\r\nexport class Window extends Events {\r\n    /**\r\n     * @param {WindowManager} [wm]\r\n     * @param {object} [options]\r\n     */\r\n    constructor(wm, options = {}) {\r\n        super()\r\n        this.wm = wm\r\n        this.options = options\r\n        this.id = typeof this.options.id === 'undefined' ? Window.id++ : this.options.id\r\n        this._createWindow()\r\n        this._listeners()\r\n\r\n        this.active = false\r\n        this.maximized = false\r\n\r\n        this._closed = true\r\n        this._restore = null\r\n        this._moving = null\r\n        this._prevPosition = null\r\n        this._resizing = null\r\n        this._attachedToScreen = { vertical: '', horziontal: '' }\r\n        this.verticalResize = false;\r\n        this.horizontalResize = false;\r\n    }\r\n\r\n    /**\r\n     * open the window\r\n     * @param {boolean} [noFocus] do not focus window when opened\r\n     */\r\n    open(noFocus) {\r\n        if (this._closed) {\r\n            this.win.style.display = 'block'\r\n            this._closed = false\r\n            this.emit('open', this)\r\n            if (!noFocus) {\r\n                this.focus()\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * focus the window\r\n     */\r\n    focus() {\r\n        this.active = true\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarActive\r\n        }\r\n        this.emit('focus', this)\r\n    }\r\n\r\n    /**\r\n     * blur the window\r\n     */\r\n    blur() {\r\n        this.active = false\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarInactive\r\n        }\r\n        this.emit('blur', this)\r\n    }\r\n\r\n    /**\r\n     * closes the window (can be reopened with open)\r\n     */\r\n    close() {\r\n        if (!this._closed) {\r\n            this._closed = true\r\n            this.win.style.display = 'none'\r\n            this.emit('close', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * is window closed?\r\n     * @type {boolean}\r\n     * @readonly\r\n     */\r\n    get closed() {\r\n        return this._closed\r\n    }\r\n\r\n    /**\r\n     * left coordinate\r\n     * @type {number}\r\n     */\r\n    get x() { return this.options.x }\r\n    set x(value) {\r\n        if (value !== this.options.x) {\r\n            this.options.x = value\r\n            this.emit('move-x', this)\r\n            this._buildTransform()\r\n        }\r\n    }\r\n\r\n    _buildTransform() {\r\n        this.win.style.transform = `translate(${this.options.x}px,${this.options.y}px)`\r\n    }\r\n\r\n    /**\r\n     * top coordinate\r\n     * @type {number}\r\n     */\r\n    get y() { return this.options.y }\r\n    set y(value) {\r\n        if (value !== this.options.y) {\r\n            this.options.y = value\r\n            this._buildTransform()\r\n            this.emit('move-y', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * width of window\r\n     * @type {number}\r\n     */\r\n    get width() { return this.options.width || this.win.offsetWidth }\r\n    set width(value) {\r\n        if (value !== this.options.width) {\r\n            if (value) {\r\n                this.win.style.width = `${value}px`\r\n                this.options.width = this.win.offsetWidth\r\n            }\r\n            else {\r\n                this.win.style.width = 'auto'\r\n                this.options.width = ''\r\n            }\r\n            this.emit('resize-width', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * height of window\r\n     * @type {number}\r\n     */\r\n    get height() { return this.options.height || this.win.offsetHeight }\r\n    set height(value) {\r\n        if (value !== this.options.height) {\r\n            if (value) {\r\n                this.win.style.height = `${value}px`\r\n                this.options.height = this.win.offsetHeight\r\n            }\r\n            else {\r\n                this.win.style.height = 'auto'\r\n                this.options.height = ''\r\n            }\r\n            this.emit('resize-height', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * resize the window\r\n     * @param {number} width\r\n     * @param {number} height\r\n     */\r\n    resize(width, height) {\r\n        this.width = width\r\n        this.height = height\r\n    }\r\n\r\n    /**\r\n     * move window\r\n     * @param {number} x\r\n     * @param {number} y\r\n     */\r\n    move(x, y) {\r\n        const keepInside = this.keepInside\r\n        if (keepInside) {\r\n            const bounds = this.bounds\r\n            if (keepInside === true || keepInside === 'horizontal') {\r\n                x = x + this.width > bounds.right ? bounds.right - this.width : x\r\n                x = x < bounds.left ? bounds.left : x\r\n            }\r\n            if (keepInside === true || keepInside === 'vertical') {\r\n                y = y + this.height > bounds.bottom ? bounds.bottom - this.height : y\r\n                y = y < bounds.top ? bounds.top : y\r\n            }\r\n        }\r\n        if (x !== this.options.x) {\r\n            this.options.x = x\r\n            this.emit('move-x', this)\r\n        }\r\n        if (y !== this.options.y) {\r\n            this.options.y = y\r\n            this.emit('move-y', this)\r\n        }\r\n        this._buildTransform()\r\n    }\r\n\r\n    /**\r\n     * maximize the window\r\n     */\r\n    maximize() {\r\n        if (this.options.maximizable) {\r\n            if (this.maximized) {\r\n                this.x = this.maximized.x\r\n                this.y = this.maximized.y\r\n                this.width = this.maximized.width\r\n                this.height = this.maximized.height\r\n                this.maximized = null\r\n                this.emit('restore', this)\r\n                this.buttons.maximize.innerHTML = this.options.maximizeButton\r\n            }\r\n            else {\r\n                const x = this.x, y = this.y, width = this.win.offsetWidth, height = this.win.offsetHeight\r\n                this.maximized = { x, y, width, height }\r\n                this.x = 0\r\n                this.y = 0\r\n                this.width = this.wm.overlay.offsetWidth\r\n                this.height = this.wm.overlay.offsetHeight\r\n                this.emit('maximize', this)\r\n                this.buttons.maximize.innerHTML = this.options.restoreButton\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * sends window to back of window-manager\r\n     */\r\n    sendToBack() {\r\n        this.wm.sendToBack(this)\r\n    }\r\n\r\n    /**\r\n     * send window to front of window-manager\r\n     */\r\n    sendToFront() {\r\n        this.wm.sendToFront(this)\r\n    }\r\n\r\n    /**\r\n     * save the state of the window\r\n     * @return {object} data\r\n     */\r\n    save() {\r\n        const data = {}\r\n        const maximized = this.maximized\r\n        if (maximized) {\r\n            data.maximized = { left: maximized.left, top: maximized.top, width: maximized.width, height: maximized.height }\r\n        }\r\n        data.x = this.x\r\n        data.y = this.y\r\n        if (typeof this.options.width !== 'undefined') {\r\n            data.width = this.options.width\r\n        }\r\n        if (typeof this.options.height !== 'undefined') {\r\n            data.height = this.options.height\r\n        }\r\n        data.closed = this._closed\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * return the state of the window\r\n     * @param {object} data from save()\r\n     */\r\n    load(data) {\r\n        if (data.maximized) {\r\n            if (!this.maximized) {\r\n                this.maximize(true)\r\n            }\r\n        }\r\n        else if (this.maximized) {\r\n            this.maximize(true)\r\n        }\r\n        this.x = data.x\r\n        this.y = data.y\r\n        if (typeof data.width !== 'undefined') {\r\n            this.width = data.width\r\n        }\r\n        else {\r\n            this.win.style.width = 'auto'\r\n        }\r\n        if (typeof data.height !== 'undefined') {\r\n            this.height = data.height\r\n        }\r\n        else {\r\n            this.win.style.height = 'auto'\r\n        }\r\n        if (data.closed) {\r\n            this.close(true)\r\n        }\r\n        else if (this.closed) {\r\n            this.open(true, true)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * change title\r\n     * @type {string}\r\n     */\r\n    get title() { return this._title }\r\n    set title(value) {\r\n        this.winTitle.innerText = value\r\n        this.emit('title-change', this)\r\n    }\r\n\r\n\r\n    /**\r\n     * right coordinate of window\r\n     * @type {number}\r\n     */\r\n    get right() { return this.x + this.width }\r\n    set right(value) {\r\n        this.x = value - this.width\r\n    }\r\n\r\n    /**\r\n     * bottom coordinate of window\r\n     * @type {number}\r\n     */\r\n    get bottom() { return this.y + this.height }\r\n    set bottom(value) {\r\n        this.y = value - this.height\r\n    }\r\n\r\n    /**\r\n     * centers window in middle of other window or document.body\r\n     * @param {Window} [win]\r\n     */\r\n    center(win) {\r\n        if (win) {\r\n            this.move(\r\n                win.x + win.width / 2 - this.width / 2,\r\n                win.y + win.height / 2 - this.height / 2\r\n            )\r\n        }\r\n        else {\r\n            this.move(\r\n                window.innerWidth / 2 - this.width / 2,\r\n                window.innerHeight / 2 - this.height / 2\r\n            )\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fires when window is maximized\r\n     * @event Window#maximize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window is restored to normal after being maximized\r\n     * @event Window#maximize-restore\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window opens\r\n     * @event Window#open\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window gains focus\r\n     * @event Window#focus\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window loses focus\r\n     * @event Window#blur\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window closes\r\n     * @event Window#close\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when resize starts\r\n     * @event Window#resize-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after resize completes\r\n     * @event Window#resize-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during resizing\r\n     * @event Window#resize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when move starts\r\n     * @event Window#move-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after move completes\r\n     * @event Window#move-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during move\r\n     * @event Window#move\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when width is changed\r\n     * @event Window#resize-width\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when height is changed\r\n     * @event Window#resize-height\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when x position of window is changed\r\n     * @event Window#move-x\r\n     * @type {Window}\r\n     */\r\n\r\n\r\n    /**\r\n     * Fires when y position of window is changed\r\n     * @event Window#move-y\r\n     * @type {Window}\r\n     */\r\n\r\n    _createWindow() {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        const winStyles = {\r\n            'user-select': 'none',\r\n            'overflow': 'hidden',\r\n            'position': 'absolute',\r\n            'min-width': this.options.minWidth,\r\n            'min-height': this.options.minHeight,\r\n            'width': isNaN(this.options.width) ? this.options.width : this.options.width + 'px',\r\n            'height': isNaN(this.options.height) ? this.options.height : this.options.height + 'px',\r\n            ...this.options.styles\r\n        }\r\n\r\n        this.win = html({\r\n            parent: (this.wm ? this.wm.win : null), \r\n            styles: winStyles,\r\n            className: this.options.classNames.win \r\n                ? this.options.classNames.win + ' frame'\r\n                : 'frame'\r\n        })\r\n\r\n        this.winBox = html({\r\n            parent: this.win, styles: {\r\n                'display': 'flex',\r\n                'flex-direction': 'column',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'min-height': this.options.minHeight,\r\n                'background-color': this.options.demo ? 'white' : null\r\n            },\r\n            className: this.options.classNames.winBox \r\n                ? this.options.classNames.winBox  + ' container'\r\n                : 'container'\r\n        })\r\n        this._createTitlebar()\r\n\r\n        /**\r\n         * This is the content DOM element. Use this to add content to the Window.\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.content = html({\r\n            parent: this.winBox, type: 'section', styles: {\r\n                'min-height': this.minHeight,\r\n                'overflow-x': 'hidden',\r\n                'overflow-y': 'auto'\r\n            },\r\n            className: this.options.classNames.content\r\n        })\r\n\r\n        if (this.options.resizable) {\r\n            this._createResize()\r\n        }\r\n\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'display': 'none',\r\n                'position': 'absolute',\r\n                'left': 0,\r\n                'top': 0,\r\n                'width': '100%',\r\n                'height': '100%'\r\n            },\r\n            className: this.options.classNames.overlay\r\n        })\r\n        this.overlay.addEventListener('mousedown', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this.overlay.addEventListener('touchstart', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this._buildTransform()\r\n    }\r\n\r\n    _downTitlebar(e) {\r\n        const event = this._convertMoveEvent(e)\r\n        this._moving = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n        this.emit('move-start', this)\r\n        this._moved = false\r\n    }\r\n\r\n    _createTitlebar() {\r\n        const headerStyles = {\r\n            'user-select': 'none',\r\n            'display': 'flex',\r\n            'flex-direction': 'row',\r\n            'overflow': 'hidden',\r\n            'height': this.options.titlebarHeight,\r\n            'min-height': this.options.titlebarHeight,\r\n        }\r\n\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar = html({\r\n                parent: this.winBox, type: 'header', \r\n                styles: this.options.demo ? demoHeaderStyles : headerStyles, // DEVELOP\r\n                className: this.options.classNames.titlebar\r\n            })\r\n\r\n            this.frameManager = html({\r\n                parent: this.winTitlebar,\r\n                className: 'frame-manager',\r\n                childElements: [this.options.frameManager],\r\n            });\r\n\r\n            this.headerTitle = html({\r\n                parent: this.winTitlebar,\r\n                html: this.options.title, \r\n                className: 'title',\r\n            });\r\n\r\n            this.headerToolbar = html({\r\n                parent: this.winTitlebar,\r\n                className: 'tool-bar',\r\n                childElements: this.options.toolbarInstruments,\r\n            });\r\n\r\n            this._createButtons()\r\n\r\n            if (this.options.movable) {\r\n                this.winTitlebar.addEventListener('mousedown', (e) => this._downTitlebar(e))\r\n                this.winTitlebar.addEventListener('touchstart', (e) => this._downTitlebar(e))\r\n            }\r\n            if (this.options.maximizable) {\r\n                clicked(this.winTitlebar, () => this.maximize(), { doubleClicked: true, clicked: false })\r\n            }\r\n        }\r\n    }\r\n\r\n    _createButtons() {\r\n\r\n        this.winButtonGroup = html({\r\n            parent: this.winTitlebar,\r\n            className: 'control-bar',\r\n            styles: this.options.demo ? demoControlButtonsStyles : null, // DEVELOP\r\n        });\r\n\r\n        this.buttons = {}\r\n\r\n        if (this.options.minimizable) {\r\n            this.buttons.minimize = html({ \r\n                parent: this.winButtonGroup, \r\n                type: 'i', \r\n                className: this.options.minimizeIconClass ? this.options.minimizeIconClass : 'icon-minimize-window',\r\n                styles: this.options.demo ? demoButtonStyles : null, // DEVELOP\r\n            })\r\n            clicked(this.buttons.minimize, () => this.minimize())\r\n        }\r\n\r\n        if (this.options.maximizable) {\r\n            this.buttons.maximize = html({ \r\n                parent: this.winButtonGroup, \r\n                className: this.options.maximizeIconClass ? this.options.maximizeIconClass : 'icon-maximize-window',\r\n                styles: this.options.demo ? demoButtonStyles : null, // DEVELOP\r\n                html: this.options.demo ? this.options.maximizeButton : null, \r\n                type: this.options.demo ? 'button' : 'i',\r\n            })\r\n            clicked(this.buttons.maximize, () => this.maximize())\r\n        }\r\n\r\n        if (this.options.closable) {\r\n            this.buttons.close = html({ \r\n                parent: this.winButtonGroup, \r\n                className: this.options.closeIconClass ? this.options.closeIconClass : 'icon-close-window',\r\n                styles: this.options.demo ? demoButtonStyles : null, // DEVELOP\r\n                html: this.options.demo ? this.options.closeButton : null, \r\n                type: this.options.demo ? 'button' : 'i',\r\n            })\r\n            clicked(this.buttons.close, () => this.close())\r\n        }\r\n\r\n        for (let key in this.buttons) {\r\n            const button = this.buttons[key]\r\n            button.addEventListener('mousemove', () => {\r\n                button.style.opacity = 1\r\n            })\r\n            button.addEventListener('mouseout', () => {\r\n                button.style.opacity = 0.7\r\n            })\r\n        }\r\n    }\r\n\r\n    _createResize() {\r\n        // this.resizeEdge = html({\r\n        //     parent: this.winBox, type: 'button', html: this.options.backgroundResize, styles: {\r\n        //         'position': 'absolute',\r\n        //         'bottom': 0,\r\n        //         'right': '4px',\r\n        //         'border': 0,\r\n        //         'margin': 0,\r\n        //         'padding': 0,\r\n        //         'cursor': 'se-resize',\r\n        //         'user-select': 'none',\r\n        //         'height': '15px',\r\n        //         'width': '10px',\r\n        //         'background': 'none'\r\n        //     },\r\n        //     className: this.options.classNames.resizeEdge\r\n        // })\r\n        // const resize = e => {\r\n        //     if (!this.verticalResize && !this.horizontalResize)\r\n        //         return;\r\n\r\n        //     const event = this._convertMoveEvent(e);\r\n        //     // const width = this.width || this.win.offsetWidth;\r\n        //     // const height = this.height || this.win.offsetHeight;\r\n        //     // const newWidth = width - event.pageX;\r\n        //     // const newHeight = height - event.pageY;\r\n\r\n        //     // this._resizing = {\r\n        //     //     width: newWidth,\r\n        //     //     height: newHeight,\r\n        //     // }\r\n\r\n        //     // this._resizing = {\r\n        //     //     height: event.pageY,\r\n        //     //     width: event.pageX,\r\n        //     // };\r\n\r\n        //     // let x = null;\r\n        //     // let y = null;\r\n\r\n        //     if (this.horizontalResize === ResizeDirections.Left || this.horizontalResize === ResizeDirections.Top) {\r\n        //         // x = event.pageX - this.x;\r\n        //         this._moving = {\r\n        //             x: event.pageX,\r\n        //             y: event.pageY,\r\n        //         }\r\n\r\n        //     }\r\n\r\n        //     // if (this.horizontalResize === ResizeDirections.Top) {\r\n        //     //     // y = event.pageY - this.y;\r\n        //     // }\r\n\r\n        //     // // this._moving = {\r\n        //     // //     x: event.pageX - this.x,\r\n        //     // //     y: event.pageY - this.y\r\n        //     // // }\r\n\r\n        //     // // this._moving = { x, y };\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // }\r\n\r\n        // this.winBox.addEventListener('mousedown', resize)\r\n        // this.winBox.addEventListener('touchstart', resize)\r\n        // this.winBox.addEventListener('mousemove', (e) => {\r\n        //     const event = this._convertMoveEvent(e)\r\n        //     const up = Math.abs(event.pageY - this.y) < 13;\r\n        //     const down = Math.abs(event.pageY - (this.y + this.height)) < 13;\r\n        //     const left = Math.abs(event.pageX - this.x) < 13;\r\n        //     const right = Math.abs(event.pageX - (this.x + this.width)) < 13;\r\n\r\n        //     if (up) {\r\n        //         this.verticalResize = ResizeDirections.Up;\r\n        //     } else if (down) {\r\n        //         this.verticalResize = ResizeDirections.Down;\r\n        //     } else {\r\n        //         this.verticalResize = null;\r\n        //     }\r\n\r\n        //     if (left) {\r\n        //         this.horizontalResize = ResizeDirections.Left;\r\n        //     } else if (right) {\r\n        //         this.horizontalResize = ResizeDirections.Right;\r\n        //     } else {\r\n        //         this.horizontalResize = null;\r\n        //     }\r\n\r\n        //     if (this.verticalResize || this.horizontalResize) {\r\n        //         const newClass = [RESIZE_PREFIX, this.verticalResize, this.horizontalResize].filter(Boolean).join('-');\r\n        //         if (this.win.className.includes(RESIZE_PREFIX))\r\n        //             this.win.className = this.win.className.replace(/resize-.*/gi, newClass);\r\n        //         else\r\n        //             this.win.className += ` ${newClass}`;\r\n        //     } else {\r\n        //         this.win.className = this.win.className.replace(/resize-.*\\s/gi, '');\r\n        //     }\r\n\r\n        //     // console.log('down', this.win.className);\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // })\r\n    }\r\n\r\n    _getHitTestState(event, prevResizingState) {\r\n        const offset = prevResizingState ? 10000 : 10;\r\n        const up = Math.abs(event.pageY - this.y) < offset;\r\n        const down = Math.abs(event.pageY - (this.y + this.height)) < offset;\r\n        const left = Math.abs(event.pageX - this.x) < offset;\r\n        const right = Math.abs(event.pageX - (this.x + this.width)) < offset;\r\n\r\n        let horizontal;\r\n        let vertical;\r\n\r\n        if (up) {\r\n            vertical = ResizeDirections.Up;\r\n        } else if (down) {\r\n            vertical = ResizeDirections.Down;\r\n        } else {\r\n            vertical = null;\r\n        }\r\n\r\n        if (left) {\r\n            horizontal = ResizeDirections.Left;\r\n        } else if (right) {\r\n            horizontal = ResizeDirections.Right;\r\n        } else {\r\n            horizontal = null;\r\n        }\r\n\r\n        if (horizontal || vertical) {\r\n            return prevResizingState || {\r\n                horizontal,\r\n                vertical,\r\n            }\r\n        }\r\n\r\n        var _offset = prevResizingState ? 10000 : 0;\r\n\r\n        if (\r\n            event.pageX >= (this.x - _offset) &&\r\n            event.pageX <= ((this.x + this.width + _offset)) &&\r\n            event.pageY >= (this.y - _offset) &&\r\n            event.pageY <= ((this.y + this.height + _offset))\r\n        ) return prevResizingState || {};\r\n\r\n        return null;\r\n    }\r\n\r\n    _move(e) {\r\n        const event = this._convertMoveEvent(e)\r\n        const resizingState = this._getHitTestState(event, this._resizing);\r\n        // console.log(JSON.stringify(resizingState));\r\n        // console.log('sacce', e.changedTouches, resizingState)\r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } else {\r\n            // resizingState = this._resizing;\r\n            // this._resizing = null;\r\n            // this._prevPosition = null;\r\n        }\r\n\r\n        // if (e.type === 'mousemove' || e.type === 'touchmove')\r\n        //     this._resizing = resizingState;\r\n        // else {\r\n        //     this._resizing = null;\r\n        //     this._prevPosition = null;\r\n        // }\r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } \r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } \r\n\r\n        if (resizingState == null) {\r\n            this.win.className = this.win.className.replace(/resize-.*\\s?/gi, '').trim();\r\n            this._prevPosition = null;\r\n            this._resizing = null;\r\n            return;\r\n        }\r\n\r\n        if (resizingState.horizontal || resizingState.vertical) {\r\n            if (!this._resizing)\r\n                this.emit('resize-start');\r\n\r\n            // this._resizing = resizingState;\r\n            const newClass = [RESIZE_PREFIX, resizingState.horizontal, resizingState.vertical].filter(Boolean).join('-');\r\n            if (this.win.className.includes(RESIZE_PREFIX))\r\n                this.win.className = this.win.className.replace(/resize-.*\\s?/gi, newClass).trim();\r\n            else\r\n                this.win.className += ` ${newClass}`;\r\n\r\n            // e.preventDefault();\r\n            this._moving = false;\r\n        } else {\r\n            this._moving = true;\r\n\r\n            this.win.className = this.win.className.replace(/resize-.*\\s?/gi, '').trim();\r\n        }\r\n\r\n        const dx = this._prevPosition ? event.pageX - this._prevPosition.x : null;\r\n        const dy = this._prevPosition ? event.pageY - this._prevPosition.y : null;\r\n\r\n        this._prevPosition = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n\r\n        if (dx == null || dy == null) {\r\n            return resizingState != null;\r\n        }\r\n\r\n        if ((!this._isTouchEvent(e) && e.which !== 1)) {\r\n            if (this._moving) {\r\n                this._stopMove()\r\n            }\r\n            if (this._resizing) {\r\n                this._stopResize()\r\n            }\r\n        }\r\n\r\n        else if (this._moving) {\r\n            this.move(\r\n                this.x + dx,\r\n                this.y + dy,\r\n            );\r\n\r\n            this.emit('move', this)\r\n            e.preventDefault()\r\n        } else if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? 1 : -1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? 1 : -1;\r\n\r\n            this.move(\r\n                resizingState.horizontal == ResizeDirections.Left ? this.x + dx * xMutiplier : this.x,\r\n                resizingState.vertical == ResizeDirections.Up ? this.y + dy * yMutiplier : this.y\r\n            );\r\n        }\r\n\r\n        if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? -1 : 1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? -1 : 1;\r\n\r\n            this.resize(\r\n                resizingState.horizontal ? this.width + dx * xMutiplier : this.width,\r\n                resizingState.vertical ? this.height + dy * yMutiplier : this.height,\r\n            );\r\n\r\n            this.maximized = null;\r\n            this.emit('resize', this);\r\n            e.preventDefault();\r\n        }\r\n\r\n        return resizingState != null;\r\n    }\r\n\r\n    _up() {\r\n        if (this._moving) {\r\n            this._stopMove()\r\n        }\r\n        if (this._resizing) {\r\n            this._stopResize()\r\n        }\r\n    }\r\n\r\n    _listeners() {\r\n        this.win.addEventListener('mousedown', () => this.focus())\r\n        this.win.addEventListener('touchstart', () => this.focus())\r\n    }\r\n\r\n    _stopMove() {\r\n        this._moving = null\r\n        this.emit('move-end', this)\r\n    }\r\n\r\n    _stopResize() {\r\n        this._restore = this._resizing = null\r\n        this.emit('resize-end', this)\r\n    }\r\n\r\n    _isTouchEvent(e) {\r\n        return !!window.TouchEvent && (e instanceof window.TouchEvent)\r\n    }\r\n\r\n    _convertMoveEvent(e) {\r\n        return this._isTouchEvent(e) ? e.changedTouches[0] : e\r\n    }\r\n\r\n    /**\r\n     * attaches window to a side of the screen\r\n     * @param {('horizontal'|'vertical')} direction\r\n     * @param {('left'|'right'|'top'|'bottom')} location\r\n     */\r\n    attachToScreen(direction, location) {\r\n        this._attachedToScreen[direction] = location\r\n    }\r\n\r\n    /**\r\n     * @param {Bounds} bounds\r\n     * @param {(boolean|'horizontal'|'vertical')} keepInside\r\n     */\r\n    resizePlacement(bounds, keepInside) {\r\n        this.bounds = bounds\r\n        this.keepInside = keepInside\r\n        let x = this.x\r\n        let y = this.y\r\n        x = this._attachedToScreen.horziontal === 'right' ? bounds.right - this.width : x\r\n        x = this._attachedToScreen.horizontal === 'left' ? bounds.left : x\r\n        y = this._attachedToScreen.vertical === 'bottom' ? bounds.bottom - this.height : y\r\n        y = this._attachedToScreen.vertical === 'top' ? bounds.top : y\r\n        this.move(x, y)\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [ignoreClosed]\r\n     * @returns {boolean}\r\n     */\r\n    isModal(ignoreClosed) {\r\n        return (ignoreClosed || !this._closed) && this.options.modal\r\n    }\r\n\r\n    /** @returns {boolean} */\r\n    isClosed() {\r\n        return this._closed\r\n    }\r\n\r\n    get z() {\r\n        return parseInt(this.win.style.zIndex)\r\n    }\r\n    set z(value) {\r\n        this.win.style.zIndex = value\r\n    }\r\n}\r\n\r\nWindow.id = 0","export const close='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"close\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><path d=\"M3.5,3.5l13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/><path d=\"M16.5,3.5l-13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/></g></svg>';export const maximize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"maximize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"16\" style=\"fill:none;stroke:#fff;stroke-width:2px;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const minimize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"minimize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"15.6\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const resize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"resize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><clipPath id=\"_clip1\"><rect x=\"0\" y=\"0\" width=\"20\" height=\"20\"/></clipPath><g clip-path=\"url(#_clip1)\"><rect x=\"0\" y=\"16.8\" width=\"20\" height=\"3.2\" style=\"fill:#fff;\"/><path d=\"M17.737,3.595l-14.142,14.142l2.263,2.263l14.142,-14.142l-2.263,-2.263Z\" style=\"fill:#fff;\"/><path d=\"M16.8,0l0,20l3.2,0l0,-20l-3.2,0Z\" style=\"fill:#fff;\"/><path d=\"M7.099,18.4l11.301,-11.123l0,11.123l-11.301,0Z\" style=\"fill:#fff;\"/></g></svg>';export const restore='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"restore\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g></g></svg>';","import { close, maximize, restore, resize } from './images'\r\n\r\n/**\r\n * @typedef {object} WindowOptions\r\n * @property {number} [x=0]\r\n * @property {number} [y=0]\r\n * @property {number} [width]\r\n * @property {number} [height]\r\n * @property {boolean} [modal]\r\n * @property {boolean} [openOnCreate=true]\r\n * @property {boolean} [movable=true]\r\n * @property {boolean} [resizable=true]\r\n * @property {boolean} [maximizable=true]\r\n * @property {boolean} [closable=true]\r\n * @property {boolean} [noSnap] don't snap this window or use this window as a snap target\r\n * @property {boolean} [titlebar=true]\r\n * @property {string} [titlebarHeight=36px]\r\n * @property {boolean} [titleCenter]\r\n * @property {string} [minWidth=200px]\r\n * @property {string} [minHeight=60px]\r\n * @property {string} [borderRadius=4px]\r\n * @property {object} [styles]\r\n * @property {string} [shadow='0 0 12px 1px rgba(0, 0, 0, 0.6)']\r\n * @property {number} [animateTime=250]\r\n * @property {string} [backgroundModal=rgba(0,0,0,0.6)]\r\n * @property {string} [backgroundWindow=#fefefe]\r\n * @property {string} [backgroundTitlebarActive=#365d98]\r\n * @property {string} [backgroundTitlebarInactive=#888888]\r\n * @property {string} [foregroundButton=#ffffff]\r\n * @property {string} [foregroundTitle=#ffffff]\r\n * @property {string} [maximizeButton=...]\r\n * @property {string} [closeButton=...]\r\n * @property {string} [resize=...]\r\n */\r\nexport const windowOptions = {\r\n    x: 0,\r\n    y: 0,\r\n    width: undefined,\r\n    height: undefined,\r\n    modal: false,\r\n    openOnCreate: true,\r\n\r\n    classNames: {},\r\n\r\n    minWidth: '200px',\r\n    minHeight: '60px',\r\n    borderRadius: 0,\r\n    styles: {},\r\n\r\n    shadow: 'none',\r\n    movable: true,\r\n    resizable: true,\r\n    maximizable: true,\r\n    closable: true,\r\n\r\n    titlebar: true,\r\n\r\n    closeButton: close,\r\n    maximizeButton: maximize,\r\n    restoreButton: restore,\r\n\r\n    backgroundResize: resize\r\n}","import { html } from './html'\r\n\r\nconst DEFAULT_COLOR = '#a8f0f4'\r\nconst DEFAULT_SIZE = 10\r\n\r\nconst SnapOptionsDefault = {\r\n    screen: true,\r\n    windows: true,\r\n    snap: 20,\r\n    color: DEFAULT_COLOR,\r\n    spacing: 5,\r\n    indicator: DEFAULT_SIZE\r\n}\r\n\r\nexport class Snap\r\n{\r\n    /**\r\n     * add edge snapping plugin\r\n     * @param {WindowManager} wm\r\n     * @param {object} [options]\r\n     * @param {boolean} [options.screen=true] snap to screen edges\r\n     * @param {boolean} [options.windows=true] snap to window edges\r\n     * @param {number} [options.snap=20] distance to edge in pixels before snapping and width/height of snap bars\r\n     * @param {string} [options.color=#a8f0f4] color for snap bars\r\n     * @param {number} [options.spacing=5] spacing distance between window and edges\r\n     * @param {number} [options.indicator=10] size in pixels of snapping indicator (the indicator is actually twice the size of what is shown)\r\n     */\r\n    constructor(wm, options={})\r\n    {\r\n        this.wm = wm\r\n        this.options = Object.assign({}, SnapOptionsDefault, options)\r\n        this.highlights = html({ parent: this.wm.overlay, styles: { 'position': 'absolute' } })\r\n        this.horizontal = html({\r\n            parent: this.highlights, styles: {\r\n                display: 'none',\r\n                position: 'absolute',\r\n                height: `${this.options.indicator}px`,\r\n                borderRadius: `${this.options.indicator}px`,\r\n                backgroundColor: this.options.color\r\n            }\r\n        })\r\n        this.vertical = html({\r\n            parent: this.highlights, styles: {\r\n                display: 'none',\r\n                position: 'absolute',\r\n                width: `${this.options.indicator}px`,\r\n                borderRadius: `${this.options.indicator}px`,\r\n                backgroundColor: this.options.color\r\n            }\r\n        })\r\n        this.horizontal\r\n        this.showing = []\r\n    }\r\n\r\n    stop()\r\n    {\r\n        this.highlights.remove()\r\n        this.stopped = true\r\n    }\r\n\r\n    addWindow(win)\r\n    {\r\n        win.on('move', () => this.move(win))\r\n        win.on('move-end', () => this.moveEnd(win))\r\n    }\r\n\r\n    screenMove(rect, horizontal, vertical)\r\n    {\r\n        const width = document.body.clientWidth\r\n        const height = document.body.clientHeight\r\n        if (rect.left - this.options.snap <= width && rect.right + this.options.snap >= 0)\r\n        {\r\n            if (Math.abs(rect.top - 0) <= this.options.snap)\r\n            {\r\n                horizontal.push({ distance: Math.abs(rect.top - 0), left: 0, width, top: 0, side: 'top', screen: true })\r\n            }\r\n            else if (Math.abs(rect.bottom - height) <= this.options.snap)\r\n            {\r\n                horizontal.push({ distance: Math.abs(rect.bottom - height), left: 0, width, top: height, side: 'bottom', screen: true })\r\n            }\r\n        }\r\n        if (rect.top - this.options.snap <= height && rect.bottom + this.options.snap >= 0)\r\n        {\r\n            if (Math.abs(rect.left - 0) <= this.options.snap)\r\n            {\r\n                vertical.push({ distance: Math.abs(rect.left - 0), top: 0, height, left: 0, side: 'left', screen: true })\r\n            }\r\n            else if (Math.abs(rect.right - width) <= this.options.snap)\r\n            {\r\n                vertical.push({ distance: Math.abs(rect.right - width), top: 0, height, left: width, side: 'right', screen: true })\r\n            }\r\n        }\r\n    }\r\n\r\n    windowsMove(original, rect, horizontal, vertical)\r\n    {\r\n        for (let win of this.wm.windows)\r\n        {\r\n            if (!win.options.noSnap && win !== original)\r\n            {\r\n                const rect2 = win.win.getBoundingClientRect()\r\n                if (rect.left - this.options.snap <= rect2.right && rect.right + this.options.snap >= rect2.left)\r\n                {\r\n                    if (Math.abs(rect.top - rect2.bottom) <= this.options.snap)\r\n                    {\r\n                        horizontal.push({ distance: Math.abs(rect.top - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'top' })\r\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\r\n                        }\r\n                    }\r\n                    else if (Math.abs(rect.bottom - rect2.top) <= this.options.snap)\r\n                    {\r\n                        horizontal.push({ distance: Math.abs(rect.bottom - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'bottom' })\r\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\r\n                        }\r\n                    }\r\n                }\r\n                if (rect.top - this.options.snap <= rect2.bottom && rect.bottom + this.options.snap >= rect2.top)\r\n                {\r\n                    if (Math.abs(rect.left - rect2.right) <= this.options.snap)\r\n                    {\r\n                        vertical.push({ distance: Math.abs(rect.left - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'left' })\r\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\r\n                        }\r\n                    }\r\n                    else if (Math.abs(rect.right - rect2.left) <= this.options.snap)\r\n                    {\r\n                        vertical.push({ distance: Math.abs(rect.right - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'right' })\r\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    move(win)\r\n    {\r\n        if (this.stopped || win.options.noSnap || win.isModal())\r\n        {\r\n            return\r\n        }\r\n        this.horizontal.style.display = 'none'\r\n        this.vertical.style.display = 'none'\r\n        const horizontal = []\r\n        const vertical = []\r\n        const rect = win.win.getBoundingClientRect()\r\n        if (this.options.screen)\r\n        {\r\n            this.screenMove(rect, horizontal, vertical)\r\n        }\r\n        if (this.options.windows)\r\n        {\r\n            this.windowsMove(win, rect, horizontal, vertical)\r\n        }\r\n        if (horizontal.length)\r\n        {\r\n            horizontal.sort((a, b) => { return a.distance - b.distance })\r\n            const find = horizontal[0]\r\n            this.horizontal.style.display = 'block'\r\n            this.horizontal.style.width = find.width + 'px'\r\n            this.horizontal.y = find.top - this.options.indicator / 2\r\n            this.horizontal.style.transform = `translate(${find.left}px,${this.horizontal.y}px)`\r\n            this.horizontal.side = find.side\r\n            this.horizontal.noSpacing = find.noSpacing\r\n            this.horizontal.screen = find.screen\r\n        }\r\n        if (vertical.length)\r\n        {\r\n            vertical.sort((a, b) => { return a.distance - b.distance })\r\n            const find = vertical[0]\r\n            this.vertical.style.display  = 'block'\r\n            this.vertical.style.height = find.height + 'px'\r\n            this.vertical.x = find.left - this.options.indicator / 2\r\n            this.vertical.style.transform = `translate(${this.vertical.x}px,${find.top}px)`\r\n            this.vertical.side = find.side\r\n            this.vertical.noSpacing = find.noSpacing\r\n            this.vertical.screen = find.screen\r\n        }\r\n    }\r\n\r\n    moveEnd(win)\r\n    {\r\n        if (this.stopped)\r\n        {\r\n            return\r\n        }\r\n        if (this.horizontal.style.display === 'block')\r\n        {\r\n            const spacing = this.horizontal.noSpacing ? 0 : this.options.spacing\r\n            const adjust = win.minimized ? (win.height - win.height * win.minimized.scaleY) / 2 : 0\r\n            switch (this.horizontal.side)\r\n            {\r\n                case 'top':\r\n                    win.y = this.horizontal.y - adjust + spacing + this.options.indicator / 2\r\n                    break\r\n\r\n                case 'bottom':\r\n                    win.bottom = Math.floor(this.horizontal.y + adjust - spacing + this.options.indicator / 2)\r\n                    break\r\n            }\r\n            win.attachToScreen('vertical', this.horizontal.screen ? this.horizontal.side : '')\r\n        }\r\n        if (this.vertical.style.display === 'block')\r\n        {\r\n            const spacing = this.vertical.noSpacing ? 0 : this.options.spacing\r\n            const adjust = win.minimized ? (win.width - win.width * win.minimized.scaleX) / 2 : 0\r\n            switch (this.vertical.side)\r\n            {\r\n                case 'left':\r\n                    win.x = this.vertical.x - adjust + spacing + this.options.indicator / 2\r\n                    break\r\n\r\n                case 'right':\r\n                    win.right = Math.floor(this.vertical.x + adjust - spacing + this.options.indicator / 2)\r\n                    break\r\n            }\r\n            win.attachToScreen('horziontal', this.vertical.screen ? this.vertical.side : '')\r\n        }\r\n        this.horizontal.style.display = this.vertical.style.display = 'none'\r\n    }\r\n}","import { html } from './html'\r\nimport { Window } from './Window'\r\nimport { windowOptions } from './windowOptions'\r\nimport { Snap } from './Snap'\r\nexport { Window } from './Window'\r\n\r\nconst windowManagerOptions = {\r\n    parent: document.body,\r\n    quiet: false,\r\n    keepInside: true,\r\n    snap: true\r\n}\r\n\r\n/**\r\n * Creates a windowing system to create and manage windows\r\n *\r\n * @extends EventEmitter\r\n * @example\r\n * var wm = new WindowManager();\r\n *\r\n * wm.createWindow({ x: 20, y: 20, width: 200 })\r\n * wm.content.innerHTML = 'Hello there!'\r\n */\r\nexport class WindowManager {\r\n    /**\r\n     * @param {object} [options]\r\n     * @param {HTMLElement} [options.parent=document.body]\r\n     * @param {boolean} [options.quiet] suppress the simple-window-manager console message\r\n     * @param {(boolean|SnapOptions)} [options.snap] turn on edge and/or screen snapping\r\n     * @param {(boolean|'horizontal'|'vertical')} [options.keepInside=true] keep windows inside the parent in a certain direction\r\n     * @param {WindowOptions} [defaultOptions] default WindowOptions used when createWindow is called\r\n     */\r\n    constructor(options = {}, defaultOptions = {}) {\r\n        this.windows = []\r\n        this.active = null\r\n        this.options = Object.assign({}, windowManagerOptions, options)\r\n        this.defaultOptions = Object.assign({}, windowOptions, defaultOptions)\r\n        if (!this.options.quiet) {\r\n            console.log('%c  simple-window-manager initialized ', 'color: #ff00ff')\r\n        }\r\n        this._createDom(options.parent || document.body)\r\n        if (this.options.snap) {\r\n            this.snap(this.options.snap === true ? {} : this.options.snap)\r\n        }\r\n        window.addEventListener('resize', () => this.resize())\r\n    }\r\n\r\n    /**\r\n     * Create a window\r\n     * @param {WindowOptions} [options]\r\n     * @param {string} [options.title]\r\n     * @param {number} [options.x] position\r\n     * @param {number} [options.y] position\r\n     * @param {boolean} [options.modal]\r\n     * @param {(number|*)} [options.id] if not provide, id will be assigned in order of creation (0, 1, 2...)\r\n     * @returns {Window} the created window\r\n     */\r\n    createWindow(options = {}) {\r\n        const win = new Window(this, Object.assign({}, this.defaultOptions, options))\r\n        win.on('open', () => this._open(win))\r\n        win.on('focus', () => this._focus(win))\r\n        win.on('blur', () => this._blur(win))\r\n        win.on('close', () => this._close(win))\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !options.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        win.resizePlacement(this.bounds, this.options.keepInside)\r\n        if (win.options.openOnCreate) {\r\n            win.open()\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * Attach an existing window to the WindowManager\r\n     * Note: WindowManager.createWindow is the preferred way to create windows to ensure that all the defaultOptions\r\n     * are applied to the Window. If you use this function, then Window needs to be initialized with WindowOptions.\r\n     * @param {Window} win\r\n     * @returns {Window} the window\r\n     */\r\n    attachWindow(win) {\r\n        win.on('open', this._open, this)\r\n        win.on('focus', this._focus, this)\r\n        win.on('blur', this._blur, this)\r\n        win.on('close', this._close, this)\r\n        this.win.appendChild(win.win)\r\n        win.wm = this\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !this.defaultOptions.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * enable edge and/or screen snapping\r\n     * @param {SnapOptions} options\r\n     */\r\n    snap(options) {\r\n        this._snap = new Snap(this, options)\r\n        for (let win of this.windows) {\r\n            if (!win.options.noSnap) {\r\n                this._snap.addWindow(win)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to front\r\n     * @param {Window} win\r\n     */\r\n    sendToFront(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to back\r\n     * @param {Window} win\r\n     */\r\n    sendToBack(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== 0) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.unshift(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * save the state of all the windows\r\n     * @returns {object} use this object in load() to restore the state of all windows\r\n     */\r\n    save() {\r\n        const data = {}\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            data[entry.id] = entry.save()\r\n            data[entry.id].order = i\r\n        }\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * restores the state of all the windows\r\n     * NOTE: this requires that the windows have the same id as when save() was called\r\n     * @param {object} data created by save()\r\n     */\r\n    load(data) {\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            if (data[entry.id]) {\r\n                entry.load(data[entry.id])\r\n            }\r\n        }\r\n        // reorder windows\r\n    }\r\n\r\n    /**\r\n     * close all windows\r\n     */\r\n    closeAll() {\r\n        for (let win of this.windows) {\r\n            win.close()\r\n        }\r\n        this.windows = []\r\n        this.active = null\r\n    }\r\n\r\n    /**\r\n     * reorder windows\r\n     * @private\r\n     * @returns {number} available z-index for top window\r\n     */\r\n    _reorder() {\r\n        let i = 0\r\n        for (const win of this.windows) {\r\n            if (!win.isClosed()) {\r\n                win.z = i++\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {HTMLElement} parent\r\n     */\r\n    _createDom(parent) {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.win = html({\r\n            parent, styles: {\r\n                'user-select': 'none',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'z-index': -1,\r\n                'cursor': 'default'\r\n            }\r\n        })\r\n\r\n        /**\r\n         * This is the bottom DOM element. Use this to set a wallpaper or attach elements underneath the windows\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden'\r\n            }\r\n        })\r\n        this.overlay.addEventListener('mousemove', (e) => this._move(e))\r\n        this.overlay.addEventListener('touchmove', (e) => this._move(e))\r\n        this.overlay.addEventListener('mouseup', (e) => this._up(e))\r\n        this.overlay.addEventListener('touchend', (e) => this._up(e))\r\n\r\n        this.modalOverlay = html({\r\n            parent: this.win,\r\n            styles: {\r\n                'display': 'none',\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'background': this.defaultOptions.backgroundModal\r\n            }\r\n        })\r\n        this.modalOverlay.addEventListener('mousemove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchmove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mouseup', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchend', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mousedown', (e) => { e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchstart', (e) => { e.preventDefault(); e.stopPropagation() })\r\n    }\r\n\r\n    _open(win) {\r\n        this.windows.push(win)\r\n        this._reorder()\r\n        if (win.options.modal) {\r\n            this.modalOverlay.style.display = 'block'\r\n            this.modalOverlay.style.zIndex = win.z\r\n        }\r\n        else {\r\n            this.modalOverlay.style.display = 'none'\r\n        }\r\n    }\r\n\r\n    _focus(win) {\r\n        if (this.active === win) {\r\n            return\r\n        }\r\n        if (this.active) {\r\n            this.active.blur()\r\n        }\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._focus should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n        }\r\n        this._reorder()\r\n        this.active = this.windows[this.windows.length - 1]\r\n    }\r\n\r\n    _blur(win) {\r\n        if (this.active === win) {\r\n            this.active = null\r\n        }\r\n    }\r\n\r\n    _close(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._close should find window in this.windows')\r\n        this.windows.splice(index, 1)\r\n        const next = this.windows[this.windows.length - 1]\r\n        if (win.isModal(true)) {\r\n            if (next && next.isModal()) {\r\n                this.modalOverlay.style.zIndex = next.z\r\n            }\r\n            else {\r\n                this.modalOverlay.style.display = 'none'\r\n            }\r\n        }\r\n        next.focus()\r\n    }\r\n\r\n    _move(e) {\r\n        for (let i = this.windows.length - 1; i >= 0; i--) {\r\n            const win = this.windows[i];\r\n            const resizing = win._move(e);\r\n            if (resizing) {\r\n                const index = this.windows.indexOf(win);\r\n\r\n                this.windows.splice(index, 1);\r\n                this.windows.push(win);\r\n                break;\r\n            }\r\n            console.log(resizing);\r\n        }\r\n    }\r\n\r\n    _up(e) {\r\n        for (const key in this.windows) {\r\n            this.windows[key]._up(e)\r\n        }\r\n    }\r\n\r\n    checkModal(win) {\r\n        return !this.modal || this.modal === win\r\n    }\r\n\r\n    /** @type {Bounds} */\r\n    get bounds() {\r\n        return {\r\n            top: this.win.offsetTop,\r\n            bottom: this.win.offsetTop + this.win.offsetHeight,\r\n            left: this.win.offsetLeft,\r\n            right: this.win.offsetLeft + this.win.offsetWidth\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        const bounds = this.bounds\r\n        for (const key in this.windows) {\r\n            this.windows[key].resizePlacement(bounds, this.options.keepInside)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @typedef {object} SnapOptions\r\n * @property {boolean} [screen=true] snap to screen edges\r\n * @property {boolean} [windows=true] snap to window edges\r\n * @property {number} [snap=20] distance to edge before snapping\r\n * @property {string} [color=#a8f0f4] color for snap bars\r\n * @property {number} [spacing=0] spacing distance between window and edges\r\n */\r\n\r\n/**\r\n * @typedef {object} Bounds\r\n * @property {number} left\r\n * @property {number} right\r\n * @property {number} top\r\n * @property {number} bottom\r\n */"],"names":["html","options","object","document","createElement","type","parent","appendChild","styles","Object","assign","style","className","innerHTML","childElements","Array","isArray","child","has","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","defaultOptions","threshold","clicked","doubleClicked","doubleClickedTime","longClicked","longClickedTime","capture","clickDown","element","callback","Clicked","[object Object]","querySelector","mousedown","e","mouseup","mousemove","touchstart","touchmove","touchcancel","cancel","touchend","addEventListener","passive","console","warn","removeEventListener","down","touches","handleDown","changedTouches","screenX","screenY","x","y","Math","abs","lastX","lastY","pastThreshold","doubleClickedTimeout","clearTimeout","longClickedTimeout","preventDefault","handleClicks","pointerId","setTimeout","doubleClickedCancel","longClikedTimeout","ResizeDirections","demoHeaderStyles","user-select","display","flex-direction","align-items","justify-content","backgroundColor","border","padding","overflow","demoButtonStyles","margin","margin-left","width","height","background-color","background-size","background-repeat","opacity","outline","demoControlButtonsStyles","padding-left","RESIZE_PREFIX","Window","wm","super","id","_createWindow","_listeners","active","maximized","_closed","_restore","_moving","_prevPosition","_resizing","_attachedToScreen","vertical","horziontal","verticalResize","horizontalResize","noFocus","win","focus","titlebar","winTitlebar","backgroundTitlebarActive","backgroundTitlebarInactive","closed","value","_buildTransform","transform","offsetWidth","offsetHeight","keepInside","bounds","right","left","bottom","top","maximizable","buttons","maximize","maximizeButton","overlay","restoreButton","sendToBack","sendToFront","data","close","open","title","_title","winTitle","innerText","move","window","innerWidth","innerHeight","winStyles","position","min-width","minWidth","min-height","minHeight","isNaN","classNames","winBox","demo","_createTitlebar","content","overflow-x","overflow-y","resizable","_createResize","_downTitlebar","stopPropagation","_convertMoveEvent","pageX","pageY","_moved","headerStyles","titlebarHeight","frameManager","headerTitle","headerToolbar","toolbarInstruments","_createButtons","movable","winButtonGroup","minimizable","minimize","minimizeIconClass","maximizeIconClass","closable","closeIconClass","closeButton","key","button","prevResizingState","offset","up","horizontal","_offset","resizingState","_getHitTestState","_isTouchEvent","which","replace","trim","newClass","filter","Boolean","join","includes","dx","dy","yMutiplier","xMutiplier","_stopMove","_stopResize","resize","TouchEvent","direction","location","ignoreClosed","modal","z","parseInt","zIndex","windowOptions","openOnCreate","borderRadius","shadow","backgroundResize","SnapOptionsDefault","screen","windows","snap","color","spacing","indicator","Snap","highlights","showing","remove","stopped","moveEnd","rect","body","clientWidth","clientHeight","distance","side","original","noSnap","rect2","getBoundingClientRect","noSpacing","isModal","screenMove","windowsMove","sort","a","b","find","adjust","minimized","scaleY","floor","attachToScreen","scaleX","windowManagerOptions","quiet","log","_createDom","_open","_focus","_blur","_close","_move","_up","_snap","addWindow","resizePlacement","index","indexOf","assert","splice","_reorder","unshift","entry","save","order","load","isClosed","z-index","cursor","modalOverlay","background","backgroundModal","blur","next","resizing","offsetTop","offsetLeft"],"mappings":"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"}
{"version":3,"file":"simple-window-manager.min.js","sources":["../src/html.js","../node_modules/eventemitter3/index.js","../node_modules/clicked/clicked.js","../src/Window.js","../src/images.js","../src/windowOptions.js","../src/Snap.js","../src/WindowManager.js"],"sourcesContent":["/**\r\n * shortcut to create an html element\r\n * @param {object} options\r\n * @param {type} [options.string=div]\r\n * @param {string} [options.className]\r\n * @param {object} [options.styles]\r\n * @param {HTMLElement} [options.parent]\r\n * @param {string} [options.html]\r\n * @returns {HTMLElement}\r\n */\r\nexport function html(options={})\r\n{\r\n    const object = document.createElement(options.type || 'div')\r\n    if (options.parent)\r\n    {\r\n        options.parent.appendChild(object)\r\n    }\r\n    if (options.styles)\r\n    {\r\n        Object.assign(object.style, options.styles)\r\n    }\r\n    if (options.className)\r\n    {\r\n        object.className = options.className\r\n    }\r\n    if (options.html)\r\n    {\r\n        object.innerHTML = options.html\r\n    }\r\n    return object\r\n}","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * Watcher for click, double-click, or long-click event for both mouse and touch\n * @example\n * import { clicked } from 'clicked'\n *\n * function handleClick()\n * {\n *    console.log('I was clicked.')\n * }\n *\n * const div = document.getElementById('clickme')\n * const c = clicked(div, handleClick, { threshold: 15 })\n *\n * // change callback\n * c.callback = () => console.log('different clicker')\n *\n * // destroy\n * c.destroy()\n *\n * // using built-in querySelector\n * clicked('#clickme', handleClick2)\n *\n * // watching for all types of clicks\n * function handleAllClicks(e) {\n *     switch (e.type)\n *     {\n *         case 'clicked': ...\n *         case 'double-clicked': ...\n *         case 'long-clicked': ...\n *     }\n *\n *     // view UIEvent that caused callback\n *     console.log(e.event)\n * }\n * clicked('#clickme', handleAllClicks, { doubleClicked: true, longClicked: true })\n */\n\n/** @type {object} */\nconst defaultOptions = {\n    threshold: 10,\n    clicked: true,\n    doubleClicked: false,\n    doubleClickedTime: 300,\n    longClicked: false,\n    longClickedTime: 500,\n    capture: false,\n    clickDown: false\n}\n\n/**\n * @param {HTMLElement|string} element or querySelector entry (e.g., #id-name or .class-name)\n * @param {ClickedCallback} callback called after a click, double click, or long click is registered\n * @param {object} [options]\n * @param {number} [options.threshold=10] if touch moves threshhold-pixels then the touch-click is cancelled\n * @param {boolean} [options.clicked=true] disable watcher for default clicked event\n * @param {boolean} [options.doubleClicked] enable watcher for double click\n * @param {number} [options.doubleClickedTime=500] wait time in millseconds for double click\n * @param {boolean} [options.longClicked] enable watcher for long click\n * @param {number} [options.longClickedTime=500] wait time for long click\n * @param {boolean} [options.clickDown] enable watcher for click start\n * @param {boolean} [options.capture]  events will be dispatched to this registered listener before being dispatched to any EventTarget beneath it in the DOM tree\n * @returns {Clicked}\n */\nexport function clicked(element, callback, options)\n{\n    return new Clicked(element, callback, options)\n}\n\nclass Clicked\n{\n    constructor(element, callback, options)\n    {\n        if (typeof element === 'string')\n        {\n            element = document.querySelector(element)\n            if (!element)\n            {\n                console.warn(`Unknown element: document.querySelector(${element}) in clicked()`)\n                return\n            }\n        }\n        this.options = Object.assign({}, defaultOptions, options)\n        this.events = {\n            mousedown: (e) => this.mousedown(e),\n            mouseup: (e) => this.mouseup(e),\n            mousemove: (e) => this.mousemove(e),\n            touchstart: (e) => this.touchstart(e),\n            touchmove: (e) => this.touchmove(e),\n            touchcancel: (e) => this.cancel(e),\n            touchend: (e) => this.touchend(e)\n        }\n        element.addEventListener('mousedown', this.events.mousedown, { capture: this.options.capture })\n        element.addEventListener('mouseup', this.events.mouseup, { capture: this.options.capture })\n        element.addEventListener('mousemove', this.events.mousemove, { capture: this.options.capture })\n        element.addEventListener('touchstart', this.events.touchstart, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchmove', this.events.touchmove, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchcancel', this.events.touchcancel, { capture: this.options.capture})\n        element.addEventListener('touchend', this.events.touchend, { capture: this.options.capture })\n        this.element = element\n        this.callback = callback\n    }\n\n    /**\n     * removes event listeners added by Clicked\n     */\n    destroy()\n    {\n        this.element.removeEventListener('mousedown', this.events.mousedown)\n        this.element.removeEventListener('mouseup', this.events.mouseup)\n        this.element.removeEventListener('mousemove', this.events.mousemove)\n        this.element.removeEventListener('touchstart', this.events.touchstart, { passive: true })\n        this.element.removeEventListener('touchmove', this.events.touchmove, { passive: true })\n        this.element.removeEventListener('touchcancel', this.events.touchcancel)\n        this.element.removeEventListener('touchend', this.events.touchend)\n    }\n\n    touchstart(e)\n    {\n        if (this.down === true)\n        {\n            this.cancel()\n        }\n        else\n        {\n            if (e.touches.length === 1)\n            {\n                this.handleDown(e.changedTouches[0].screenX, e.changedTouches[0].screenY)\n            }\n        }\n    }\n\n    pastThreshold(x, y)\n    {\n        return Math.abs(this.lastX - x) > this.options.threshold || Math.abs(this.lastY - y) > this.options.threshold\n    }\n\n    touchmove(e)\n    {\n        if (this.down)\n        {\n            if (e.touches.length !== 1)\n            {\n                this.cancel()\n            }\n            else\n            {\n                const x = e.changedTouches[0].screenX\n                const y = e.changedTouches[0].screenY\n                if (this.pastThreshold(x, y))\n                {\n                    this.cancel()\n                }\n            }\n        }\n    }\n\n    /** cancel current event */\n    cancel()\n    {\n        this.down = false\n        if (this.doubleClickedTimeout)\n        {\n            clearTimeout(this.doubleClickedTimeout)\n            this.doubleClickedTimeout = null\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n    }\n\n    touchend(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e, e.pointerId)\n        }\n    }\n\n    handleClicks(e)\n    {\n        if (this.options.doubleClicked)\n        {\n            this.doubleClickedTimeout = setTimeout(() => this.doubleClickedCancel(e), this.options.doubleClickedTime)\n        }\n        else if (this.options.clicked)\n        {\n            this.callback({ event: e, type: 'clicked' })\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n        this.down = false\n    }\n\n    handleDown(e, x, y)\n    {\n        if (this.doubleClickedTimeout)\n        {\n            if (this.pastThreshold(x, y))\n            {\n                if (this.options.clicked)\n                {\n                    this.callback({ event: e, type: 'clicked' })\n                }\n                this.cancel()\n            }\n            else\n            {\n                this.callback({ event: e, type: 'double-clicked' })\n                this.cancel()\n            }\n        }\n        else\n        {\n            this.lastX = x\n            this.lastY = y\n            this.down = true\n            if (this.options.longClicked)\n            {\n                this.longClickedTimeout = setTimeout(() => this.longClicked(e), this.options.longClickedTime)\n            }\n            if (this.options.clickDown) {\n                this.callback({ event: e, type: 'click-down' })\n            }\n        }\n    }\n\n    longClicked(e)\n    {\n        this.longClikedTimeout = null\n        this.down = false\n        this.callback({ event: e, type: 'long-clicked' })\n    }\n\n    doubleClickedCancel(e)\n    {\n        this.doubleClickedTimeout = null\n        if (this.options.clicked)\n        {\n            this.callback({ event: e, type: 'double-clicked' })\n        }\n    }\n\n    mousedown(e)\n    {\n        if (this.down === true)\n        {\n            this.down = false\n        }\n        else\n        {\n            this.handleDown(e, e.screenX, e.screenY)\n        }\n    }\n\n    mousemove(e)\n    {\n        if (this.down)\n        {\n            const x = e.screenX\n            const y = e.screenY\n            if (this.pastThreshold(x, y))\n            {\n                this.cancel()\n            }\n        }\n    }\n\n    mouseup(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e)\n        }\n    }\n}\n\n/**\n * Callback for\n * @callback Clicked~ClickedCallback\n * @param {UIEvent} event\n * @param {('clicked'|'double-clicked'|'long-clicked'|'click-down')} type\n */","import Events from 'eventemitter3'\r\nimport { clicked } from 'clicked'\r\n\r\nimport { html } from './html'\r\n\r\n\r\nconst ResizeDirections = {\r\n    Up: 'up',\r\n    Down: 'down',\r\n    Left: 'left',\r\n    Right: 'right',\r\n}\r\n\r\nconst RESIZE_PREFIX = 'resize'\r\n\r\n/**\r\n * Window class returned by WindowManager.createWindow()\r\n * @extends EventEmitter\r\n * @fires open\r\n * @fires focus\r\n * @fires blur\r\n * @fires close\r\n * @fires maximize\r\n * @fires maximize-restore\r\n * @fires move\r\n * @fires move-start\r\n * @fires move-end\r\n * @fires resize\r\n * @fires resize-start\r\n * @fires resize-end\r\n * @fires move-x\r\n * @fires move-y\r\n * @fires resize-width\r\n * @fires resize-height\r\n */\r\nexport class Window extends Events {\r\n    /**\r\n     * @param {WindowManager} [wm]\r\n     * @param {object} [options]\r\n     */\r\n    constructor(wm, options = {}) {\r\n        super()\r\n        this.wm = wm\r\n        this.options = options\r\n        this.id = typeof this.options.id === 'undefined' ? Window.id++ : this.options.id\r\n        this._createWindow()\r\n        this._listeners()\r\n\r\n        this.active = false\r\n        this.maximized = false\r\n\r\n        this._closed = true\r\n        this._restore = null\r\n        this._moving = null\r\n        this._prevPosition = null\r\n        this._resizing = null\r\n        this._attachedToScreen = { vertical: '', horziontal: '' }\r\n        this.verticalResize = false;\r\n        this.horizontalResize = false;\r\n    }\r\n\r\n    /**\r\n     * open the window\r\n     * @param {boolean} [noFocus] do not focus window when opened\r\n     */\r\n    open(noFocus) {\r\n        if (this._closed) {\r\n            this.win.style.display = 'block'\r\n            this._closed = false\r\n            this.emit('open', this)\r\n            if (!noFocus) {\r\n                this.focus()\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * focus the window\r\n     */\r\n    focus() {\r\n        this.active = true\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarActive\r\n        }\r\n        this.emit('focus', this)\r\n    }\r\n\r\n    /**\r\n     * blur the window\r\n     */\r\n    blur() {\r\n        this.active = false\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarInactive\r\n        }\r\n        this.emit('blur', this)\r\n    }\r\n\r\n    /**\r\n     * closes the window (can be reopened with open)\r\n     */\r\n    close() {\r\n        if (!this._closed) {\r\n            this._closed = true\r\n            this.win.style.display = 'none'\r\n            this.emit('close', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * is window closed?\r\n     * @type {boolean}\r\n     * @readonly\r\n     */\r\n    get closed() {\r\n        return this._closed\r\n    }\r\n\r\n    /**\r\n     * left coordinate\r\n     * @type {number}\r\n     */\r\n    get x() { return this.options.x }\r\n    set x(value) {\r\n        if (value !== this.options.x) {\r\n            this.options.x = value\r\n            this.emit('move-x', this)\r\n            this._buildTransform()\r\n        }\r\n    }\r\n\r\n    _buildTransform() {\r\n        this.win.style.transform = `translate(${this.options.x}px,${this.options.y}px)`\r\n    }\r\n\r\n    /**\r\n     * top coordinate\r\n     * @type {number}\r\n     */\r\n    get y() { return this.options.y }\r\n    set y(value) {\r\n        if (value !== this.options.y) {\r\n            this.options.y = value\r\n            this._buildTransform()\r\n            this.emit('move-y', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * width of window\r\n     * @type {number}\r\n     */\r\n    get width() { return this.options.width || this.win.offsetWidth }\r\n    set width(value) {\r\n        if (value !== this.options.width) {\r\n            if (value) {\r\n                this.win.style.width = `${value}px`\r\n                this.options.width = this.win.offsetWidth\r\n            }\r\n            else {\r\n                this.win.style.width = 'auto'\r\n                this.options.width = ''\r\n            }\r\n            this.emit('resize-width', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * height of window\r\n     * @type {number}\r\n     */\r\n    get height() { return this.options.height || this.win.offsetHeight }\r\n    set height(value) {\r\n        if (value !== this.options.height) {\r\n            if (value) {\r\n                this.win.style.height = `${value}px`\r\n                this.options.height = this.win.offsetHeight\r\n            }\r\n            else {\r\n                this.win.style.height = 'auto'\r\n                this.options.height = ''\r\n            }\r\n            this.emit('resize-height', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * resize the window\r\n     * @param {number} width\r\n     * @param {number} height\r\n     */\r\n    resize(width, height) {\r\n        this.width = width\r\n        this.height = height\r\n    }\r\n\r\n    /**\r\n     * move window\r\n     * @param {number} x\r\n     * @param {number} y\r\n     */\r\n    move(x, y) {\r\n        const keepInside = this.keepInside\r\n        if (keepInside) {\r\n            const bounds = this.bounds\r\n            if (keepInside === true || keepInside === 'horizontal') {\r\n                x = x + this.width > bounds.right ? bounds.right - this.width : x\r\n                x = x < bounds.left ? bounds.left : x\r\n            }\r\n            if (keepInside === true || keepInside === 'vertical') {\r\n                y = y + this.height > bounds.bottom ? bounds.bottom - this.height : y\r\n                y = y < bounds.top ? bounds.top : y\r\n            }\r\n        }\r\n        if (x !== this.options.x) {\r\n            this.options.x = x\r\n            this.emit('move-x', this)\r\n        }\r\n        if (y !== this.options.y) {\r\n            this.options.y = y\r\n            this.emit('move-y', this)\r\n        }\r\n        this._buildTransform()\r\n    }\r\n\r\n    /**\r\n     * maximize the window\r\n     */\r\n    maximize() {\r\n        if (this.options.maximizable) {\r\n            if (this.maximized) {\r\n                this.x = this.maximized.x\r\n                this.y = this.maximized.y\r\n                this.width = this.maximized.width\r\n                this.height = this.maximized.height\r\n                this.maximized = null\r\n                this.emit('restore', this)\r\n                this.buttons.maximize.innerHTML = this.options.maximizeButton\r\n            }\r\n            else {\r\n                const x = this.x, y = this.y, width = this.win.offsetWidth, height = this.win.offsetHeight\r\n                this.maximized = { x, y, width, height }\r\n                this.x = 0\r\n                this.y = 0\r\n                this.width = this.wm.overlay.offsetWidth\r\n                this.height = this.wm.overlay.offsetHeight\r\n                this.emit('maximize', this)\r\n                this.buttons.maximize.innerHTML = this.options.restoreButton\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * sends window to back of window-manager\r\n     */\r\n    sendToBack() {\r\n        this.wm.sendToBack(this)\r\n    }\r\n\r\n    /**\r\n     * send window to front of window-manager\r\n     */\r\n    sendToFront() {\r\n        this.wm.sendToFront(this)\r\n    }\r\n\r\n    /**\r\n     * save the state of the window\r\n     * @return {object} data\r\n     */\r\n    save() {\r\n        const data = {}\r\n        const maximized = this.maximized\r\n        if (maximized) {\r\n            data.maximized = { left: maximized.left, top: maximized.top, width: maximized.width, height: maximized.height }\r\n        }\r\n        data.x = this.x\r\n        data.y = this.y\r\n        if (typeof this.options.width !== 'undefined') {\r\n            data.width = this.options.width\r\n        }\r\n        if (typeof this.options.height !== 'undefined') {\r\n            data.height = this.options.height\r\n        }\r\n        data.closed = this._closed\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * return the state of the window\r\n     * @param {object} data from save()\r\n     */\r\n    load(data) {\r\n        if (data.maximized) {\r\n            if (!this.maximized) {\r\n                this.maximize(true)\r\n            }\r\n        }\r\n        else if (this.maximized) {\r\n            this.maximize(true)\r\n        }\r\n        this.x = data.x\r\n        this.y = data.y\r\n        if (typeof data.width !== 'undefined') {\r\n            this.width = data.width\r\n        }\r\n        else {\r\n            this.win.style.width = 'auto'\r\n        }\r\n        if (typeof data.height !== 'undefined') {\r\n            this.height = data.height\r\n        }\r\n        else {\r\n            this.win.style.height = 'auto'\r\n        }\r\n        if (data.closed) {\r\n            this.close(true)\r\n        }\r\n        else if (this.closed) {\r\n            this.open(true, true)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * change title\r\n     * @type {string}\r\n     */\r\n    get title() { return this._title }\r\n    set title(value) {\r\n        this.winTitle.innerText = value\r\n        this.emit('title-change', this)\r\n    }\r\n\r\n\r\n    /**\r\n     * right coordinate of window\r\n     * @type {number}\r\n     */\r\n    get right() { return this.x + this.width }\r\n    set right(value) {\r\n        this.x = value - this.width\r\n    }\r\n\r\n    /**\r\n     * bottom coordinate of window\r\n     * @type {number}\r\n     */\r\n    get bottom() { return this.y + this.height }\r\n    set bottom(value) {\r\n        this.y = value - this.height\r\n    }\r\n\r\n    /**\r\n     * centers window in middle of other window or document.body\r\n     * @param {Window} [win]\r\n     */\r\n    center(win) {\r\n        if (win) {\r\n            this.move(\r\n                win.x + win.width / 2 - this.width / 2,\r\n                win.y + win.height / 2 - this.height / 2\r\n            )\r\n        }\r\n        else {\r\n            this.move(\r\n                window.innerWidth / 2 - this.width / 2,\r\n                window.innerHeight / 2 - this.height / 2\r\n            )\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fires when window is maximized\r\n     * @event Window#maximize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window is restored to normal after being maximized\r\n     * @event Window#maximize-restore\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window opens\r\n     * @event Window#open\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window gains focus\r\n     * @event Window#focus\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window loses focus\r\n     * @event Window#blur\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window closes\r\n     * @event Window#close\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when resize starts\r\n     * @event Window#resize-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after resize completes\r\n     * @event Window#resize-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during resizing\r\n     * @event Window#resize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when move starts\r\n     * @event Window#move-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after move completes\r\n     * @event Window#move-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during move\r\n     * @event Window#move\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when width is changed\r\n     * @event Window#resize-width\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when height is changed\r\n     * @event Window#resize-height\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when x position of window is changed\r\n     * @event Window#move-x\r\n     * @type {Window}\r\n     */\r\n\r\n\r\n    /**\r\n     * Fires when y position of window is changed\r\n     * @event Window#move-y\r\n     * @type {Window}\r\n     */\r\n\r\n    _createWindow() {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.win = html({\r\n            parent: (this.wm ? this.wm.win : null), styles: {\r\n                'display': 'none',\r\n                'border-radius': this.options.borderRadius,\r\n                'user-select': 'none',\r\n                'overflow': 'hidden',\r\n                'position': 'absolute',\r\n                'min-width': this.options.minWidth,\r\n                'min-height': this.options.minHeight,\r\n                'box-shadow': this.options.shadow,\r\n                'background-color': this.options.backgroundWindow,\r\n                'width': isNaN(this.options.width) ? this.options.width : this.options.width + 'px',\r\n                'height': isNaN(this.options.height) ? this.options.height : this.options.height + 'px',\r\n                ...this.options.styles\r\n            },\r\n            className: this.options.classNames.win\r\n        })\r\n\r\n        this.winBox = html({\r\n            parent: this.win, styles: {\r\n                'display': 'flex',\r\n                'flex-direction': 'column',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'min-height': this.options.minHeight\r\n            },\r\n            className: this.options.classNames.winBox\r\n        })\r\n        this._createTitlebar()\r\n\r\n        /**\r\n         * This is the content DOM element. Use this to add content to the Window.\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.content = html({\r\n            parent: this.winBox, type: 'section', styles: {\r\n                'display': 'block',\r\n                'flex': 1,\r\n                'min-height': this.minHeight,\r\n                'overflow-x': 'hidden',\r\n                'overflow-y': 'auto'\r\n            },\r\n            className: this.options.classNames.content\r\n        })\r\n\r\n        if (this.options.resizable) {\r\n            this._createResize()\r\n        }\r\n\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'display': 'none',\r\n                'position': 'absolute',\r\n                'left': 0,\r\n                'top': 0,\r\n                'width': '100%',\r\n                'height': '100%'\r\n            },\r\n            className: this.options.classNames.overlay\r\n        })\r\n        this.overlay.addEventListener('mousedown', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this.overlay.addEventListener('touchstart', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this._buildTransform()\r\n    }\r\n\r\n    _downTitlebar(e) {\r\n        const event = this._convertMoveEvent(e)\r\n        this._moving = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n        this.emit('move-start', this)\r\n        this._moved = false\r\n    }\r\n\r\n    _createTitlebar() {\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar = html({\r\n                parent: this.winBox, type: 'header', styles: {\r\n                    'user-select': 'none',\r\n                    'display': 'flex',\r\n                    'flex-direction': 'row',\r\n                    'align-items': 'center',\r\n                    'justify-content': 'center',\r\n                    'height': this.options.titlebarHeight,\r\n                    'min-height': this.options.titlebarHeight,\r\n                    'border': 0,\r\n                    'padding': '0 8px',\r\n                    'overflow': 'hidden',\r\n                },\r\n                className: this.options.classNames.titlebar\r\n            })\r\n            const winTitleStyles = {\r\n                'user-select': 'none',\r\n                'flex': 1,\r\n                'display': 'flex',\r\n                'flex-direction': 'row',\r\n                'align-items': 'center',\r\n                'user-select': 'none',\r\n                'cursor': 'default',\r\n                'padding': 0,\r\n                'margin': 0,\r\n                'font-size': '16px',\r\n                'font-weight': 400,\r\n                'color': this.options.foregroundTitle\r\n            }\r\n            if (this.options.titleCenter) {\r\n                winTitleStyles['justify-content'] = 'center'\r\n            }\r\n            else {\r\n                winTitleStyles['padding-left'] = '8px'\r\n\r\n            }\r\n            this.winTitle = html({ parent: this.winTitlebar, type: 'span', html: this.options.title, styles: winTitleStyles, className: this.options.classNames.winTitle })\r\n            this._createButtons()\r\n\r\n            if (this.options.movable) {\r\n                this.winTitlebar.addEventListener('mousedown', (e) => this._downTitlebar(e))\r\n                this.winTitlebar.addEventListener('touchstart', (e) => this._downTitlebar(e))\r\n            }\r\n            if (this.options.maximizable) {\r\n                clicked(this.winTitlebar, () => this.maximize(), { doubleClicked: true, clicked: false })\r\n            }\r\n        }\r\n    }\r\n\r\n    _createButtons() {\r\n        this.winButtonGroup = html({\r\n            parent: this.winTitlebar, styles: {\r\n                'display': 'flex',\r\n                'flex-direction': 'row',\r\n                'align-items': 'center',\r\n                'padding-left': '10px'\r\n            },\r\n            className: this.options.classNames.winButtonGroup\r\n        })\r\n        const button = {\r\n            'display': 'inline-block',\r\n            'border': 0,\r\n            'margin': 0,\r\n            'margin-left': '15px',\r\n            'padding': 0,\r\n            'width': '12px',\r\n            'height': '12px',\r\n            'background-color': 'transparent',\r\n            'background-size': 'cover',\r\n            'background-repeat': 'no-repeat',\r\n            'opacity': .7,\r\n            'color': this.options.foregroundButton,\r\n            'outline': 0\r\n        }\r\n        this.buttons = {}\r\n        if (this.options.maximizable) {\r\n            this.buttons.maximize = html({ parent: this.winButtonGroup, html: this.options.maximizeButton, type: 'button', styles: button, className: this.options.maximize })\r\n            clicked(this.buttons.maximize, () => this.maximize())\r\n        }\r\n        if (this.options.closable) {\r\n            this.buttons.close = html({ parent: this.winButtonGroup, html: this.options.closeButton, type: 'button', styles: button, className: this.options.close })\r\n            clicked(this.buttons.close, () => this.close())\r\n        }\r\n        for (let key in this.buttons) {\r\n            const button = this.buttons[key]\r\n            button.addEventListener('mousemove', () => {\r\n                button.style.opacity = 1\r\n            })\r\n            button.addEventListener('mouseout', () => {\r\n                button.style.opacity = 0.7\r\n            })\r\n        }\r\n    }\r\n\r\n    _createResize() {\r\n        // this.resizeEdge = html({\r\n        //     parent: this.winBox, type: 'button', html: this.options.backgroundResize, styles: {\r\n        //         'position': 'absolute',\r\n        //         'bottom': 0,\r\n        //         'right': '4px',\r\n        //         'border': 0,\r\n        //         'margin': 0,\r\n        //         'padding': 0,\r\n        //         'cursor': 'se-resize',\r\n        //         'user-select': 'none',\r\n        //         'height': '15px',\r\n        //         'width': '10px',\r\n        //         'background': 'none'\r\n        //     },\r\n        //     className: this.options.classNames.resizeEdge\r\n        // })\r\n        // const resize = e => {\r\n        //     if (!this.verticalResize && !this.horizontalResize)\r\n        //         return;\r\n\r\n        //     const event = this._convertMoveEvent(e);\r\n        //     // const width = this.width || this.win.offsetWidth;\r\n        //     // const height = this.height || this.win.offsetHeight;\r\n        //     // const newWidth = width - event.pageX;\r\n        //     // const newHeight = height - event.pageY;\r\n\r\n        //     // this._resizing = {\r\n        //     //     width: newWidth,\r\n        //     //     height: newHeight,\r\n        //     // }\r\n\r\n        //     // this._resizing = {\r\n        //     //     height: event.pageY,\r\n        //     //     width: event.pageX,\r\n        //     // };\r\n\r\n        //     // let x = null;\r\n        //     // let y = null;\r\n\r\n        //     if (this.horizontalResize === ResizeDirections.Left || this.horizontalResize === ResizeDirections.Top) {\r\n        //         // x = event.pageX - this.x;\r\n        //         this._moving = {\r\n        //             x: event.pageX,\r\n        //             y: event.pageY,\r\n        //         }\r\n\r\n        //     }\r\n\r\n        //     // if (this.horizontalResize === ResizeDirections.Top) {\r\n        //     //     // y = event.pageY - this.y;\r\n        //     // }\r\n\r\n        //     // // this._moving = {\r\n        //     // //     x: event.pageX - this.x,\r\n        //     // //     y: event.pageY - this.y\r\n        //     // // }\r\n\r\n        //     // // this._moving = { x, y };\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // }\r\n\r\n        // this.winBox.addEventListener('mousedown', resize)\r\n        // this.winBox.addEventListener('touchstart', resize)\r\n        // this.winBox.addEventListener('mousemove', (e) => {\r\n        //     const event = this._convertMoveEvent(e)\r\n        //     const up = Math.abs(event.pageY - this.y) < 13;\r\n        //     const down = Math.abs(event.pageY - (this.y + this.height)) < 13;\r\n        //     const left = Math.abs(event.pageX - this.x) < 13;\r\n        //     const right = Math.abs(event.pageX - (this.x + this.width)) < 13;\r\n\r\n        //     if (up) {\r\n        //         this.verticalResize = ResizeDirections.Up;\r\n        //     } else if (down) {\r\n        //         this.verticalResize = ResizeDirections.Down;\r\n        //     } else {\r\n        //         this.verticalResize = null;\r\n        //     }\r\n\r\n        //     if (left) {\r\n        //         this.horizontalResize = ResizeDirections.Left;\r\n        //     } else if (right) {\r\n        //         this.horizontalResize = ResizeDirections.Right;\r\n        //     } else {\r\n        //         this.horizontalResize = null;\r\n        //     }\r\n\r\n        //     if (this.verticalResize || this.horizontalResize) {\r\n        //         const newClass = [RESIZE_PREFIX, this.verticalResize, this.horizontalResize].filter(Boolean).join('-');\r\n        //         if (this.win.className.includes(RESIZE_PREFIX))\r\n        //             this.win.className = this.win.className.replace(/resize-.*/gi, newClass);\r\n        //         else\r\n        //             this.win.className += ` ${newClass}`;\r\n        //     } else {\r\n        //         this.win.className = this.win.className.replace(/resize-.*\\s/gi, '');\r\n        //     }\r\n\r\n        //     // console.log('down', this.win.className);\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // })\r\n    }\r\n\r\n    _getHitTestState(event, prevResizingState) {\r\n        const offset = prevResizingState ? 10000 : 10;\r\n        const up = Math.abs(event.pageY - this.y) < offset;\r\n        const down = Math.abs(event.pageY - (this.y + this.height)) < offset;\r\n        const left = Math.abs(event.pageX - this.x) < offset;\r\n        const right = Math.abs(event.pageX - (this.x + this.width)) < offset;\r\n\r\n        let horizontal;\r\n        let vertical;\r\n\r\n        if (up) {\r\n            vertical = ResizeDirections.Up;\r\n        } else if (down) {\r\n            vertical = ResizeDirections.Down;\r\n        } else {\r\n            vertical = null;\r\n        }\r\n\r\n        if (left) {\r\n            horizontal = ResizeDirections.Left;\r\n        } else if (right) {\r\n            horizontal = ResizeDirections.Right;\r\n        } else {\r\n            horizontal = null;\r\n        }\r\n\r\n        if (horizontal || vertical) {\r\n            return prevResizingState || {\r\n                horizontal,\r\n                vertical,\r\n            }\r\n        }\r\n\r\n        var _offset = prevResizingState ? 10000 : 0;\r\n\r\n        if (\r\n            event.pageX >= (this.x - _offset) &&\r\n            event.pageX <= ((this.x + this.width + _offset)) &&\r\n            event.pageY >= (this.y - _offset) &&\r\n            event.pageY <= ((this.y + this.height + _offset))\r\n        ) return prevResizingState || {};\r\n\r\n        return null;\r\n    }\r\n\r\n    _move = (e) => {\r\n        const event = this._convertMoveEvent(e)\r\n        const resizingState = this._getHitTestState(event, this._resizing);\r\n        // console.log(JSON.stringify(resizingState));\r\n        // console.log('sacce', e.changedTouches, resizingState)\r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } else {\r\n            // resizingState = this._resizing;\r\n            // this._resizing = null;\r\n            // this._prevPosition = null;\r\n        }\r\n\r\n        // if (e.type === 'mousemove' || e.type === 'touchmove')\r\n        //     this._resizing = resizingState;\r\n        // else {\r\n        //     this._resizing = null;\r\n        //     this._prevPosition = null;\r\n        // }\r\n\r\n        if (resizingState == null) {\r\n            this._prevPosition = null;\r\n            this._resizing = null;\r\n            return;\r\n        }\r\n\r\n        if (resizingState.horizontal || resizingState.vertical) {\r\n            if (!this._resizing)\r\n                this.emit('resize-start');\r\n\r\n            // this._resizing = resizingState;\r\n\r\n            const newClass = [RESIZE_PREFIX, resizingState.horizontal, resizingState.vertical].filter(Boolean).join('-');\r\n            if (this.win.className.includes(RESIZE_PREFIX))\r\n                this.win.className = this.win.className.replace(/resize-.*/gi, newClass);\r\n            else\r\n                this.win.className += ` ${newClass}`;\r\n\r\n            // e.preventDefault();\r\n            this._moving = false;\r\n        } else {\r\n            // this._prevPosition = null; // todo clear\r\n            this._moving = true;\r\n            // this._stopResize();\r\n            this.win.className = this.win.className.replace(/resize-.*\\s/gi, '');\r\n        }\r\n\r\n        const dx = this._prevPosition ? event.pageX - this._prevPosition.x : null;\r\n        const dy = this._prevPosition ? event.pageY - this._prevPosition.y : null;\r\n        // console.log('_move', dx, dy);\r\n\r\n        this._prevPosition = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n\r\n        if (dx == null || dy == null) {\r\n            return resizingState != null;\r\n        }\r\n\r\n        if ((!this._isTouchEvent(e) && e.which !== 1)) {\r\n            if (this._moving) {\r\n                this._stopMove()\r\n            }\r\n            if (this._resizing) {\r\n                this._stopResize()\r\n            }\r\n        }\r\n\r\n        else if (this._moving) {\r\n            this.move(\r\n                this.x + dx,\r\n                this.y + dy,\r\n            );\r\n\r\n            this.emit('move', this)\r\n            e.preventDefault()\r\n        } else if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? 1 : -1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? 1 : -1;\r\n\r\n            // console.log('move', dx, dy);\r\n            this.move(\r\n                resizingState.horizontal == ResizeDirections.Left ? this.x + dx * xMutiplier : this.x,\r\n                resizingState.vertical == ResizeDirections.Up ? this.y + dy * yMutiplier : this.y\r\n            );\r\n        }\r\n\r\n        if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? -1 : 1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? -1 : 1;\r\n\r\n            // this.width + dx * xMutiplier;\r\n            this.resize(\r\n                resizingState.horizontal ? this.width + dx * xMutiplier : this.width,\r\n                resizingState.vertical ? this.height + dy * yMutiplier : this.height,\r\n            );\r\n\r\n            this.maximized = null;\r\n            this.emit('resize', this);\r\n            e.preventDefault();\r\n        }\r\n\r\n        return resizingState != null;\r\n    }\r\n\r\n    _up() {\r\n        if (this._moving) {\r\n            this._stopMove()\r\n        }\r\n        if (this._resizing) {\r\n            this._stopResize()\r\n        }\r\n    }\r\n\r\n    _listeners() {\r\n        this.win.addEventListener('mousedown', () => this.focus())\r\n        this.win.addEventListener('touchstart', () => this.focus())\r\n    }\r\n\r\n    _stopMove() {\r\n        this._moving = null\r\n        this.emit('move-end', this)\r\n    }\r\n\r\n    _stopResize() {\r\n        this._restore = this._resizing = null\r\n        this.emit('resize-end', this)\r\n    }\r\n\r\n    _isTouchEvent(e) {\r\n        return !!window.TouchEvent && (e instanceof window.TouchEvent)\r\n    }\r\n\r\n    _convertMoveEvent(e) {\r\n        return this._isTouchEvent(e) ? e.changedTouches[0] : e\r\n    }\r\n\r\n    /**\r\n     * attaches window to a side of the screen\r\n     * @param {('horizontal'|'vertical')} direction\r\n     * @param {('left'|'right'|'top'|'bottom')} location\r\n     */\r\n    attachToScreen(direction, location) {\r\n        this._attachedToScreen[direction] = location\r\n    }\r\n\r\n    /**\r\n     * @param {Bounds} bounds\r\n     * @param {(boolean|'horizontal'|'vertical')} keepInside\r\n     */\r\n    resizePlacement(bounds, keepInside) {\r\n        this.bounds = bounds\r\n        this.keepInside = keepInside\r\n        let x = this.x\r\n        let y = this.y\r\n        x = this._attachedToScreen.horziontal === 'right' ? bounds.right - this.width : x\r\n        x = this._attachedToScreen.horizontal === 'left' ? bounds.left : x\r\n        y = this._attachedToScreen.vertical === 'bottom' ? bounds.bottom - this.height : y\r\n        y = this._attachedToScreen.vertical === 'top' ? bounds.top : y\r\n        this.move(x, y)\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [ignoreClosed]\r\n     * @returns {boolean}\r\n     */\r\n    isModal(ignoreClosed) {\r\n        return (ignoreClosed || !this._closed) && this.options.modal\r\n    }\r\n\r\n    /** @returns {boolean} */\r\n    isClosed() {\r\n        return this._closed\r\n    }\r\n\r\n    get z() {\r\n        return parseInt(this.win.style.zIndex)\r\n    }\r\n    set z(value) {\r\n        this.win.style.zIndex = value\r\n    }\r\n}\r\n\r\nWindow.id = 0","export const close='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"close\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><path d=\"M3.5,3.5l13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/><path d=\"M16.5,3.5l-13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/></g></svg>';export const maximize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"maximize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"16\" style=\"fill:none;stroke:#fff;stroke-width:2px;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const minimize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"minimize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"15.6\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const resize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"resize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><clipPath id=\"_clip1\"><rect x=\"0\" y=\"0\" width=\"20\" height=\"20\"/></clipPath><g clip-path=\"url(#_clip1)\"><rect x=\"0\" y=\"16.8\" width=\"20\" height=\"3.2\" style=\"fill:#fff;\"/><path d=\"M17.737,3.595l-14.142,14.142l2.263,2.263l14.142,-14.142l-2.263,-2.263Z\" style=\"fill:#fff;\"/><path d=\"M16.8,0l0,20l3.2,0l0,-20l-3.2,0Z\" style=\"fill:#fff;\"/><path d=\"M7.099,18.4l11.301,-11.123l0,11.123l-11.301,0Z\" style=\"fill:#fff;\"/></g></svg>';export const restore='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"restore\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g></g></svg>';","import { close, maximize, restore, resize } from './images'\r\n\r\n/**\r\n * @typedef {object} WindowOptions\r\n * @property {number} [x=0]\r\n * @property {number} [y=0]\r\n * @property {number} [width]\r\n * @property {number} [height]\r\n * @property {boolean} [modal]\r\n * @property {boolean} [openOnCreate=true]\r\n * @property {boolean} [movable=true]\r\n * @property {boolean} [resizable=true]\r\n * @property {boolean} [maximizable=true]\r\n * @property {boolean} [closable=true]\r\n * @property {boolean} [noSnap] don't snap this window or use this window as a snap target\r\n * @property {boolean} [titlebar=true]\r\n * @property {string} [titlebarHeight=36px]\r\n * @property {boolean} [titleCenter]\r\n * @property {string} [minWidth=200px]\r\n * @property {string} [minHeight=60px]\r\n * @property {string} [borderRadius=4px]\r\n * @property {object} [styles]\r\n * @property {string} [shadow='0 0 12px 1px rgba(0, 0, 0, 0.6)']\r\n * @property {number} [animateTime=250]\r\n * @property {string} [backgroundModal=rgba(0,0,0,0.6)]\r\n * @property {string} [backgroundWindow=#fefefe]\r\n * @property {string} [backgroundTitlebarActive=#365d98]\r\n * @property {string} [backgroundTitlebarInactive=#888888]\r\n * @property {string} [foregroundButton=#ffffff]\r\n * @property {string} [foregroundTitle=#ffffff]\r\n * @property {string} [maximizeButton=...]\r\n * @property {string} [closeButton=...]\r\n * @property {string} [resize=...]\r\n */\r\nexport const windowOptions = {\r\n    x: 0,\r\n    y: 0,\r\n    width: undefined,\r\n    height: undefined,\r\n    modal: false,\r\n    openOnCreate: true,\r\n\r\n    classNames: {},\r\n\r\n    minWidth: '200px',\r\n    minHeight: '60px',\r\n    borderRadius: 0,\r\n    styles: {},\r\n\r\n    shadow: 'none',\r\n    movable: true,\r\n    resizable: true,\r\n    maximizable: true,\r\n    closable: true,\r\n\r\n    titlebar: true,\r\n    titlebarHeight: '2rem',\r\n\r\n    backgroundModal: 'rgba(0, 0, 0, 0.6)',\r\n    backgroundWindow: '#fefefe',\r\n    backgroundTitlebarActive: '#365d98',\r\n    backgroundTitlebarInactive: '#888888',\r\n    foregroundButton: '#ffffff',\r\n    foregroundTitle: '#ffffff',\r\n\r\n    closeButton: close,\r\n    maximizeButton: maximize,\r\n    restoreButton: restore,\r\n\r\n    backgroundResize: resize\r\n}","import { html } from './html'\n\nconst DEFAULT_COLOR = '#a8f0f4'\nconst DEFAULT_SIZE = 10\n\nconst SnapOptionsDefault = {\n    screen: true,\n    windows: true,\n    snap: 20,\n    color: DEFAULT_COLOR,\n    spacing: 5,\n    indicator: DEFAULT_SIZE\n}\n\nexport class Snap\n{\n    /**\n     * add edge snapping plugin\n     * @param {WindowManager} wm\n     * @param {object} [options]\n     * @param {boolean} [options.screen=true] snap to screen edges\n     * @param {boolean} [options.windows=true] snap to window edges\n     * @param {number} [options.snap=20] distance to edge in pixels before snapping and width/height of snap bars\n     * @param {string} [options.color=#a8f0f4] color for snap bars\n     * @param {number} [options.spacing=5] spacing distance between window and edges\n     * @param {number} [options.indicator=10] size in pixels of snapping indicator (the indicator is actually twice the size of what is shown)\n     */\n    constructor(wm, options={})\n    {\n        this.wm = wm\n        this.options = Object.assign({}, SnapOptionsDefault, options)\n        this.highlights = html({ parent: this.wm.overlay, styles: { 'position': 'absolute' } })\n        this.horizontal = html({\n            parent: this.highlights, styles: {\n                display: 'none',\n                position: 'absolute',\n                height: `${this.options.indicator}px`,\n                borderRadius: `${this.options.indicator}px`,\n                backgroundColor: this.options.color\n            }\n        })\n        this.vertical = html({\n            parent: this.highlights, styles: {\n                display: 'none',\n                position: 'absolute',\n                width: `${this.options.indicator}px`,\n                borderRadius: `${this.options.indicator}px`,\n                backgroundColor: this.options.color\n            }\n        })\n        this.horizontal\n        this.showing = []\n    }\n\n    stop()\n    {\n        this.highlights.remove()\n        this.stopped = true\n    }\n\n    addWindow(win)\n    {\n        win.on('move', () => this.move(win))\n        win.on('move-end', () => this.moveEnd(win))\n    }\n\n    screenMove(rect, horizontal, vertical)\n    {\n        const width = document.body.clientWidth\n        const height = document.body.clientHeight\n        if (rect.left - this.options.snap <= width && rect.right + this.options.snap >= 0)\n        {\n            if (Math.abs(rect.top - 0) <= this.options.snap)\n            {\n                horizontal.push({ distance: Math.abs(rect.top - 0), left: 0, width, top: 0, side: 'top', screen: true })\n            }\n            else if (Math.abs(rect.bottom - height) <= this.options.snap)\n            {\n                horizontal.push({ distance: Math.abs(rect.bottom - height), left: 0, width, top: height, side: 'bottom', screen: true })\n            }\n        }\n        if (rect.top - this.options.snap <= height && rect.bottom + this.options.snap >= 0)\n        {\n            if (Math.abs(rect.left - 0) <= this.options.snap)\n            {\n                vertical.push({ distance: Math.abs(rect.left - 0), top: 0, height, left: 0, side: 'left', screen: true })\n            }\n            else if (Math.abs(rect.right - width) <= this.options.snap)\n            {\n                vertical.push({ distance: Math.abs(rect.right - width), top: 0, height, left: width, side: 'right', screen: true })\n            }\n        }\n    }\n\n    windowsMove(original, rect, horizontal, vertical)\n    {\n        for (let win of this.wm.windows)\n        {\n            if (!win.options.noSnap && win !== original)\n            {\n                const rect2 = win.win.getBoundingClientRect()\n                if (rect.left - this.options.snap <= rect2.right && rect.right + this.options.snap >= rect2.left)\n                {\n                    if (Math.abs(rect.top - rect2.bottom) <= this.options.snap)\n                    {\n                        horizontal.push({ distance: Math.abs(rect.top - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'top' })\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\n                        {\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\n                        }\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\n                        {\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\n                        }\n                    }\n                    else if (Math.abs(rect.bottom - rect2.top) <= this.options.snap)\n                    {\n                        horizontal.push({ distance: Math.abs(rect.bottom - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'bottom' })\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\n                        {\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\n                        }\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\n                        {\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\n                        }\n                    }\n                }\n                if (rect.top - this.options.snap <= rect2.bottom && rect.bottom + this.options.snap >= rect2.top)\n                {\n                    if (Math.abs(rect.left - rect2.right) <= this.options.snap)\n                    {\n                        vertical.push({ distance: Math.abs(rect.left - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'left' })\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\n                        {\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\n                        }\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\n                        {\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\n                        }\n                    }\n                    else if (Math.abs(rect.right - rect2.left) <= this.options.snap)\n                    {\n                        vertical.push({ distance: Math.abs(rect.right - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'right' })\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\n                        {\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\n                        }\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\n                        {\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    move(win)\n    {\n        if (this.stopped || win.options.noSnap || win.isModal())\n        {\n            return\n        }\n        this.horizontal.style.display = 'none'\n        this.vertical.style.display = 'none'\n        const horizontal = []\n        const vertical = []\n        const rect = win.win.getBoundingClientRect()\n        if (this.options.screen)\n        {\n            this.screenMove(rect, horizontal, vertical)\n        }\n        if (this.options.windows)\n        {\n            this.windowsMove(win, rect, horizontal, vertical)\n        }\n        if (horizontal.length)\n        {\n            horizontal.sort((a, b) => { return a.distance - b.distance })\n            const find = horizontal[0]\n            this.horizontal.style.display = 'block'\n            this.horizontal.style.width = find.width + 'px'\n            this.horizontal.y = find.top - this.options.indicator / 2\n            this.horizontal.style.transform = `translate(${find.left}px,${this.horizontal.y}px)`\n            this.horizontal.side = find.side\n            this.horizontal.noSpacing = find.noSpacing\n            this.horizontal.screen = find.screen\n        }\n        if (vertical.length)\n        {\n            vertical.sort((a, b) => { return a.distance - b.distance })\n            const find = vertical[0]\n            this.vertical.style.display  = 'block'\n            this.vertical.style.height = find.height + 'px'\n            this.vertical.x = find.left - this.options.indicator / 2\n            this.vertical.style.transform = `translate(${this.vertical.x}px,${find.top}px)`\n            this.vertical.side = find.side\n            this.vertical.noSpacing = find.noSpacing\n            this.vertical.screen = find.screen\n        }\n    }\n\n    moveEnd(win)\n    {\n        if (this.stopped)\n        {\n            return\n        }\n        if (this.horizontal.style.display === 'block')\n        {\n            const spacing = this.horizontal.noSpacing ? 0 : this.options.spacing\n            const adjust = win.minimized ? (win.height - win.height * win.minimized.scaleY) / 2 : 0\n            switch (this.horizontal.side)\n            {\n                case 'top':\n                    win.y = this.horizontal.y - adjust + spacing + this.options.indicator / 2\n                    break\n\n                case 'bottom':\n                    win.bottom = Math.floor(this.horizontal.y + adjust - spacing + this.options.indicator / 2)\n                    break\n            }\n            win.attachToScreen('vertical', this.horizontal.screen ? this.horizontal.side : '')\n        }\n        if (this.vertical.style.display === 'block')\n        {\n            const spacing = this.vertical.noSpacing ? 0 : this.options.spacing\n            const adjust = win.minimized ? (win.width - win.width * win.minimized.scaleX) / 2 : 0\n            switch (this.vertical.side)\n            {\n                case 'left':\n                    win.x = this.vertical.x - adjust + spacing + this.options.indicator / 2\n                    break\n\n                case 'right':\n                    win.right = Math.floor(this.vertical.x + adjust - spacing + this.options.indicator / 2)\n                    break\n            }\n            win.attachToScreen('horziontal', this.vertical.screen ? this.vertical.side : '')\n        }\n        this.horizontal.style.display = this.vertical.style.display = 'none'\n    }\n}","import { html } from './html'\r\nimport { Window } from './Window'\r\nimport { windowOptions } from './windowOptions'\r\nimport { Snap } from './Snap'\r\nexport { Window } from './Window'\r\n\r\nconst windowManagerOptions = {\r\n    parent: document.body,\r\n    quiet: false,\r\n    keepInside: true,\r\n    snap: true\r\n}\r\n\r\n/**\r\n * Creates a windowing system to create and manage windows\r\n *\r\n * @extends EventEmitter\r\n * @example\r\n * var wm = new WindowManager();\r\n *\r\n * wm.createWindow({ x: 20, y: 20, width: 200 })\r\n * wm.content.innerHTML = 'Hello there!'\r\n */\r\nexport class WindowManager {\r\n    /**\r\n     * @param {object} [options]\r\n     * @param {HTMLElement} [options.parent=document.body]\r\n     * @param {boolean} [options.quiet] suppress the simple-window-manager console message\r\n     * @param {(boolean|SnapOptions)} [options.snap] turn on edge and/or screen snapping\r\n     * @param {(boolean|'horizontal'|'vertical')} [options.keepInside=true] keep windows inside the parent in a certain direction\r\n     * @param {WindowOptions} [defaultOptions] default WindowOptions used when createWindow is called\r\n     */\r\n    constructor(options = {}, defaultOptions = {}) {\r\n        this.windows = []\r\n        this.active = null\r\n        this.options = Object.assign({}, windowManagerOptions, options)\r\n        this.defaultOptions = Object.assign({}, windowOptions, defaultOptions)\r\n        if (!this.options.quiet) {\r\n            console.log('%c  simple-window-manager initialized ', 'color: #ff00ff')\r\n        }\r\n        this._createDom(options.parent || document.body)\r\n        if (this.options.snap) {\r\n            this.snap(this.options.snap === true ? {} : this.options.snap)\r\n        }\r\n        window.addEventListener('resize', () => this.resize())\r\n    }\r\n\r\n    /**\r\n     * Create a window\r\n     * @param {WindowOptions} [options]\r\n     * @param {string} [options.title]\r\n     * @param {number} [options.x] position\r\n     * @param {number} [options.y] position\r\n     * @param {boolean} [options.modal]\r\n     * @param {(number|*)} [options.id] if not provide, id will be assigned in order of creation (0, 1, 2...)\r\n     * @returns {Window} the created window\r\n     */\r\n    createWindow(options = {}) {\r\n        const win = new Window(this, Object.assign({}, this.defaultOptions, options))\r\n        win.on('open', () => this._open(win))\r\n        win.on('focus', () => this._focus(win))\r\n        win.on('blur', () => this._blur(win))\r\n        win.on('close', () => this._close(win))\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !options.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        win.resizePlacement(this.bounds, this.options.keepInside)\r\n        if (win.options.openOnCreate) {\r\n            win.open()\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * Attach an existing window to the WindowManager\r\n     * Note: WindowManager.createWindow is the preferred way to create windows to ensure that all the defaultOptions\r\n     * are applied to the Window. If you use this function, then Window needs to be initialized with WindowOptions.\r\n     * @param {Window} win\r\n     * @returns {Window} the window\r\n     */\r\n    attachWindow(win) {\r\n        win.on('open', this._open, this)\r\n        win.on('focus', this._focus, this)\r\n        win.on('blur', this._blur, this)\r\n        win.on('close', this._close, this)\r\n        this.win.appendChild(win.win)\r\n        win.wm = this\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !this.defaultOptions.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * enable edge and/or screen snapping\r\n     * @param {SnapOptions} options\r\n     */\r\n    snap(options) {\r\n        this._snap = new Snap(this, options)\r\n        for (let win of this.windows) {\r\n            if (!win.options.noSnap) {\r\n                this._snap.addWindow(win)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to front\r\n     * @param {Window} win\r\n     */\r\n    sendToFront(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to back\r\n     * @param {Window} win\r\n     */\r\n    sendToBack(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== 0) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.unshift(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * save the state of all the windows\r\n     * @returns {object} use this object in load() to restore the state of all windows\r\n     */\r\n    save() {\r\n        const data = {}\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            data[entry.id] = entry.save()\r\n            data[entry.id].order = i\r\n        }\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * restores the state of all the windows\r\n     * NOTE: this requires that the windows have the same id as when save() was called\r\n     * @param {object} data created by save()\r\n     */\r\n    load(data) {\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            if (data[entry.id]) {\r\n                entry.load(data[entry.id])\r\n            }\r\n        }\r\n        // reorder windows\r\n    }\r\n\r\n    /**\r\n     * close all windows\r\n     */\r\n    closeAll() {\r\n        for (let win of this.windows) {\r\n            win.close()\r\n        }\r\n        this.windows = []\r\n        this.active = null\r\n    }\r\n\r\n    /**\r\n     * reorder windows\r\n     * @private\r\n     * @returns {number} available z-index for top window\r\n     */\r\n    _reorder() {\r\n        let i = 0\r\n        for (const win of this.windows) {\r\n            if (!win.isClosed()) {\r\n                win.z = i++\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {HTMLElement} parent\r\n     */\r\n    _createDom(parent) {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.win = html({\r\n            parent, styles: {\r\n                'user-select': 'none',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'z-index': -1,\r\n                'cursor': 'default'\r\n            }\r\n        })\r\n\r\n        /**\r\n         * This is the bottom DOM element. Use this to set a wallpaper or attach elements underneath the windows\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden'\r\n            }\r\n        })\r\n        this.overlay.addEventListener('mousemove', (e) => this._move(e))\r\n        this.overlay.addEventListener('touchmove', (e) => this._move(e))\r\n        this.overlay.addEventListener('mouseup', (e) => this._up(e))\r\n        this.overlay.addEventListener('touchend', (e) => this._up(e))\r\n\r\n        this.modalOverlay = html({\r\n            parent: this.win,\r\n            styles: {\r\n                'display': 'none',\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'background': this.defaultOptions.backgroundModal\r\n            }\r\n        })\r\n        this.modalOverlay.addEventListener('mousemove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchmove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mouseup', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchend', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mousedown', (e) => { e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchstart', (e) => { e.preventDefault(); e.stopPropagation() })\r\n    }\r\n\r\n    _open(win) {\r\n        this.windows.push(win)\r\n        this._reorder()\r\n        if (win.options.modal) {\r\n            this.modalOverlay.style.display = 'block'\r\n            this.modalOverlay.style.zIndex = win.z\r\n        }\r\n        else {\r\n            this.modalOverlay.style.display = 'none'\r\n        }\r\n    }\r\n\r\n    _focus(win) {\r\n        if (this.active === win) {\r\n            return\r\n        }\r\n        if (this.active) {\r\n            this.active.blur()\r\n        }\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._focus should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n        }\r\n        this._reorder()\r\n        this.active = this.windows[this.windows.length - 1]\r\n    }\r\n\r\n    _blur(win) {\r\n        if (this.active === win) {\r\n            this.active = null\r\n        }\r\n    }\r\n\r\n    _close(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._close should find window in this.windows')\r\n        this.windows.splice(index, 1)\r\n        const next = this.windows[this.windows.length - 1]\r\n        if (win.isModal(true)) {\r\n            if (next && next.isModal()) {\r\n                this.modalOverlay.style.zIndex = next.z\r\n            }\r\n            else {\r\n                this.modalOverlay.style.display = 'none'\r\n            }\r\n        }\r\n        next.focus()\r\n    }\r\n\r\n    _move(e) {\r\n        for (let i = this.windows.length - 1; i >= 0; i--) {\r\n            const win = this.windows[i];\r\n            const resizing = win._move(e);\r\n            if (resizing) {\r\n                const index = this.windows.indexOf(win);\r\n\r\n                this.windows.splice(index, 1);\r\n                this.windows.push(win);\r\n                break;\r\n            }\r\n            console.log(resizing);\r\n        }\r\n    }\r\n\r\n    _up(e) {\r\n        for (const key in this.windows) {\r\n            this.windows[key]._up(e)\r\n        }\r\n    }\r\n\r\n    checkModal(win) {\r\n        return !this.modal || this.modal === win\r\n    }\r\n\r\n    /** @type {Bounds} */\r\n    get bounds() {\r\n        return {\r\n            top: this.win.offsetTop,\r\n            bottom: this.win.offsetTop + this.win.offsetHeight,\r\n            left: this.win.offsetLeft,\r\n            right: this.win.offsetLeft + this.win.offsetWidth\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        const bounds = this.bounds\r\n        for (const key in this.windows) {\r\n            this.windows[key].resizePlacement(bounds, this.options.keepInside)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @typedef {object} SnapOptions\r\n * @property {boolean} [screen=true] snap to screen edges\r\n * @property {boolean} [windows=true] snap to window edges\r\n * @property {number} [snap=20] distance to edge before snapping\r\n * @property {string} [color=#a8f0f4] color for snap bars\r\n * @property {number} [spacing=0] spacing distance between window and edges\r\n */\r\n\r\n/**\r\n * @typedef {object} Bounds\r\n * @property {number} left\r\n * @property {number} right\r\n * @property {number} top\r\n * @property {number} bottom\r\n */"],"names":["html","options","object","document","createElement","type","parent","appendChild","styles","Object","assign","style","className","innerHTML","has","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","defaultOptions","threshold","clicked","doubleClicked","doubleClickedTime","longClicked","longClickedTime","capture","clickDown","element","callback","Clicked","[object Object]","querySelector","mousedown","e","mouseup","mousemove","touchstart","touchmove","touchcancel","cancel","touchend","addEventListener","passive","console","warn","removeEventListener","down","touches","handleDown","changedTouches","screenX","screenY","x","y","Math","abs","lastX","lastY","pastThreshold","doubleClickedTimeout","clearTimeout","longClickedTimeout","preventDefault","handleClicks","pointerId","setTimeout","doubleClickedCancel","longClikedTimeout","ResizeDirections","RESIZE_PREFIX","Window","wm","super","id","_createWindow","_listeners","active","maximized","_closed","_restore","_moving","_prevPosition","_resizing","_attachedToScreen","vertical","horziontal","verticalResize","horizontalResize","noFocus","win","display","focus","titlebar","winTitlebar","backgroundColor","backgroundTitlebarActive","backgroundTitlebarInactive","closed","value","_buildTransform","transform","width","offsetWidth","height","offsetHeight","keepInside","bounds","right","left","bottom","top","maximizable","buttons","maximize","maximizeButton","overlay","restoreButton","sendToBack","sendToFront","data","close","open","title","_title","winTitle","innerText","move","window","innerWidth","innerHeight","border-radius","borderRadius","user-select","overflow","position","min-width","minWidth","min-height","minHeight","box-shadow","shadow","background-color","backgroundWindow","isNaN","classNames","winBox","flex-direction","_createTitlebar","content","flex","overflow-x","overflow-y","resizable","_createResize","_downTitlebar","stopPropagation","_convertMoveEvent","pageX","pageY","_moved","align-items","justify-content","titlebarHeight","border","padding","winTitleStyles","cursor","margin","font-size","font-weight","color","foregroundTitle","titleCenter","_createButtons","movable","winButtonGroup","padding-left","button","margin-left","background-size","background-repeat","opacity","foregroundButton","outline","closable","closeButton","key","prevResizingState","offset","up","horizontal","_offset","resizingState","_getHitTestState","_isTouchEvent","which","newClass","filter","Boolean","join","includes","replace","dx","dy","yMutiplier","xMutiplier","_stopMove","_stopResize","resize","TouchEvent","direction","location","ignoreClosed","modal","z","parseInt","zIndex","windowOptions","openOnCreate","backgroundModal","backgroundResize","SnapOptionsDefault","screen","windows","snap","spacing","indicator","Snap","highlights","showing","remove","stopped","moveEnd","rect","body","clientWidth","clientHeight","distance","side","original","noSnap","rect2","getBoundingClientRect","noSpacing","isModal","screenMove","windowsMove","sort","a","b","find","adjust","minimized","scaleY","floor","attachToScreen","scaleX","windowManagerOptions","quiet","log","_createDom","_open","_focus","_blur","_close","_move","_up","_snap","addWindow","resizePlacement","index","indexOf","assert","splice","_reorder","unshift","entry","save","order","load","isClosed","z-index","modalOverlay","background","blur","next","resizing","offsetTop","offsetLeft"],"mappings":"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"}
=======
{"version":3,"file":"simple-window-manager.min.js","sources":["../src/html.js","../node_modules/eventemitter3/index.js","../node_modules/clicked/clicked.js","../src/Window.js","../src/images.js","../src/windowOptions.js","../src/Snap.js","../src/WindowManager.js"],"sourcesContent":["/**\r\n * shortcut to create an html element\r\n * @param {object} options\r\n * @param {type} [options.string=div]\r\n * @param {string} [options.className]\r\n * @param {object} [options.styles]\r\n * @param {HTMLElement} [options.parent]\r\n * @param {string} [options.html]\r\n * @param {[HTMLElement]} [options.childElements]\r\n * @returns {HTMLElement}\r\n */\r\nexport function html(options = {}) {\r\n    const object = document.createElement(options.type || 'div')\r\n    if (options.parent) {\r\n        options.parent.appendChild(object)\r\n    }\r\n    if (options.styles) {\r\n        Object.assign(object.style, options.styles)\r\n    }\r\n    if (options.className) {\r\n        object.className = options.className\r\n    }\r\n    if (options.html) {\r\n        object.innerHTML = options.html\r\n    }\r\n    if (options.childElements) {\r\n        if (!Array.isArray(options.childElements))\r\n            options.childElements = [options.childElements];\r\n\r\n        for (const child of options.childElements)\r\n            if (child) object.appendChild(child);\r\n    }\r\n    return object\r\n}","'use strict';\r\n\r\nvar has = Object.prototype.hasOwnProperty\r\n  , prefix = '~';\r\n\r\n/**\r\n * Constructor to create a storage for our `EE` objects.\r\n * An `Events` instance is a plain object whose properties are event names.\r\n *\r\n * @constructor\r\n * @private\r\n */\r\nfunction Events() {}\r\n\r\n//\r\n// We try to not inherit from `Object.prototype`. In some engines creating an\r\n// instance in this way is faster than calling `Object.create(null)` directly.\r\n// If `Object.create(null)` is not supported we prefix the event names with a\r\n// character to make sure that the built-in object properties are not\r\n// overridden or used as an attack vector.\r\n//\r\nif (Object.create) {\r\n  Events.prototype = Object.create(null);\r\n\r\n  //\r\n  // This hack is needed because the `__proto__` property is still inherited in\r\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\r\n  //\r\n  if (!new Events().__proto__) prefix = false;\r\n}\r\n\r\n/**\r\n * Representation of a single event listener.\r\n *\r\n * @param {Function} fn The listener function.\r\n * @param {*} context The context to invoke the listener with.\r\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\r\n * @constructor\r\n * @private\r\n */\r\nfunction EE(fn, context, once) {\r\n  this.fn = fn;\r\n  this.context = context;\r\n  this.once = once || false;\r\n}\r\n\r\n/**\r\n * Add a listener for a given event.\r\n *\r\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} context The context to invoke the listener with.\r\n * @param {Boolean} once Specify if the listener is a one-time listener.\r\n * @returns {EventEmitter}\r\n * @private\r\n */\r\nfunction addListener(emitter, event, fn, context, once) {\r\n  if (typeof fn !== 'function') {\r\n    throw new TypeError('The listener must be a function');\r\n  }\r\n\r\n  var listener = new EE(fn, context || emitter, once)\r\n    , evt = prefix ? prefix + event : event;\r\n\r\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\r\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\r\n  else emitter._events[evt] = [emitter._events[evt], listener];\r\n\r\n  return emitter;\r\n}\r\n\r\n/**\r\n * Clear event by name.\r\n *\r\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\r\n * @param {(String|Symbol)} evt The Event name.\r\n * @private\r\n */\r\nfunction clearEvent(emitter, evt) {\r\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\r\n  else delete emitter._events[evt];\r\n}\r\n\r\n/**\r\n * Minimal `EventEmitter` interface that is molded against the Node.js\r\n * `EventEmitter` interface.\r\n *\r\n * @constructor\r\n * @public\r\n */\r\nfunction EventEmitter() {\r\n  this._events = new Events();\r\n  this._eventsCount = 0;\r\n}\r\n\r\n/**\r\n * Return an array listing the events for which the emitter has registered\r\n * listeners.\r\n *\r\n * @returns {Array}\r\n * @public\r\n */\r\nEventEmitter.prototype.eventNames = function eventNames() {\r\n  var names = []\r\n    , events\r\n    , name;\r\n\r\n  if (this._eventsCount === 0) return names;\r\n\r\n  for (name in (events = this._events)) {\r\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\r\n  }\r\n\r\n  if (Object.getOwnPropertySymbols) {\r\n    return names.concat(Object.getOwnPropertySymbols(events));\r\n  }\r\n\r\n  return names;\r\n};\r\n\r\n/**\r\n * Return the listeners registered for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Array} The registered listeners.\r\n * @public\r\n */\r\nEventEmitter.prototype.listeners = function listeners(event) {\r\n  var evt = prefix ? prefix + event : event\r\n    , handlers = this._events[evt];\r\n\r\n  if (!handlers) return [];\r\n  if (handlers.fn) return [handlers.fn];\r\n\r\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\r\n    ee[i] = handlers[i].fn;\r\n  }\r\n\r\n  return ee;\r\n};\r\n\r\n/**\r\n * Return the number of listeners listening to a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Number} The number of listeners.\r\n * @public\r\n */\r\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\r\n  var evt = prefix ? prefix + event : event\r\n    , listeners = this._events[evt];\r\n\r\n  if (!listeners) return 0;\r\n  if (listeners.fn) return 1;\r\n  return listeners.length;\r\n};\r\n\r\n/**\r\n * Calls each of the listeners registered for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @returns {Boolean} `true` if the event had listeners, else `false`.\r\n * @public\r\n */\r\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\r\n  var evt = prefix ? prefix + event : event;\r\n\r\n  if (!this._events[evt]) return false;\r\n\r\n  var listeners = this._events[evt]\r\n    , len = arguments.length\r\n    , args\r\n    , i;\r\n\r\n  if (listeners.fn) {\r\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\r\n\r\n    switch (len) {\r\n      case 1: return listeners.fn.call(listeners.context), true;\r\n      case 2: return listeners.fn.call(listeners.context, a1), true;\r\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\r\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\r\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\r\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\r\n    }\r\n\r\n    for (i = 1, args = new Array(len -1); i < len; i++) {\r\n      args[i - 1] = arguments[i];\r\n    }\r\n\r\n    listeners.fn.apply(listeners.context, args);\r\n  } else {\r\n    var length = listeners.length\r\n      , j;\r\n\r\n    for (i = 0; i < length; i++) {\r\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\r\n\r\n      switch (len) {\r\n        case 1: listeners[i].fn.call(listeners[i].context); break;\r\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\r\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\r\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\r\n        default:\r\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\r\n            args[j - 1] = arguments[j];\r\n          }\r\n\r\n          listeners[i].fn.apply(listeners[i].context, args);\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n/**\r\n * Add a listener for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} [context=this] The context to invoke the listener with.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.on = function on(event, fn, context) {\r\n  return addListener(this, event, fn, context, false);\r\n};\r\n\r\n/**\r\n * Add a one-time listener for a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn The listener function.\r\n * @param {*} [context=this] The context to invoke the listener with.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.once = function once(event, fn, context) {\r\n  return addListener(this, event, fn, context, true);\r\n};\r\n\r\n/**\r\n * Remove the listeners of a given event.\r\n *\r\n * @param {(String|Symbol)} event The event name.\r\n * @param {Function} fn Only remove the listeners that match this function.\r\n * @param {*} context Only remove the listeners that have this context.\r\n * @param {Boolean} once Only remove one-time listeners.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\r\n  var evt = prefix ? prefix + event : event;\r\n\r\n  if (!this._events[evt]) return this;\r\n  if (!fn) {\r\n    clearEvent(this, evt);\r\n    return this;\r\n  }\r\n\r\n  var listeners = this._events[evt];\r\n\r\n  if (listeners.fn) {\r\n    if (\r\n      listeners.fn === fn &&\r\n      (!once || listeners.once) &&\r\n      (!context || listeners.context === context)\r\n    ) {\r\n      clearEvent(this, evt);\r\n    }\r\n  } else {\r\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\r\n      if (\r\n        listeners[i].fn !== fn ||\r\n        (once && !listeners[i].once) ||\r\n        (context && listeners[i].context !== context)\r\n      ) {\r\n        events.push(listeners[i]);\r\n      }\r\n    }\r\n\r\n    //\r\n    // Reset the array, or remove it completely if we have no more listeners.\r\n    //\r\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\r\n    else clearEvent(this, evt);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove all listeners, or those of the specified event.\r\n *\r\n * @param {(String|Symbol)} [event] The event name.\r\n * @returns {EventEmitter} `this`.\r\n * @public\r\n */\r\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\r\n  var evt;\r\n\r\n  if (event) {\r\n    evt = prefix ? prefix + event : event;\r\n    if (this._events[evt]) clearEvent(this, evt);\r\n  } else {\r\n    this._events = new Events();\r\n    this._eventsCount = 0;\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n//\r\n// Alias methods names because people roll like that.\r\n//\r\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\r\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\r\n\r\n//\r\n// Expose the prefix.\r\n//\r\nEventEmitter.prefixed = prefix;\r\n\r\n//\r\n// Allow `EventEmitter` to be imported as module namespace.\r\n//\r\nEventEmitter.EventEmitter = EventEmitter;\r\n\r\n//\r\n// Expose the module.\r\n//\r\nif ('undefined' !== typeof module) {\r\n  module.exports = EventEmitter;\r\n}\r\n","/**\r\n * Watcher for click, double-click, or long-click event for both mouse and touch\r\n * @example\r\n * import { clicked } from 'clicked'\r\n *\r\n * function handleClick()\r\n * {\r\n *    console.log('I was clicked.')\r\n * }\r\n *\r\n * const div = document.getElementById('clickme')\r\n * const c = clicked(div, handleClick, { threshold: 15 })\r\n *\r\n * // change callback\r\n * c.callback = () => console.log('different clicker')\r\n *\r\n * // destroy\r\n * c.destroy()\r\n *\r\n * // using built-in querySelector\r\n * clicked('#clickme', handleClick2)\r\n *\r\n * // watching for all types of clicks\r\n * function handleAllClicks(e) {\r\n *     switch (e.type)\r\n *     {\r\n *         case 'clicked': ...\r\n *         case 'double-clicked': ...\r\n *         case 'long-clicked': ...\r\n *     }\r\n *\r\n *     // view UIEvent that caused callback\r\n *     console.log(e.event)\r\n * }\r\n * clicked('#clickme', handleAllClicks, { doubleClicked: true, longClicked: true })\r\n */\r\n\r\n/** @type {object} */\r\nconst defaultOptions = {\r\n    threshold: 10,\r\n    clicked: true,\r\n    doubleClicked: false,\r\n    doubleClickedTime: 300,\r\n    longClicked: false,\r\n    longClickedTime: 500,\r\n    capture: false,\r\n    clickDown: false\r\n}\r\n\r\n/**\r\n * @param {HTMLElement|string} element or querySelector entry (e.g., #id-name or .class-name)\r\n * @param {ClickedCallback} callback called after a click, double click, or long click is registered\r\n * @param {object} [options]\r\n * @param {number} [options.threshold=10] if touch moves threshhold-pixels then the touch-click is cancelled\r\n * @param {boolean} [options.clicked=true] disable watcher for default clicked event\r\n * @param {boolean} [options.doubleClicked] enable watcher for double click\r\n * @param {number} [options.doubleClickedTime=500] wait time in millseconds for double click\r\n * @param {boolean} [options.longClicked] enable watcher for long click\r\n * @param {number} [options.longClickedTime=500] wait time for long click\r\n * @param {boolean} [options.clickDown] enable watcher for click start\r\n * @param {boolean} [options.capture]  events will be dispatched to this registered listener before being dispatched to any EventTarget beneath it in the DOM tree\r\n * @returns {Clicked}\r\n */\r\nexport function clicked(element, callback, options)\r\n{\r\n    return new Clicked(element, callback, options)\r\n}\r\n\r\nclass Clicked\r\n{\r\n    constructor(element, callback, options)\r\n    {\r\n        if (typeof element === 'string')\r\n        {\r\n            element = document.querySelector(element)\r\n            if (!element)\r\n            {\r\n                console.warn(`Unknown element: document.querySelector(${element}) in clicked()`)\r\n                return\r\n            }\r\n        }\r\n        this.options = Object.assign({}, defaultOptions, options)\r\n        this.events = {\r\n            mousedown: (e) => this.mousedown(e),\r\n            mouseup: (e) => this.mouseup(e),\r\n            mousemove: (e) => this.mousemove(e),\r\n            touchstart: (e) => this.touchstart(e),\r\n            touchmove: (e) => this.touchmove(e),\r\n            touchcancel: (e) => this.cancel(e),\r\n            touchend: (e) => this.touchend(e)\r\n        }\r\n        element.addEventListener('mousedown', this.events.mousedown, { capture: this.options.capture })\r\n        element.addEventListener('mouseup', this.events.mouseup, { capture: this.options.capture })\r\n        element.addEventListener('mousemove', this.events.mousemove, { capture: this.options.capture })\r\n        element.addEventListener('touchstart', this.events.touchstart, { passive: true, capture: this.options.capture })\r\n        element.addEventListener('touchmove', this.events.touchmove, { passive: true, capture: this.options.capture })\r\n        element.addEventListener('touchcancel', this.events.touchcancel, { capture: this.options.capture})\r\n        element.addEventListener('touchend', this.events.touchend, { capture: this.options.capture })\r\n        this.element = element\r\n        this.callback = callback\r\n    }\r\n\r\n    /**\r\n     * removes event listeners added by Clicked\r\n     */\r\n    destroy()\r\n    {\r\n        this.element.removeEventListener('mousedown', this.events.mousedown)\r\n        this.element.removeEventListener('mouseup', this.events.mouseup)\r\n        this.element.removeEventListener('mousemove', this.events.mousemove)\r\n        this.element.removeEventListener('touchstart', this.events.touchstart, { passive: true })\r\n        this.element.removeEventListener('touchmove', this.events.touchmove, { passive: true })\r\n        this.element.removeEventListener('touchcancel', this.events.touchcancel)\r\n        this.element.removeEventListener('touchend', this.events.touchend)\r\n    }\r\n\r\n    touchstart(e)\r\n    {\r\n        if (this.down === true)\r\n        {\r\n            this.cancel()\r\n        }\r\n        else\r\n        {\r\n            if (e.touches.length === 1)\r\n            {\r\n                this.handleDown(e.changedTouches[0].screenX, e.changedTouches[0].screenY)\r\n            }\r\n        }\r\n    }\r\n\r\n    pastThreshold(x, y)\r\n    {\r\n        return Math.abs(this.lastX - x) > this.options.threshold || Math.abs(this.lastY - y) > this.options.threshold\r\n    }\r\n\r\n    touchmove(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            if (e.touches.length !== 1)\r\n            {\r\n                this.cancel()\r\n            }\r\n            else\r\n            {\r\n                const x = e.changedTouches[0].screenX\r\n                const y = e.changedTouches[0].screenY\r\n                if (this.pastThreshold(x, y))\r\n                {\r\n                    this.cancel()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** cancel current event */\r\n    cancel()\r\n    {\r\n        this.down = false\r\n        if (this.doubleClickedTimeout)\r\n        {\r\n            clearTimeout(this.doubleClickedTimeout)\r\n            this.doubleClickedTimeout = null\r\n        }\r\n        if (this.longClickedTimeout)\r\n        {\r\n            clearTimeout(this.longClickedTimeout)\r\n            this.longClickedTimeout = null\r\n        }\r\n    }\r\n\r\n    touchend(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            e.preventDefault()\r\n            this.handleClicks(e, e.pointerId)\r\n        }\r\n    }\r\n\r\n    handleClicks(e)\r\n    {\r\n        if (this.options.doubleClicked)\r\n        {\r\n            this.doubleClickedTimeout = setTimeout(() => this.doubleClickedCancel(e), this.options.doubleClickedTime)\r\n        }\r\n        else if (this.options.clicked)\r\n        {\r\n            this.callback({ event: e, type: 'clicked' })\r\n        }\r\n        if (this.longClickedTimeout)\r\n        {\r\n            clearTimeout(this.longClickedTimeout)\r\n            this.longClickedTimeout = null\r\n        }\r\n        this.down = false\r\n    }\r\n\r\n    handleDown(e, x, y)\r\n    {\r\n        if (this.doubleClickedTimeout)\r\n        {\r\n            if (this.pastThreshold(x, y))\r\n            {\r\n                if (this.options.clicked)\r\n                {\r\n                    this.callback({ event: e, type: 'clicked' })\r\n                }\r\n                this.cancel()\r\n            }\r\n            else\r\n            {\r\n                this.callback({ event: e, type: 'double-clicked' })\r\n                this.cancel()\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.lastX = x\r\n            this.lastY = y\r\n            this.down = true\r\n            if (this.options.longClicked)\r\n            {\r\n                this.longClickedTimeout = setTimeout(() => this.longClicked(e), this.options.longClickedTime)\r\n            }\r\n            if (this.options.clickDown) {\r\n                this.callback({ event: e, type: 'click-down' })\r\n            }\r\n        }\r\n    }\r\n\r\n    longClicked(e)\r\n    {\r\n        this.longClikedTimeout = null\r\n        this.down = false\r\n        this.callback({ event: e, type: 'long-clicked' })\r\n    }\r\n\r\n    doubleClickedCancel(e)\r\n    {\r\n        this.doubleClickedTimeout = null\r\n        if (this.options.clicked)\r\n        {\r\n            this.callback({ event: e, type: 'double-clicked' })\r\n        }\r\n    }\r\n\r\n    mousedown(e)\r\n    {\r\n        if (this.down === true)\r\n        {\r\n            this.down = false\r\n        }\r\n        else\r\n        {\r\n            this.handleDown(e, e.screenX, e.screenY)\r\n        }\r\n    }\r\n\r\n    mousemove(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            const x = e.screenX\r\n            const y = e.screenY\r\n            if (this.pastThreshold(x, y))\r\n            {\r\n                this.cancel()\r\n            }\r\n        }\r\n    }\r\n\r\n    mouseup(e)\r\n    {\r\n        if (this.down)\r\n        {\r\n            e.preventDefault()\r\n            this.handleClicks(e)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Callback for\r\n * @callback Clicked~ClickedCallback\r\n * @param {UIEvent} event\r\n * @param {('clicked'|'double-clicked'|'long-clicked'|'click-down')} type\r\n */","import Events from 'eventemitter3'\r\nimport { clicked } from 'clicked'\r\n\r\nimport { html } from './html'\r\n\r\n\r\nconst ResizeDirections = {\r\n    Up: 'up',\r\n    Down: 'down',\r\n    Left: 'left',\r\n    Right: 'right',\r\n}\r\n\r\nconst RESIZE_PREFIX = 'resize'\r\n\r\n/**\r\n * Window class returned by WindowManager.createWindow()\r\n * @extends EventEmitter\r\n * @fires open\r\n * @fires focus\r\n * @fires blur\r\n * @fires close\r\n * @fires maximize\r\n * @fires maximize-restore\r\n * @fires move\r\n * @fires move-start\r\n * @fires move-end\r\n * @fires resize\r\n * @fires resize-start\r\n * @fires resize-end\r\n * @fires move-x\r\n * @fires move-y\r\n * @fires resize-width\r\n * @fires resize-height\r\n */\r\nexport class Window extends Events {\r\n    /**\r\n     * @param {WindowManager} [wm]\r\n     * @param {object} [options]\r\n     */\r\n    constructor(wm, options = {}) {\r\n        super()\r\n        this.wm = wm\r\n        this.options = options\r\n        this.id = typeof this.options.id === 'undefined' ? Window.id++ : this.options.id\r\n        this._createWindow()\r\n        this._listeners()\r\n\r\n        this.active = false\r\n        this.maximized = false\r\n\r\n        this._closed = true\r\n        this._restore = null\r\n        this._moving = null\r\n        this._prevPosition = null\r\n        this._resizing = null\r\n        this._attachedToScreen = { vertical: '', horziontal: '' }\r\n        this.verticalResize = false;\r\n        this.horizontalResize = false;\r\n    }\r\n\r\n    /**\r\n     * open the window\r\n     * @param {boolean} [noFocus] do not focus window when opened\r\n     */\r\n    open(noFocus) {\r\n        if (this._closed) {\r\n            this.win.style.display = 'block'\r\n            this._closed = false\r\n            this.emit('open', this)\r\n            if (!noFocus) {\r\n                this.focus()\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * focus the window\r\n     */\r\n    focus() {\r\n        this.active = true\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarActive\r\n        }\r\n        this.emit('focus', this)\r\n    }\r\n\r\n    /**\r\n     * blur the window\r\n     */\r\n    blur() {\r\n        this.active = false\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar.style.backgroundColor = this.options.backgroundTitlebarInactive\r\n        }\r\n        this.emit('blur', this)\r\n    }\r\n\r\n    /**\r\n     * closes the window (can be reopened with open)\r\n     */\r\n    close() {\r\n        if (!this._closed) {\r\n            this._closed = true\r\n            this.win.style.display = 'none'\r\n            this.emit('close', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * is window closed?\r\n     * @type {boolean}\r\n     * @readonly\r\n     */\r\n    get closed() {\r\n        return this._closed\r\n    }\r\n\r\n    /**\r\n     * left coordinate\r\n     * @type {number}\r\n     */\r\n    get x() { return this.options.x }\r\n    set x(value) {\r\n        if (value !== this.options.x) {\r\n            this.options.x = value\r\n            this.emit('move-x', this)\r\n            this._buildTransform()\r\n        }\r\n    }\r\n\r\n    _buildTransform() {\r\n        this.win.style.transform = `translate(${this.options.x}px,${this.options.y}px)`\r\n    }\r\n\r\n    /**\r\n     * top coordinate\r\n     * @type {number}\r\n     */\r\n    get y() { return this.options.y }\r\n    set y(value) {\r\n        if (value !== this.options.y) {\r\n            this.options.y = value\r\n            this._buildTransform()\r\n            this.emit('move-y', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * width of window\r\n     * @type {number}\r\n     */\r\n    get width() { return this.options.width || this.win.offsetWidth }\r\n    set width(value) {\r\n        if (value !== this.options.width) {\r\n            if (value) {\r\n                this.win.style.width = `${value}px`\r\n                this.options.width = this.win.offsetWidth\r\n            }\r\n            else {\r\n                this.win.style.width = 'auto'\r\n                this.options.width = ''\r\n            }\r\n            this.emit('resize-width', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * height of window\r\n     * @type {number}\r\n     */\r\n    get height() { return this.options.height || this.win.offsetHeight }\r\n    set height(value) {\r\n        if (value !== this.options.height) {\r\n            if (value) {\r\n                this.win.style.height = `${value}px`\r\n                this.options.height = this.win.offsetHeight\r\n            }\r\n            else {\r\n                this.win.style.height = 'auto'\r\n                this.options.height = ''\r\n            }\r\n            this.emit('resize-height', this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * resize the window\r\n     * @param {number} width\r\n     * @param {number} height\r\n     */\r\n    resize(width, height) {\r\n        this.width = width\r\n        this.height = height\r\n    }\r\n\r\n    /**\r\n     * move window\r\n     * @param {number} x\r\n     * @param {number} y\r\n     */\r\n    move(x, y) {\r\n        const keepInside = this.keepInside\r\n        if (keepInside) {\r\n            const bounds = this.bounds\r\n            if (keepInside === true || keepInside === 'horizontal') {\r\n                x = x + this.width > bounds.right ? bounds.right - this.width : x\r\n                x = x < bounds.left ? bounds.left : x\r\n            }\r\n            if (keepInside === true || keepInside === 'vertical') {\r\n                y = y + this.height > bounds.bottom ? bounds.bottom - this.height : y\r\n                y = y < bounds.top ? bounds.top : y\r\n            }\r\n        }\r\n        if (x !== this.options.x) {\r\n            this.options.x = x\r\n            this.emit('move-x', this)\r\n        }\r\n        if (y !== this.options.y) {\r\n            this.options.y = y\r\n            this.emit('move-y', this)\r\n        }\r\n        this._buildTransform()\r\n    }\r\n\r\n    /**\r\n     * maximize the window\r\n     */\r\n    maximize() {\r\n        if (this.options.maximizable) {\r\n            if (this.maximized) {\r\n                this.x = this.maximized.x\r\n                this.y = this.maximized.y\r\n                this.width = this.maximized.width\r\n                this.height = this.maximized.height\r\n                this.maximized = null\r\n                this.emit('restore', this)\r\n                this.buttons.maximize.className = 'icon-maximize-window';\r\n                this.buttons.maximize.innerHTML = this.options.maximizeButton\r\n            }\r\n            else {\r\n                const x = this.x, y = this.y, width = this.win.offsetWidth, height = this.win.offsetHeight\r\n                this.maximized = { x, y, width, height }\r\n                this.x = 0\r\n                this.y = 0\r\n                this.width = this.wm.overlay.offsetWidth\r\n                this.height = this.wm.overlay.offsetHeight\r\n                this.emit('maximize', this)\r\n                this.buttons.maximize.className = 'icon-full-screen-window';\r\n                this.buttons.maximize.innerHTML = this.options.restoreButton\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * sends window to back of window-manager\r\n     */\r\n    sendToBack() {\r\n        this.wm.sendToBack(this)\r\n    }\r\n\r\n    /**\r\n     * send window to front of window-manager\r\n     */\r\n    sendToFront() {\r\n        this.wm.sendToFront(this)\r\n    }\r\n\r\n    /**\r\n     * save the state of the window\r\n     * @return {object} data\r\n     */\r\n    save() {\r\n        const data = {}\r\n        const maximized = this.maximized\r\n        if (maximized) {\r\n            data.maximized = { left: maximized.left, top: maximized.top, width: maximized.width, height: maximized.height }\r\n        }\r\n        data.x = this.x\r\n        data.y = this.y\r\n        if (typeof this.options.width !== 'undefined') {\r\n            data.width = this.options.width\r\n        }\r\n        if (typeof this.options.height !== 'undefined') {\r\n            data.height = this.options.height\r\n        }\r\n        data.closed = this._closed\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * return the state of the window\r\n     * @param {object} data from save()\r\n     */\r\n    load(data) {\r\n        if (data.maximized) {\r\n            if (!this.maximized) {\r\n                this.maximize(true)\r\n            }\r\n        }\r\n        else if (this.maximized) {\r\n            this.maximize(true)\r\n        }\r\n        this.x = data.x\r\n        this.y = data.y\r\n        if (typeof data.width !== 'undefined') {\r\n            this.width = data.width\r\n        }\r\n        else {\r\n            this.win.style.width = 'auto'\r\n        }\r\n        if (typeof data.height !== 'undefined') {\r\n            this.height = data.height\r\n        }\r\n        else {\r\n            this.win.style.height = 'auto'\r\n        }\r\n        if (data.closed) {\r\n            this.close(true)\r\n        }\r\n        else if (this.closed) {\r\n            this.open(true, true)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * change title\r\n     * @type {string}\r\n     */\r\n    get title() { return this._title }\r\n    set title(value) {\r\n        this.winTitle.innerText = value\r\n        this.emit('title-change', this)\r\n    }\r\n\r\n\r\n    /**\r\n     * right coordinate of window\r\n     * @type {number}\r\n     */\r\n    get right() { return this.x + this.width }\r\n    set right(value) {\r\n        this.x = value - this.width\r\n    }\r\n\r\n    /**\r\n     * bottom coordinate of window\r\n     * @type {number}\r\n     */\r\n    get bottom() { return this.y + this.height }\r\n    set bottom(value) {\r\n        this.y = value - this.height\r\n    }\r\n\r\n    /**\r\n     * centers window in middle of other window or document.body\r\n     * @param {Window} [win]\r\n     */\r\n    center(win) {\r\n        if (win) {\r\n            this.move(\r\n                win.x + win.width / 2 - this.width / 2,\r\n                win.y + win.height / 2 - this.height / 2\r\n            )\r\n        }\r\n        else {\r\n            this.move(\r\n                window.innerWidth / 2 - this.width / 2,\r\n                window.innerHeight / 2 - this.height / 2\r\n            )\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fires when window is maximized\r\n     * @event Window#maximize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window is restored to normal after being maximized\r\n     * @event Window#maximize-restore\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window opens\r\n     * @event Window#open\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when window gains focus\r\n     * @event Window#focus\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window loses focus\r\n     * @event Window#blur\r\n     * @type {Window}\r\n     */\r\n    /**\r\n     * Fires when window closes\r\n     * @event Window#close\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when resize starts\r\n     * @event Window#resize-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after resize completes\r\n     * @event Window#resize-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during resizing\r\n     * @event Window#resize\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when move starts\r\n     * @event Window#move-start\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires after move completes\r\n     * @event Window#move-end\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires during move\r\n     * @event Window#move\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when width is changed\r\n     * @event Window#resize-width\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when height is changed\r\n     * @event Window#resize-height\r\n     * @type {Window}\r\n     */\r\n\r\n    /**\r\n     * Fires when x position of window is changed\r\n     * @event Window#move-x\r\n     * @type {Window}\r\n     */\r\n\r\n\r\n    /**\r\n     * Fires when y position of window is changed\r\n     * @event Window#move-y\r\n     * @type {Window}\r\n     */\r\n\r\n    _createWindow() {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        const winStyles = {\r\n            'user-select': 'none',\r\n            'overflow': 'hidden',\r\n            'position': 'absolute',\r\n            'min-width': this.options.minWidth,\r\n            'min-height': this.options.minHeight,\r\n            'width': isNaN(this.options.width) ? this.options.width : this.options.width + 'px',\r\n            'height': isNaN(this.options.height) ? this.options.height : this.options.height + 'px',\r\n            ...this.options.styles\r\n        }\r\n\r\n        this.win = html({\r\n            parent: (this.wm ? this.wm.win : null), \r\n            styles: winStyles,\r\n            className: this.options.classNames.win \r\n                ? this.options.classNames.win + ' frame'\r\n                : 'frame'\r\n        })\r\n\r\n        this.winBox = html({\r\n            parent: this.win, styles: {\r\n                'display': 'flex',\r\n                'flex-direction': 'column',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'min-height': this.options.minHeight,\r\n                'background-color': this.options.style\r\n            },\r\n            className: this.options.classNames.winBox \r\n                ? this.options.classNames.winBox  + ' container'\r\n                : 'container'\r\n        })\r\n        this._createTitlebar()\r\n\r\n        /**\r\n         * This is the content DOM element. Use this to add content to the Window.\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.content = html({\r\n            parent: this.winBox, type: 'section', styles: {\r\n                'min-height': this.minHeight,\r\n                'overflow-x': 'hidden',\r\n                'overflow-y': 'auto'\r\n            },\r\n            className: this.options.classNames.content\r\n        })\r\n\r\n        if (this.options.resizable) {\r\n            this._createResize()\r\n        }\r\n\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'display': 'none',\r\n                'position': 'absolute',\r\n                'left': 0,\r\n                'top': 0,\r\n                'width': '100%',\r\n                'height': '100%'\r\n            },\r\n            className: this.options.classNames.overlay\r\n        })\r\n        this.overlay.addEventListener('mousedown', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this.overlay.addEventListener('touchstart', (e) => { this._downTitlebar(e); e.stopPropagation() })\r\n        this._buildTransform()\r\n    }\r\n\r\n    _downTitlebar(e) {\r\n        const event = this._convertMoveEvent(e)\r\n        this._moving = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n        this.emit('move-start', this)\r\n        this._moved = false\r\n    }\r\n\r\n    _createTitlebar() {\r\n        const headerStyles = {\r\n            'user-select': 'none',\r\n            'display': 'flex',\r\n            'flex-direction': 'row',\r\n            'overflow': 'hidden',\r\n            'height': this.options.titlebarHeight,\r\n            'min-height': this.options.titlebarHeight,\r\n        }\r\n\r\n        if (this.options.titlebar) {\r\n            this.winTitlebar = html({\r\n                parent: this.winBox, type: 'header', \r\n                styles: headerStyles,\r\n                className: this.options.classNames.titlebar\r\n            })\r\n\r\n            this.frameManager = html({\r\n                parent: this.winTitlebar,\r\n                className: 'frame-manager',\r\n                childElements: [this.options.frameManager],\r\n            });\r\n\r\n            this.headerTitle = html({\r\n                parent: this.winTitlebar,\r\n                html: this.options.title, \r\n                className: 'title',\r\n            });\r\n\r\n            this.headerToolbar = html({\r\n                parent: this.winTitlebar,\r\n                className: 'tool-bar',\r\n                childElements: this.options.toolbarInstruments,\r\n            });\r\n\r\n            this._createButtons()\r\n\r\n            if (this.options.movable) {\r\n                this.winTitlebar.addEventListener('mousedown', (e) => this._downTitlebar(e))\r\n                this.winTitlebar.addEventListener('touchstart', (e) => this._downTitlebar(e))\r\n            }\r\n            if (this.options.maximizable) {\r\n                clicked(this.winTitlebar, () => this.maximize(), { doubleClicked: true, clicked: false })\r\n            }\r\n        }\r\n    }\r\n\r\n    _createButtons() {\r\n\r\n        this.winButtonGroup = html({\r\n            parent: this.winTitlebar,\r\n            className: 'control-bar',\r\n        });\r\n\r\n        this.buttons = {}\r\n\r\n        if (this.options.minimizable) {\r\n            this.buttons.minimize = html({ \r\n                parent: this.winButtonGroup, \r\n                type: 'button', \r\n                html: this.options.minimizeButton,\r\n            })\r\n            clicked(this.buttons.minimize, () => this.minimize())\r\n        }\r\n\r\n        if (this.options.maximizable) {\r\n            this.buttons.maximize = html({ \r\n                parent: this.winButtonGroup, \r\n                html: this.options.maximizeButton, \r\n                type: 'button',\r\n            })\r\n            clicked(this.buttons.maximize, () => this.maximize())\r\n        }\r\n\r\n        if (this.options.closable) {\r\n            this.buttons.close = html({ \r\n                parent: this.winButtonGroup, \r\n                html: this.options.closeButton,\r\n                type: 'button',\r\n            })\r\n            clicked(this.buttons.close, () => this.close())\r\n        }\r\n\r\n        for (let key in this.buttons) {\r\n            const button = this.buttons[key]\r\n            button.addEventListener('mousemove', () => {\r\n                button.style.opacity = 1\r\n            })\r\n            button.addEventListener('mouseout', () => {\r\n                button.style.opacity = 0.7\r\n            })\r\n        }\r\n    }\r\n\r\n    _createResize() {\r\n        // this.resizeEdge = html({\r\n        //     parent: this.winBox, type: 'button', html: this.options.backgroundResize, styles: {\r\n        //         'position': 'absolute',\r\n        //         'bottom': 0,\r\n        //         'right': '4px',\r\n        //         'border': 0,\r\n        //         'margin': 0,\r\n        //         'padding': 0,\r\n        //         'cursor': 'se-resize',\r\n        //         'user-select': 'none',\r\n        //         'height': '15px',\r\n        //         'width': '10px',\r\n        //         'background': 'none'\r\n        //     },\r\n        //     className: this.options.classNames.resizeEdge\r\n        // })\r\n        // const resize = e => {\r\n        //     if (!this.verticalResize && !this.horizontalResize)\r\n        //         return;\r\n\r\n        //     const event = this._convertMoveEvent(e);\r\n        //     // const width = this.width || this.win.offsetWidth;\r\n        //     // const height = this.height || this.win.offsetHeight;\r\n        //     // const newWidth = width - event.pageX;\r\n        //     // const newHeight = height - event.pageY;\r\n\r\n        //     // this._resizing = {\r\n        //     //     width: newWidth,\r\n        //     //     height: newHeight,\r\n        //     // }\r\n\r\n        //     // this._resizing = {\r\n        //     //     height: event.pageY,\r\n        //     //     width: event.pageX,\r\n        //     // };\r\n\r\n        //     // let x = null;\r\n        //     // let y = null;\r\n\r\n        //     if (this.horizontalResize === ResizeDirections.Left || this.horizontalResize === ResizeDirections.Top) {\r\n        //         // x = event.pageX - this.x;\r\n        //         this._moving = {\r\n        //             x: event.pageX,\r\n        //             y: event.pageY,\r\n        //         }\r\n\r\n        //     }\r\n\r\n        //     // if (this.horizontalResize === ResizeDirections.Top) {\r\n        //     //     // y = event.pageY - this.y;\r\n        //     // }\r\n\r\n        //     // // this._moving = {\r\n        //     // //     x: event.pageX - this.x,\r\n        //     // //     y: event.pageY - this.y\r\n        //     // // }\r\n\r\n        //     // // this._moving = { x, y };\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // }\r\n\r\n        // this.winBox.addEventListener('mousedown', resize)\r\n        // this.winBox.addEventListener('touchstart', resize)\r\n        // this.winBox.addEventListener('mousemove', (e) => {\r\n        //     const event = this._convertMoveEvent(e)\r\n        //     const up = Math.abs(event.pageY - this.y) < 13;\r\n        //     const down = Math.abs(event.pageY - (this.y + this.height)) < 13;\r\n        //     const left = Math.abs(event.pageX - this.x) < 13;\r\n        //     const right = Math.abs(event.pageX - (this.x + this.width)) < 13;\r\n\r\n        //     if (up) {\r\n        //         this.verticalResize = ResizeDirections.Up;\r\n        //     } else if (down) {\r\n        //         this.verticalResize = ResizeDirections.Down;\r\n        //     } else {\r\n        //         this.verticalResize = null;\r\n        //     }\r\n\r\n        //     if (left) {\r\n        //         this.horizontalResize = ResizeDirections.Left;\r\n        //     } else if (right) {\r\n        //         this.horizontalResize = ResizeDirections.Right;\r\n        //     } else {\r\n        //         this.horizontalResize = null;\r\n        //     }\r\n\r\n        //     if (this.verticalResize || this.horizontalResize) {\r\n        //         const newClass = [RESIZE_PREFIX, this.verticalResize, this.horizontalResize].filter(Boolean).join('-');\r\n        //         if (this.win.className.includes(RESIZE_PREFIX))\r\n        //             this.win.className = this.win.className.replace(/resize-.*/gi, newClass);\r\n        //         else\r\n        //             this.win.className += ` ${newClass}`;\r\n        //     } else {\r\n        //         this.win.className = this.win.className.replace(/resize-.*\\s/gi, '');\r\n        //     }\r\n\r\n        //     // console.log('down', this.win.className);\r\n        //     this.emit('resize-start');\r\n        //     e.preventDefault();\r\n        // })\r\n    }\r\n\r\n    _getHitTestState(event, prevResizingState) {\r\n        const offset = prevResizingState ? 10000 : 10;\r\n        const up = Math.abs(event.pageY - this.y) < offset;\r\n        const down = Math.abs(event.pageY - (this.y + this.height)) < offset;\r\n        const left = Math.abs(event.pageX - this.x) < offset;\r\n        const right = Math.abs(event.pageX - (this.x + this.width)) < offset;\r\n\r\n        let horizontal;\r\n        let vertical;\r\n\r\n        if (up) {\r\n            vertical = ResizeDirections.Up;\r\n        } else if (down) {\r\n            vertical = ResizeDirections.Down;\r\n        } else {\r\n            vertical = null;\r\n        }\r\n\r\n        if (left) {\r\n            horizontal = ResizeDirections.Left;\r\n        } else if (right) {\r\n            horizontal = ResizeDirections.Right;\r\n        } else {\r\n            horizontal = null;\r\n        }\r\n\r\n        if (horizontal || vertical) {\r\n            return prevResizingState || {\r\n                horizontal,\r\n                vertical,\r\n            }\r\n        }\r\n\r\n        var _offset = prevResizingState ? 10000 : 0;\r\n\r\n        if (\r\n            event.pageX >= (this.x - _offset) &&\r\n            event.pageX <= ((this.x + this.width + _offset)) &&\r\n            event.pageY >= (this.y - _offset) &&\r\n            event.pageY <= ((this.y + this.height + _offset))\r\n        ) return prevResizingState || {};\r\n\r\n        return null;\r\n    }\r\n\r\n    _move(e) {\r\n        const event = this._convertMoveEvent(e)\r\n        const resizingState = this._getHitTestState(event, this._resizing);\r\n        // console.log(JSON.stringify(resizingState));\r\n        // console.log('sacce', e.changedTouches, resizingState)\r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } else {\r\n            // resizingState = this._resizing;\r\n            // this._resizing = null;\r\n            // this._prevPosition = null;\r\n        }\r\n\r\n        // if (e.type === 'mousemove' || e.type === 'touchmove')\r\n        //     this._resizing = resizingState;\r\n        // else {\r\n        //     this._resizing = null;\r\n        //     this._prevPosition = null;\r\n        // }\r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } \r\n\r\n        if (!this._resizing && !this._isTouchEvent(e) && e.which === 1) {\r\n            this._resizing = resizingState;\r\n        } \r\n\r\n        if (resizingState == null) {\r\n            this.win.className = this.win.className.replace(/resize-.*\\s?/gi, '').trim();\r\n            this._prevPosition = null;\r\n            this._resizing = null;\r\n            return;\r\n        }\r\n\r\n        if (resizingState.horizontal || resizingState.vertical) {\r\n            if (!this._resizing)\r\n                this.emit('resize-start');\r\n\r\n            // this._resizing = resizingState;\r\n            const newClass = [RESIZE_PREFIX, resizingState.horizontal, resizingState.vertical].filter(Boolean).join('-');\r\n            if (this.win.className.includes(RESIZE_PREFIX))\r\n                this.win.className = this.win.className.replace(/resize-.*\\s?/gi, newClass).trim();\r\n            else\r\n                this.win.className += ` ${newClass}`;\r\n\r\n            // e.preventDefault();\r\n            this._moving = false;\r\n        } else {\r\n            this._moving = true;\r\n\r\n            this.win.className = this.win.className.replace(/resize-.*\\s?/gi, '').trim();\r\n        }\r\n\r\n        const dx = this._prevPosition ? event.pageX - this._prevPosition.x : null;\r\n        const dy = this._prevPosition ? event.pageY - this._prevPosition.y : null;\r\n\r\n        this._prevPosition = {\r\n            x: event.pageX,\r\n            y: event.pageY,\r\n        }\r\n\r\n        if (dx == null || dy == null) {\r\n            return resizingState != null;\r\n        }\r\n\r\n        if ((!this._isTouchEvent(e) && e.which !== 1)) {\r\n            if (this._moving) {\r\n                this._stopMove()\r\n            }\r\n            if (this._resizing) {\r\n                this._stopResize()\r\n            }\r\n        }\r\n\r\n        else if (this._moving) {\r\n            this.move(\r\n                this.x + dx,\r\n                this.y + dy,\r\n            );\r\n\r\n            this.emit('move', this)\r\n            e.preventDefault()\r\n        } else if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? 1 : -1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? 1 : -1;\r\n\r\n            this.move(\r\n                resizingState.horizontal == ResizeDirections.Left ? this.x + dx * xMutiplier : this.x,\r\n                resizingState.vertical == ResizeDirections.Up ? this.y + dy * yMutiplier : this.y\r\n            );\r\n        }\r\n\r\n        if (this._resizing) {\r\n            const yMutiplier = resizingState.vertical === ResizeDirections.Up ? -1 : 1;\r\n            const xMutiplier = resizingState.horizontal === ResizeDirections.Left ? -1 : 1;\r\n\r\n            this.resize(\r\n                resizingState.horizontal ? this.width + dx * xMutiplier : this.width,\r\n                resizingState.vertical ? this.height + dy * yMutiplier : this.height,\r\n            );\r\n\r\n            this.maximized = null;\r\n            this.emit('resize', this);\r\n            e.preventDefault();\r\n        }\r\n\r\n        return resizingState != null;\r\n    }\r\n\r\n    _up() {\r\n        if (this._moving) {\r\n            this._stopMove()\r\n        }\r\n        if (this._resizing) {\r\n            this._stopResize()\r\n        }\r\n    }\r\n\r\n    _listeners() {\r\n        this.win.addEventListener('mousedown', () => this.focus())\r\n        this.win.addEventListener('touchstart', () => this.focus())\r\n    }\r\n\r\n    _stopMove() {\r\n        this._moving = null\r\n        this.emit('move-end', this)\r\n    }\r\n\r\n    _stopResize() {\r\n        this._restore = this._resizing = null\r\n        this.emit('resize-end', this)\r\n    }\r\n\r\n    _isTouchEvent(e) {\r\n        return !!window.TouchEvent && (e instanceof window.TouchEvent)\r\n    }\r\n\r\n    _convertMoveEvent(e) {\r\n        return this._isTouchEvent(e) ? e.changedTouches[0] : e\r\n    }\r\n\r\n    /**\r\n     * attaches window to a side of the screen\r\n     * @param {('horizontal'|'vertical')} direction\r\n     * @param {('left'|'right'|'top'|'bottom')} location\r\n     */\r\n    attachToScreen(direction, location) {\r\n        this._attachedToScreen[direction] = location\r\n    }\r\n\r\n    /**\r\n     * @param {Bounds} bounds\r\n     * @param {(boolean|'horizontal'|'vertical')} keepInside\r\n     */\r\n    resizePlacement(bounds, keepInside) {\r\n        this.bounds = bounds\r\n        this.keepInside = keepInside\r\n        let x = this.x\r\n        let y = this.y\r\n        x = this._attachedToScreen.horziontal === 'right' ? bounds.right - this.width : x\r\n        x = this._attachedToScreen.horizontal === 'left' ? bounds.left : x\r\n        y = this._attachedToScreen.vertical === 'bottom' ? bounds.bottom - this.height : y\r\n        y = this._attachedToScreen.vertical === 'top' ? bounds.top : y\r\n        this.move(x, y)\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [ignoreClosed]\r\n     * @returns {boolean}\r\n     */\r\n    isModal(ignoreClosed) {\r\n        return (ignoreClosed || !this._closed) && this.options.modal\r\n    }\r\n\r\n    /** @returns {boolean} */\r\n    isClosed() {\r\n        return this._closed\r\n    }\r\n\r\n    get z() {\r\n        return parseInt(this.win.style.zIndex)\r\n    }\r\n    set z(value) {\r\n        this.win.style.zIndex = value\r\n    }\r\n}\r\n\r\nWindow.id = 0","export const close='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"close\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><path d=\"M3.5,3.5l13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/><path d=\"M16.5,3.5l-13,13\" style=\"fill:none;stroke:#fff;stroke-width:3px;\"/></g></svg>';export const maximize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"maximize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"16\" style=\"fill:none;stroke:#fff;stroke-width:2px;\"/><rect x=\"2\" y=\"2\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const minimize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"minimize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><rect x=\"2\" y=\"15.6\" width=\"16\" height=\"3.2\" style=\"fill:#fff;\"/></svg>';export const resize='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\"><rect id=\"resize\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><clipPath id=\"_clip1\"><rect x=\"0\" y=\"0\" width=\"20\" height=\"20\"/></clipPath><g clip-path=\"url(#_clip1)\"><rect x=\"0\" y=\"16.8\" width=\"20\" height=\"3.2\" style=\"fill:#fff;\"/><path d=\"M17.737,3.595l-14.142,14.142l2.263,2.263l14.142,-14.142l-2.263,-2.263Z\" style=\"fill:#fff;\"/><path d=\"M16.8,0l0,20l3.2,0l0,-20l-3.2,0Z\" style=\"fill:#fff;\"/><path d=\"M7.099,18.4l11.301,-11.123l0,11.123l-11.301,0Z\" style=\"fill:#fff;\"/></g></svg>';export const restore='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg width=\"100%\" height=\"100%\" viewBox=\"0 0 20 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;\"><rect id=\"restore\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" style=\"fill:none;\"/><g><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><rect x=\"7\" y=\"2.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"10\" style=\"fill:none;stroke:#fff;stroke-width:1.5px;\"/><g><rect x=\"3\" y=\"7.5\" width=\"10\" height=\"2\" style=\"fill:#fff;\"/></g></g></svg>';","import { close, maximize, restore, resize, minimize } from './images'\r\n\r\n/**\r\n * @typedef {object} WindowOptions\r\n * @property {number} [x=0]\r\n * @property {number} [y=0]\r\n * @property {number} [width]\r\n * @property {number} [height]\r\n * @property {boolean} [modal]\r\n * @property {boolean} [openOnCreate=true]\r\n * @property {boolean} [movable=true]\r\n * @property {boolean} [resizable=true]\r\n * @property {boolean} [maximizable=true]\r\n * @property {boolean} [closable=true]\r\n * @property {boolean} [noSnap] don't snap this window or use this window as a snap target\r\n * @property {boolean} [titlebar=true]\r\n * @property {string} [titlebarHeight=36px]\r\n * @property {boolean} [titleCenter]\r\n * @property {string} [minWidth=200px]\r\n * @property {string} [minHeight=60px]\r\n * @property {string} [borderRadius=4px]\r\n * @property {object} [styles]\r\n * @property {string} [shadow='0 0 12px 1px rgba(0, 0, 0, 0.6)']\r\n * @property {number} [animateTime=250]\r\n * @property {string} [backgroundModal=rgba(0,0,0,0.6)]\r\n * @property {string} [backgroundWindow=#fefefe]\r\n * @property {string} [backgroundTitlebarActive=#365d98]\r\n * @property {string} [backgroundTitlebarInactive=#888888]\r\n * @property {string} [foregroundButton=#ffffff]\r\n * @property {string} [foregroundTitle=#ffffff]\r\n * @property {string} [maximizeButton=...]\r\n * @property {string} [closeButton=...]\r\n * @property {string} [resize=...]\r\n */\r\nexport const windowOptions = {\r\n    x: 0,\r\n    y: 0,\r\n    width: undefined,\r\n    height: undefined,\r\n    modal: false,\r\n    openOnCreate: true,\r\n\r\n    classNames: {},\r\n\r\n    minWidth: '200px',\r\n    minHeight: '60px',\r\n    borderRadius: 0,\r\n    styles: {},\r\n\r\n    shadow: 'none',\r\n    movable: true,\r\n    resizable: true,\r\n    maximizable: true,\r\n    minimizable: true,\r\n    closable: true,\r\n\r\n    titlebar: true,\r\n\r\n    closeButton: close,\r\n    maximizeButton: maximize,\r\n    restoreButton: restore,\r\n    minimizeButton: minimize,\r\n\r\n    backgroundResize: resize\r\n}","import { html } from './html'\r\n\r\nconst DEFAULT_COLOR = '#a8f0f4'\r\nconst DEFAULT_SIZE = 10\r\n\r\nconst SnapOptionsDefault = {\r\n    screen: true,\r\n    windows: true,\r\n    snap: 20,\r\n    color: DEFAULT_COLOR,\r\n    spacing: 5,\r\n    indicator: DEFAULT_SIZE\r\n}\r\n\r\nexport class Snap\r\n{\r\n    /**\r\n     * add edge snapping plugin\r\n     * @param {WindowManager} wm\r\n     * @param {object} [options]\r\n     * @param {boolean} [options.screen=true] snap to screen edges\r\n     * @param {boolean} [options.windows=true] snap to window edges\r\n     * @param {number} [options.snap=20] distance to edge in pixels before snapping and width/height of snap bars\r\n     * @param {string} [options.color=#a8f0f4] color for snap bars\r\n     * @param {number} [options.spacing=5] spacing distance between window and edges\r\n     * @param {number} [options.indicator=10] size in pixels of snapping indicator (the indicator is actually twice the size of what is shown)\r\n     */\r\n    constructor(wm, options={})\r\n    {\r\n        this.wm = wm\r\n        this.options = Object.assign({}, SnapOptionsDefault, options)\r\n        this.highlights = html({ parent: this.wm.overlay, styles: { 'position': 'absolute' } })\r\n        this.horizontal = html({\r\n            parent: this.highlights, styles: {\r\n                display: 'none',\r\n                position: 'absolute',\r\n                height: `${this.options.indicator}px`,\r\n                borderRadius: `${this.options.indicator}px`,\r\n                backgroundColor: this.options.color\r\n            }\r\n        })\r\n        this.vertical = html({\r\n            parent: this.highlights, styles: {\r\n                display: 'none',\r\n                position: 'absolute',\r\n                width: `${this.options.indicator}px`,\r\n                borderRadius: `${this.options.indicator}px`,\r\n                backgroundColor: this.options.color\r\n            }\r\n        })\r\n        this.horizontal\r\n        this.showing = []\r\n    }\r\n\r\n    stop()\r\n    {\r\n        this.highlights.remove()\r\n        this.stopped = true\r\n    }\r\n\r\n    addWindow(win)\r\n    {\r\n        win.on('move', () => this.move(win))\r\n        win.on('move-end', () => this.moveEnd(win))\r\n    }\r\n\r\n    screenMove(rect, horizontal, vertical)\r\n    {\r\n        const width = document.body.clientWidth\r\n        const height = document.body.clientHeight\r\n        if (rect.left - this.options.snap <= width && rect.right + this.options.snap >= 0)\r\n        {\r\n            if (Math.abs(rect.top - 0) <= this.options.snap)\r\n            {\r\n                horizontal.push({ distance: Math.abs(rect.top - 0), left: 0, width, top: 0, side: 'top', screen: true })\r\n            }\r\n            else if (Math.abs(rect.bottom - height) <= this.options.snap)\r\n            {\r\n                horizontal.push({ distance: Math.abs(rect.bottom - height), left: 0, width, top: height, side: 'bottom', screen: true })\r\n            }\r\n        }\r\n        if (rect.top - this.options.snap <= height && rect.bottom + this.options.snap >= 0)\r\n        {\r\n            if (Math.abs(rect.left - 0) <= this.options.snap)\r\n            {\r\n                vertical.push({ distance: Math.abs(rect.left - 0), top: 0, height, left: 0, side: 'left', screen: true })\r\n            }\r\n            else if (Math.abs(rect.right - width) <= this.options.snap)\r\n            {\r\n                vertical.push({ distance: Math.abs(rect.right - width), top: 0, height, left: width, side: 'right', screen: true })\r\n            }\r\n        }\r\n    }\r\n\r\n    windowsMove(original, rect, horizontal, vertical)\r\n    {\r\n        for (let win of this.wm.windows)\r\n        {\r\n            if (!win.options.noSnap && win !== original)\r\n            {\r\n                const rect2 = win.win.getBoundingClientRect()\r\n                if (rect.left - this.options.snap <= rect2.right && rect.right + this.options.snap >= rect2.left)\r\n                {\r\n                    if (Math.abs(rect.top - rect2.bottom) <= this.options.snap)\r\n                    {\r\n                        horizontal.push({ distance: Math.abs(rect.top - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'top' })\r\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\r\n                        }\r\n                    }\r\n                    else if (Math.abs(rect.bottom - rect2.top) <= this.options.snap)\r\n                    {\r\n                        horizontal.push({ distance: Math.abs(rect.bottom - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'bottom' })\r\n                        if (Math.abs(rect.left - rect2.left) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.right - rect2.right) <= this.options.snap)\r\n                        {\r\n                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })\r\n                        }\r\n                    }\r\n                }\r\n                if (rect.top - this.options.snap <= rect2.bottom && rect.bottom + this.options.snap >= rect2.top)\r\n                {\r\n                    if (Math.abs(rect.left - rect2.right) <= this.options.snap)\r\n                    {\r\n                        vertical.push({ distance: Math.abs(rect.left - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'left' })\r\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\r\n                        }\r\n                    }\r\n                    else if (Math.abs(rect.right - rect2.left) <= this.options.snap)\r\n                    {\r\n                        vertical.push({ distance: Math.abs(rect.right - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'right' })\r\n                        if (Math.abs(rect.top - rect2.top) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })\r\n                        }\r\n                        else if (Math.abs(rect.bottom - rect2.bottom) <= this.options.snap)\r\n                        {\r\n                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    move(win)\r\n    {\r\n        if (this.stopped || win.options.noSnap || win.isModal())\r\n        {\r\n            return\r\n        }\r\n        this.horizontal.style.display = 'none'\r\n        this.vertical.style.display = 'none'\r\n        const horizontal = []\r\n        const vertical = []\r\n        const rect = win.win.getBoundingClientRect()\r\n        if (this.options.screen)\r\n        {\r\n            this.screenMove(rect, horizontal, vertical)\r\n        }\r\n        if (this.options.windows)\r\n        {\r\n            this.windowsMove(win, rect, horizontal, vertical)\r\n        }\r\n        if (horizontal.length)\r\n        {\r\n            horizontal.sort((a, b) => { return a.distance - b.distance })\r\n            const find = horizontal[0]\r\n            this.horizontal.style.display = 'block'\r\n            this.horizontal.style.width = find.width + 'px'\r\n            this.horizontal.y = find.top - this.options.indicator / 2\r\n            this.horizontal.style.transform = `translate(${find.left}px,${this.horizontal.y}px)`\r\n            this.horizontal.side = find.side\r\n            this.horizontal.noSpacing = find.noSpacing\r\n            this.horizontal.screen = find.screen\r\n        }\r\n        if (vertical.length)\r\n        {\r\n            vertical.sort((a, b) => { return a.distance - b.distance })\r\n            const find = vertical[0]\r\n            this.vertical.style.display  = 'block'\r\n            this.vertical.style.height = find.height + 'px'\r\n            this.vertical.x = find.left - this.options.indicator / 2\r\n            this.vertical.style.transform = `translate(${this.vertical.x}px,${find.top}px)`\r\n            this.vertical.side = find.side\r\n            this.vertical.noSpacing = find.noSpacing\r\n            this.vertical.screen = find.screen\r\n        }\r\n    }\r\n\r\n    moveEnd(win)\r\n    {\r\n        if (this.stopped)\r\n        {\r\n            return\r\n        }\r\n        if (this.horizontal.style.display === 'block')\r\n        {\r\n            const spacing = this.horizontal.noSpacing ? 0 : this.options.spacing\r\n            const adjust = win.minimized ? (win.height - win.height * win.minimized.scaleY) / 2 : 0\r\n            switch (this.horizontal.side)\r\n            {\r\n                case 'top':\r\n                    win.y = this.horizontal.y - adjust + spacing + this.options.indicator / 2\r\n                    break\r\n\r\n                case 'bottom':\r\n                    win.bottom = Math.floor(this.horizontal.y + adjust - spacing + this.options.indicator / 2)\r\n                    break\r\n            }\r\n            win.attachToScreen('vertical', this.horizontal.screen ? this.horizontal.side : '')\r\n        }\r\n        if (this.vertical.style.display === 'block')\r\n        {\r\n            const spacing = this.vertical.noSpacing ? 0 : this.options.spacing\r\n            const adjust = win.minimized ? (win.width - win.width * win.minimized.scaleX) / 2 : 0\r\n            switch (this.vertical.side)\r\n            {\r\n                case 'left':\r\n                    win.x = this.vertical.x - adjust + spacing + this.options.indicator / 2\r\n                    break\r\n\r\n                case 'right':\r\n                    win.right = Math.floor(this.vertical.x + adjust - spacing + this.options.indicator / 2)\r\n                    break\r\n            }\r\n            win.attachToScreen('horziontal', this.vertical.screen ? this.vertical.side : '')\r\n        }\r\n        this.horizontal.style.display = this.vertical.style.display = 'none'\r\n    }\r\n}","import { html } from './html'\r\nimport { Window } from './Window'\r\nimport { windowOptions } from './windowOptions'\r\nimport { Snap } from './Snap'\r\nexport { Window } from './Window'\r\n\r\nconst windowManagerOptions = {\r\n    parent: document.body,\r\n    quiet: false,\r\n    keepInside: true,\r\n    snap: true\r\n}\r\n\r\n/**\r\n * Creates a windowing system to create and manage windows\r\n *\r\n * @extends EventEmitter\r\n * @example\r\n * var wm = new WindowManager();\r\n *\r\n * wm.createWindow({ x: 20, y: 20, width: 200 })\r\n * wm.content.innerHTML = 'Hello there!'\r\n */\r\nexport class WindowManager {\r\n    /**\r\n     * @param {object} [options]\r\n     * @param {HTMLElement} [options.parent=document.body]\r\n     * @param {boolean} [options.quiet] suppress the simple-window-manager console message\r\n     * @param {(boolean|SnapOptions)} [options.snap] turn on edge and/or screen snapping\r\n     * @param {(boolean|'horizontal'|'vertical')} [options.keepInside=true] keep windows inside the parent in a certain direction\r\n     * @param {WindowOptions} [defaultOptions] default WindowOptions used when createWindow is called\r\n     */\r\n    constructor(options = {}, defaultOptions = {}) {\r\n        this.windows = []\r\n        this.active = null\r\n        this.options = Object.assign({}, windowManagerOptions, options)\r\n        this.defaultOptions = Object.assign({}, windowOptions, defaultOptions)\r\n        if (!this.options.quiet) {\r\n            console.log('%c  simple-window-manager initialized ', 'color: #ff00ff')\r\n        }\r\n        this._createDom(options.parent || document.body)\r\n        if (this.options.snap) {\r\n            this.snap(this.options.snap === true ? {} : this.options.snap)\r\n        }\r\n        window.addEventListener('resize', () => this.resize())\r\n    }\r\n\r\n    /**\r\n     * Create a window\r\n     * @param {WindowOptions} [options]\r\n     * @param {string} [options.title]\r\n     * @param {number} [options.x] position\r\n     * @param {number} [options.y] position\r\n     * @param {boolean} [options.modal]\r\n     * @param {(number|*)} [options.id] if not provide, id will be assigned in order of creation (0, 1, 2...)\r\n     * @returns {Window} the created window\r\n     */\r\n    createWindow(options = {}) {\r\n        const win = new Window(this, Object.assign({}, this.defaultOptions, options))\r\n        win.on('open', () => this._open(win))\r\n        win.on('focus', () => this._focus(win))\r\n        win.on('blur', () => this._blur(win))\r\n        win.on('close', () => this._close(win))\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !options.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        win.resizePlacement(this.bounds, this.options.keepInside)\r\n        if (win.options.openOnCreate) {\r\n            win.open()\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * Attach an existing window to the WindowManager\r\n     * Note: WindowManager.createWindow is the preferred way to create windows to ensure that all the defaultOptions\r\n     * are applied to the Window. If you use this function, then Window needs to be initialized with WindowOptions.\r\n     * @param {Window} win\r\n     * @returns {Window} the window\r\n     */\r\n    attachWindow(win) {\r\n        win.on('open', this._open, this)\r\n        win.on('focus', this._focus, this)\r\n        win.on('blur', this._blur, this)\r\n        win.on('close', this._close, this)\r\n        this.win.appendChild(win.win)\r\n        win.wm = this\r\n        win.win.addEventListener('mousemove', (e) => this._move(e))\r\n        win.win.addEventListener('touchmove', (e) => this._move(e))\r\n        win.win.addEventListener('mouseup', (e) => this._up(e))\r\n        win.win.addEventListener('touchend', (e) => this._up(e))\r\n        if (this._snap && !this.defaultOptions.noSnap) {\r\n            this._snap.addWindow(win)\r\n        }\r\n        return win\r\n    }\r\n\r\n    /**\r\n     * enable edge and/or screen snapping\r\n     * @param {SnapOptions} options\r\n     */\r\n    snap(options) {\r\n        this._snap = new Snap(this, options)\r\n        for (let win of this.windows) {\r\n            if (!win.options.noSnap) {\r\n                this._snap.addWindow(win)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to front\r\n     * @param {Window} win\r\n     */\r\n    sendToFront(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * send window to back\r\n     * @param {Window} win\r\n     */\r\n    sendToBack(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'sendToFront should find window in this.windows')\r\n        if (index !== 0) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.unshift(win)\r\n            this._reorder()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * save the state of all the windows\r\n     * @returns {object} use this object in load() to restore the state of all windows\r\n     */\r\n    save() {\r\n        const data = {}\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            data[entry.id] = entry.save()\r\n            data[entry.id].order = i\r\n        }\r\n        return data\r\n    }\r\n\r\n    /**\r\n     * restores the state of all the windows\r\n     * NOTE: this requires that the windows have the same id as when save() was called\r\n     * @param {object} data created by save()\r\n     */\r\n    load(data) {\r\n        for (let i = 0; i < this.windows.length; i++) {\r\n            const entry = this.windows[i]\r\n            if (data[entry.id]) {\r\n                entry.load(data[entry.id])\r\n            }\r\n        }\r\n        // reorder windows\r\n    }\r\n\r\n    /**\r\n     * close all windows\r\n     */\r\n    closeAll() {\r\n        for (let win of this.windows) {\r\n            win.close()\r\n        }\r\n        this.windows = []\r\n        this.active = null\r\n    }\r\n\r\n    /**\r\n     * reorder windows\r\n     * @private\r\n     * @returns {number} available z-index for top window\r\n     */\r\n    _reorder() {\r\n        let i = 0\r\n        for (const win of this.windows) {\r\n            if (!win.isClosed()) {\r\n                win.z = i++\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {HTMLElement} parent\r\n     */\r\n    _createDom(parent) {\r\n        /**\r\n         * This is the top-level DOM element\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.win = html({\r\n            parent, styles: {\r\n                'user-select': 'none',\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'z-index': -1,\r\n                'cursor': 'default'\r\n            }\r\n        })\r\n\r\n        /**\r\n         * This is the bottom DOM element. Use this to set a wallpaper or attach elements underneath the windows\r\n         * @type {HTMLElement}\r\n         * @readonly\r\n         */\r\n        this.overlay = html({\r\n            parent: this.win, styles: {\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden'\r\n            }\r\n        })\r\n        this.overlay.addEventListener('mousemove', (e) => this._move(e))\r\n        this.overlay.addEventListener('touchmove', (e) => this._move(e))\r\n        this.overlay.addEventListener('mouseup', (e) => this._up(e))\r\n        this.overlay.addEventListener('touchend', (e) => this._up(e))\r\n\r\n        this.modalOverlay = html({\r\n            parent: this.win,\r\n            styles: {\r\n                'display': 'none',\r\n                'user-select': 'none',\r\n                'position': 'absolute',\r\n                'top': 0,\r\n                'left': 0,\r\n                'width': '100%',\r\n                'height': '100%',\r\n                'overflow': 'hidden',\r\n                'background': this.defaultOptions.backgroundModal\r\n            }\r\n        })\r\n        this.modalOverlay.addEventListener('mousemove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchmove', (e) => { this._move(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mouseup', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchend', (e) => { this._up(e); e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('mousedown', (e) => { e.preventDefault(); e.stopPropagation() })\r\n        this.modalOverlay.addEventListener('touchstart', (e) => { e.preventDefault(); e.stopPropagation() })\r\n    }\r\n\r\n    _open(win) {\r\n        this.windows.push(win)\r\n        this._reorder()\r\n        if (win.options.modal) {\r\n            this.modalOverlay.style.display = 'block'\r\n            this.modalOverlay.style.zIndex = win.z\r\n        }\r\n        else {\r\n            this.modalOverlay.style.display = 'none'\r\n        }\r\n    }\r\n\r\n    _focus(win) {\r\n        if (this.active === win) {\r\n            return\r\n        }\r\n        if (this.active) {\r\n            this.active.blur()\r\n        }\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._focus should find window in this.windows')\r\n        if (index !== this.windows.length - 1) {\r\n            this.windows.splice(index, 1)\r\n            this.windows.push(win)\r\n        }\r\n        this._reorder()\r\n        this.active = this.windows[this.windows.length - 1]\r\n    }\r\n\r\n    _blur(win) {\r\n        if (this.active === win) {\r\n            this.active = null\r\n        }\r\n    }\r\n\r\n    _close(win) {\r\n        const index = this.windows.indexOf(win)\r\n        console.assert(index !== -1, 'WindowManager._close should find window in this.windows')\r\n        this.windows.splice(index, 1)\r\n        const next = this.windows[this.windows.length - 1]\r\n        if (win.isModal(true)) {\r\n            if (next && next.isModal()) {\r\n                this.modalOverlay.style.zIndex = next.z\r\n            }\r\n            else {\r\n                this.modalOverlay.style.display = 'none'\r\n            }\r\n        }\r\n        next.focus()\r\n    }\r\n\r\n    _move(e) {\r\n        for (let i = this.windows.length - 1; i >= 0; i--) {\r\n            const win = this.windows[i];\r\n            const resizing = win._move(e);\r\n            if (resizing) {\r\n                const index = this.windows.indexOf(win);\r\n\r\n                this.windows.splice(index, 1);\r\n                this.windows.push(win);\r\n                break;\r\n            }\r\n            console.log(resizing);\r\n        }\r\n    }\r\n\r\n    _up(e) {\r\n        for (const key in this.windows) {\r\n            this.windows[key]._up(e)\r\n        }\r\n    }\r\n\r\n    checkModal(win) {\r\n        return !this.modal || this.modal === win\r\n    }\r\n\r\n    /** @type {Bounds} */\r\n    get bounds() {\r\n        return {\r\n            top: this.win.offsetTop,\r\n            bottom: this.win.offsetTop + this.win.offsetHeight,\r\n            left: this.win.offsetLeft,\r\n            right: this.win.offsetLeft + this.win.offsetWidth\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        const bounds = this.bounds\r\n        for (const key in this.windows) {\r\n            this.windows[key].resizePlacement(bounds, this.options.keepInside)\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @typedef {object} SnapOptions\r\n * @property {boolean} [screen=true] snap to screen edges\r\n * @property {boolean} [windows=true] snap to window edges\r\n * @property {number} [snap=20] distance to edge before snapping\r\n * @property {string} [color=#a8f0f4] color for snap bars\r\n * @property {number} [spacing=0] spacing distance between window and edges\r\n */\r\n\r\n/**\r\n * @typedef {object} Bounds\r\n * @property {number} left\r\n * @property {number} right\r\n * @property {number} top\r\n * @property {number} bottom\r\n */"],"names":["html","options","object","document","createElement","type","parent","appendChild","styles","Object","assign","style","className","innerHTML","childElements","Array","isArray","child","has","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","defaultOptions","threshold","clicked","doubleClicked","doubleClickedTime","longClicked","longClickedTime","capture","clickDown","element","callback","Clicked","[object Object]","querySelector","mousedown","e","mouseup","mousemove","touchstart","touchmove","touchcancel","cancel","touchend","addEventListener","passive","console","warn","removeEventListener","down","touches","handleDown","changedTouches","screenX","screenY","x","y","Math","abs","lastX","lastY","pastThreshold","doubleClickedTimeout","clearTimeout","longClickedTimeout","preventDefault","handleClicks","pointerId","setTimeout","doubleClickedCancel","longClikedTimeout","ResizeDirections","RESIZE_PREFIX","Window","wm","super","id","_createWindow","_listeners","active","maximized","_closed","_restore","_moving","_prevPosition","_resizing","_attachedToScreen","vertical","horziontal","verticalResize","horizontalResize","noFocus","win","display","focus","titlebar","winTitlebar","backgroundColor","backgroundTitlebarActive","backgroundTitlebarInactive","closed","value","_buildTransform","transform","width","offsetWidth","height","offsetHeight","keepInside","bounds","right","left","bottom","top","maximizable","buttons","maximize","maximizeButton","overlay","restoreButton","sendToBack","sendToFront","data","close","open","title","_title","winTitle","innerText","move","window","innerWidth","innerHeight","winStyles","user-select","overflow","position","min-width","minWidth","min-height","minHeight","isNaN","classNames","winBox","flex-direction","background-color","_createTitlebar","content","overflow-x","overflow-y","resizable","_createResize","_downTitlebar","stopPropagation","_convertMoveEvent","pageX","pageY","_moved","headerStyles","titlebarHeight","frameManager","headerTitle","headerToolbar","toolbarInstruments","_createButtons","movable","winButtonGroup","minimizable","minimize","minimizeButton","closable","closeButton","key","button","opacity","prevResizingState","offset","up","horizontal","_offset","resizingState","_getHitTestState","_isTouchEvent","which","replace","trim","newClass","filter","Boolean","join","includes","dx","dy","yMutiplier","xMutiplier","_stopMove","_stopResize","resize","TouchEvent","direction","location","ignoreClosed","modal","z","parseInt","zIndex","windowOptions","openOnCreate","borderRadius","shadow","backgroundResize","SnapOptionsDefault","screen","windows","snap","color","spacing","indicator","Snap","highlights","showing","remove","stopped","moveEnd","rect","body","clientWidth","clientHeight","distance","side","original","noSnap","rect2","getBoundingClientRect","noSpacing","isModal","screenMove","windowsMove","sort","a","b","find","adjust","minimized","scaleY","floor","attachToScreen","scaleX","windowManagerOptions","quiet","log","_createDom","_open","_focus","_blur","_close","_move","_up","_snap","addWindow","resizePlacement","index","indexOf","assert","splice","_reorder","unshift","entry","save","order","load","isClosed","z-index","cursor","modalOverlay","background","backgroundModal","blur","next","resizing","offsetTop","offsetLeft"],"mappings":"qPAWO,SAASA,EAAKC,EAAU,IAC3B,MAAMC,EAASC,SAASC,cAAcH,EAAQI,MAAQ,OAatD,GAZIJ,EAAQK,QACRL,EAAQK,OAAOC,YAAYL,GAE3BD,EAAQO,QACRC,OAAOC,OAAOR,EAAOS,MAAOV,EAAQO,QAEpCP,EAAQW,YACRV,EAAOU,UAAYX,EAAQW,WAE3BX,EAAQD,OACRE,EAAOW,UAAYZ,EAAQD,MAE3BC,EAAQa,cAAe,CAClBC,MAAMC,QAAQf,EAAQa,iBACvBb,EAAQa,cAAgB,CAACb,EAAQa,gBAErC,IAAK,MAAMG,KAAShB,EAAQa,cACpBG,GAAOf,EAAOK,YAAYU,GAEtC,OAAOf,gPC9BX,IAAIgB,EAAMT,OAAOU,UAAUC,eACvBC,EAAS,IASb,SAASC,KA4BT,SAASC,EAAGC,EAAIC,EAASC,GACvBC,KAAKH,GAAKA,EACVG,KAAKF,QAAUA,EACfE,KAAKD,KAAOA,IAAQ,EActB,SAASE,EAAYC,EAASC,EAAON,EAAIC,EAASC,GAChD,GAAkB,mBAAPF,EACT,MAAM,IAAIO,UAAU,mCAGtB,IAAIC,EAAW,IAAIT,EAAGC,EAAIC,GAAWI,EAASH,GAC1CO,EAAMZ,EAASA,EAASS,EAAQA,EAMpC,OAJKD,EAAQK,QAAQD,GACXJ,EAAQK,QAAQD,GAAKT,GAC1BK,EAAQK,QAAQD,GAAO,CAACJ,EAAQK,QAAQD,GAAMD,GADhBH,EAAQK,QAAQD,GAAKE,KAAKH,IADlCH,EAAQK,QAAQD,GAAOD,EAAUH,EAAQO,gBAI7DP,EAUT,SAASQ,EAAWR,EAASI,GACI,KAAzBJ,EAAQO,aAAoBP,EAAQK,QAAU,IAAIZ,SAC5CO,EAAQK,QAAQD,GAU9B,SAASK,IACPX,KAAKO,QAAU,IAAIZ,EACnBK,KAAKS,aAAe,EAxElB3B,OAAO8B,SACTjB,EAAOH,UAAYV,OAAO8B,OAAO,OAM5B,IAAIjB,GAASkB,YAAWnB,GAAS,IA2ExCiB,EAAanB,UAAUsB,WAAa,WAClC,IACIC,EACAC,EAFAC,EAAQ,GAIZ,GAA0B,IAAtBjB,KAAKS,aAAoB,OAAOQ,EAEpC,IAAKD,KAASD,EAASf,KAAKO,QACtBhB,EAAI2B,KAAKH,EAAQC,IAAOC,EAAMT,KAAKd,EAASsB,EAAKG,MAAM,GAAKH,GAGlE,OAAIlC,OAAOsC,sBACFH,EAAMI,OAAOvC,OAAOsC,sBAAsBL,IAG5CE,GAUTN,EAAanB,UAAU8B,UAAY,SAAmBnB,GACpD,IAAIG,EAAMZ,EAASA,EAASS,EAAQA,EAChCoB,EAAWvB,KAAKO,QAAQD,GAE5B,IAAKiB,EAAU,MAAO,GACtB,GAAIA,EAAS1B,GAAI,MAAO,CAAC0B,EAAS1B,IAElC,IAAK,IAAI2B,EAAI,EAAGC,EAAIF,EAASG,OAAQC,EAAK,IAAIvC,MAAMqC,GAAID,EAAIC,EAAGD,IAC7DG,EAAGH,GAAKD,EAASC,GAAG3B,GAGtB,OAAO8B,GAUThB,EAAanB,UAAUoC,cAAgB,SAAuBzB,GAC5D,IAAIG,EAAMZ,EAASA,EAASS,EAAQA,EAChCmB,EAAYtB,KAAKO,QAAQD,GAE7B,OAAKgB,EACDA,EAAUzB,GAAW,EAClByB,EAAUI,OAFM,GAYzBf,EAAanB,UAAUqC,KAAO,SAAc1B,EAAO2B,EAAIC,EAAIC,EAAIC,EAAIC,GACjE,IAAI5B,EAAMZ,EAASA,EAASS,EAAQA,EAEpC,IAAKH,KAAKO,QAAQD,GAAM,OAAO,EAE/B,IAEI6B,EACAX,EAHAF,EAAYtB,KAAKO,QAAQD,GACzB8B,EAAMC,UAAUX,OAIpB,GAAIJ,EAAUzB,GAAI,CAGhB,OAFIyB,EAAUvB,MAAMC,KAAKsC,eAAenC,EAAOmB,EAAUzB,QAAI0C,GAAW,GAEhEH,GACN,KAAK,EAAG,OAAOd,EAAUzB,GAAGqB,KAAKI,EAAUxB,UAAU,EACrD,KAAK,EAAG,OAAOwB,EAAUzB,GAAGqB,KAAKI,EAAUxB,QAASgC,IAAK,EACzD,KAAK,EAAG,OAAOR,EAAUzB,GAAGqB,KAAKI,EAAUxB,QAASgC,EAAIC,IAAK,EAC7D,KAAK,EAAG,OAAOT,EAAUzB,GAAGqB,KAAKI,EAAUxB,QAASgC,EAAIC,EAAIC,IAAK,EACjE,KAAK,EAAG,OAAOV,EAAUzB,GAAGqB,KAAKI,EAAUxB,QAASgC,EAAIC,EAAIC,EAAIC,IAAK,EACrE,KAAK,EAAG,OAAOX,EAAUzB,GAAGqB,KAAKI,EAAUxB,QAASgC,EAAIC,EAAIC,EAAIC,EAAIC,IAAK,EAG3E,IAAKV,EAAI,EAAGW,EAAO,IAAI/C,MAAMgD,EAAK,GAAIZ,EAAIY,EAAKZ,IAC7CW,EAAKX,EAAI,GAAKa,UAAUb,GAG1BF,EAAUzB,GAAG2C,MAAMlB,EAAUxB,QAASqC,OACjC,CACL,IACIM,EADAf,EAASJ,EAAUI,OAGvB,IAAKF,EAAI,EAAGA,EAAIE,EAAQF,IAGtB,OAFIF,EAAUE,GAAGzB,MAAMC,KAAKsC,eAAenC,EAAOmB,EAAUE,GAAG3B,QAAI0C,GAAW,GAEtEH,GACN,KAAK,EAAGd,EAAUE,GAAG3B,GAAGqB,KAAKI,EAAUE,GAAG1B,SAAU,MACpD,KAAK,EAAGwB,EAAUE,GAAG3B,GAAGqB,KAAKI,EAAUE,GAAG1B,QAASgC,GAAK,MACxD,KAAK,EAAGR,EAAUE,GAAG3B,GAAGqB,KAAKI,EAAUE,GAAG1B,QAASgC,EAAIC,GAAK,MAC5D,KAAK,EAAGT,EAAUE,GAAG3B,GAAGqB,KAAKI,EAAUE,GAAG1B,QAASgC,EAAIC,EAAIC,GAAK,MAChE,QACE,IAAKG,EAAM,IAAKM,EAAI,EAAGN,EAAO,IAAI/C,MAAMgD,EAAK,GAAIK,EAAIL,EAAKK,IACxDN,EAAKM,EAAI,GAAKJ,UAAUI,GAG1BnB,EAAUE,GAAG3B,GAAG2C,MAAMlB,EAAUE,GAAG1B,QAASqC,IAKpD,OAAO,GAYTxB,EAAanB,UAAUkD,GAAK,SAAYvC,EAAON,EAAIC,GACjD,OAAOG,EAAYD,KAAMG,EAAON,EAAIC,GAAS,IAY/Ca,EAAanB,UAAUO,KAAO,SAAcI,EAAON,EAAIC,GACrD,OAAOG,EAAYD,KAAMG,EAAON,EAAIC,GAAS,IAa/Ca,EAAanB,UAAU8C,eAAiB,SAAwBnC,EAAON,EAAIC,EAASC,GAClF,IAAIO,EAAMZ,EAASA,EAASS,EAAQA,EAEpC,IAAKH,KAAKO,QAAQD,GAAM,OAAON,KAC/B,IAAKH,EAEH,OADAa,EAAWV,KAAMM,GACVN,KAGT,IAAIsB,EAAYtB,KAAKO,QAAQD,GAE7B,GAAIgB,EAAUzB,GAEVyB,EAAUzB,KAAOA,GACfE,IAAQuB,EAAUvB,MAClBD,GAAWwB,EAAUxB,UAAYA,GAEnCY,EAAWV,KAAMM,OAEd,CACL,IAAK,IAAIkB,EAAI,EAAGT,EAAS,GAAIW,EAASJ,EAAUI,OAAQF,EAAIE,EAAQF,KAEhEF,EAAUE,GAAG3B,KAAOA,GACnBE,IAASuB,EAAUE,GAAGzB,MACtBD,GAAWwB,EAAUE,GAAG1B,UAAYA,IAErCiB,EAAOP,KAAKc,EAAUE,IAOtBT,EAAOW,OAAQ1B,KAAKO,QAAQD,GAAyB,IAAlBS,EAAOW,OAAeX,EAAO,GAAKA,EACpEL,EAAWV,KAAMM,GAGxB,OAAON,MAUTW,EAAanB,UAAUmD,mBAAqB,SAA4BxC,GACtE,IAAIG,EAUJ,OARIH,GACFG,EAAMZ,EAASA,EAASS,EAAQA,EAC5BH,KAAKO,QAAQD,IAAMI,EAAWV,KAAMM,KAExCN,KAAKO,QAAU,IAAIZ,EACnBK,KAAKS,aAAe,GAGfT,MAMTW,EAAanB,UAAUoD,IAAMjC,EAAanB,UAAU8C,eACpD3B,EAAanB,UAAUS,YAAcU,EAAanB,UAAUkD,GAK5D/B,EAAakC,SAAWnD,EAKxBiB,EAAaA,aAAeA,EAM1BmC,UAAiBnC,KCxSnB,MAAMoC,EAAiB,CACnBC,UAAW,GACXC,SAAS,EACTC,eAAe,EACfC,kBAAmB,IACnBC,aAAa,EACbC,gBAAiB,IACjBC,SAAS,EACTC,WAAW,GAiBR,SAASN,EAAQO,EAASC,EAAUnF,GAEvC,OAAO,IAAIoF,EAAQF,EAASC,EAAUnF,GAG1C,MAAMoF,EAEFC,YAAYH,EAASC,EAAUnF,GAEJ,iBAAZkF,IAEPA,EAAUhF,SAASoF,cAAcJ,KAOrCxD,KAAK1B,QAAUQ,OAAOC,OAAO,GAAIgE,EAAgBzE,GACjD0B,KAAKe,OAAS,CACV8C,UAAYC,GAAM9D,KAAK6D,UAAUC,GACjCC,QAAUD,GAAM9D,KAAK+D,QAAQD,GAC7BE,UAAYF,GAAM9D,KAAKgE,UAAUF,GACjCG,WAAaH,GAAM9D,KAAKiE,WAAWH,GACnCI,UAAYJ,GAAM9D,KAAKkE,UAAUJ,GACjCK,YAAcL,GAAM9D,KAAKoE,OAAON,GAChCO,SAAWP,GAAM9D,KAAKqE,SAASP,IAEnCN,EAAQc,iBAAiB,YAAatE,KAAKe,OAAO8C,UAAW,CAAEP,QAAStD,KAAK1B,QAAQgF,UACrFE,EAAQc,iBAAiB,UAAWtE,KAAKe,OAAOgD,QAAS,CAAET,QAAStD,KAAK1B,QAAQgF,UACjFE,EAAQc,iBAAiB,YAAatE,KAAKe,OAAOiD,UAAW,CAAEV,QAAStD,KAAK1B,QAAQgF,UACrFE,EAAQc,iBAAiB,aAActE,KAAKe,OAAOkD,WAAY,CAAEM,SAAS,EAAMjB,QAAStD,KAAK1B,QAAQgF,UACtGE,EAAQc,iBAAiB,YAAatE,KAAKe,OAAOmD,UAAW,CAAEK,SAAS,EAAMjB,QAAStD,KAAK1B,QAAQgF,UACpGE,EAAQc,iBAAiB,cAAetE,KAAKe,OAAOoD,YAAa,CAAEb,QAAStD,KAAK1B,QAAQgF,UACzFE,EAAQc,iBAAiB,WAAYtE,KAAKe,OAAOsD,SAAU,CAAEf,QAAStD,KAAK1B,QAAQgF,UACnFtD,KAAKwD,QAAUA,EACfxD,KAAKyD,SAAWA,GAtBRe,QAAQC,KAAK,2CAA2CjB,mBA4BpEG,UAEI3D,KAAKwD,QAAQkB,oBAAoB,YAAa1E,KAAKe,OAAO8C,WAC1D7D,KAAKwD,QAAQkB,oBAAoB,UAAW1E,KAAKe,OAAOgD,SACxD/D,KAAKwD,QAAQkB,oBAAoB,YAAa1E,KAAKe,OAAOiD,WAC1DhE,KAAKwD,QAAQkB,oBAAoB,aAAc1E,KAAKe,OAAOkD,WAAY,CAAEM,SAAS,IAClFvE,KAAKwD,QAAQkB,oBAAoB,YAAa1E,KAAKe,OAAOmD,UAAW,CAAEK,SAAS,IAChFvE,KAAKwD,QAAQkB,oBAAoB,cAAe1E,KAAKe,OAAOoD,aAC5DnE,KAAKwD,QAAQkB,oBAAoB,WAAY1E,KAAKe,OAAOsD,UAG7DV,WAAWG,IAEW,IAAd9D,KAAK2E,KAEL3E,KAAKoE,SAIoB,IAArBN,EAAEc,QAAQlD,QAEV1B,KAAK6E,WAAWf,EAAEgB,eAAe,GAAGC,QAASjB,EAAEgB,eAAe,GAAGE,SAK7ErB,cAAcsB,EAAGC,GAEb,OAAOC,KAAKC,IAAIpF,KAAKqF,MAAQJ,GAAKjF,KAAK1B,QAAQ0E,WAAamC,KAAKC,IAAIpF,KAAKsF,MAAQJ,GAAKlF,KAAK1B,QAAQ0E,UAGxGW,UAAUG,GAEN,GAAI9D,KAAK2E,KAEL,GAAyB,IAArBb,EAAEc,QAAQlD,OAEV1B,KAAKoE,aAGT,CACI,MAAMa,EAAInB,EAAEgB,eAAe,GAAGC,QACxBG,EAAIpB,EAAEgB,eAAe,GAAGE,QAC1BhF,KAAKuF,cAAcN,EAAGC,IAEtBlF,KAAKoE,UAOrBT,SAEI3D,KAAK2E,MAAO,EACR3E,KAAKwF,uBAELC,aAAazF,KAAKwF,sBAClBxF,KAAKwF,qBAAuB,MAE5BxF,KAAK0F,qBAELD,aAAazF,KAAK0F,oBAClB1F,KAAK0F,mBAAqB,MAIlC/B,SAASG,GAED9D,KAAK2E,OAELb,EAAE6B,iBACF3F,KAAK4F,aAAa9B,EAAGA,EAAE+B,YAI/BlC,aAAaG,GAEL9D,KAAK1B,QAAQ4E,cAEblD,KAAKwF,qBAAuBM,WAAW,IAAM9F,KAAK+F,oBAAoBjC,GAAI9D,KAAK1B,QAAQ6E,mBAElFnD,KAAK1B,QAAQ2E,SAElBjD,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,YAEhCsB,KAAK0F,qBAELD,aAAazF,KAAK0F,oBAClB1F,KAAK0F,mBAAqB,MAE9B1F,KAAK2E,MAAO,EAGhBhB,WAAWG,EAAGmB,EAAGC,GAETlF,KAAKwF,qBAEDxF,KAAKuF,cAAcN,EAAGC,IAElBlF,KAAK1B,QAAQ2E,SAEbjD,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,YAEpCsB,KAAKoE,WAILpE,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,mBAChCsB,KAAKoE,WAKTpE,KAAKqF,MAAQJ,EACbjF,KAAKsF,MAAQJ,EACblF,KAAK2E,MAAO,EACR3E,KAAK1B,QAAQ8E,cAEbpD,KAAK0F,mBAAqBI,WAAW,IAAM9F,KAAKoD,YAAYU,GAAI9D,KAAK1B,QAAQ+E,kBAE7ErD,KAAK1B,QAAQiF,WACbvD,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,gBAK5CiF,YAAYG,GAER9D,KAAKgG,kBAAoB,KACzBhG,KAAK2E,MAAO,EACZ3E,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,iBAGpCiF,oBAAoBG,GAEhB9D,KAAKwF,qBAAuB,KACxBxF,KAAK1B,QAAQ2E,SAEbjD,KAAKyD,SAAS,CAAEtD,MAAO2D,EAAGpF,KAAM,mBAIxCiF,UAAUG,IAEY,IAAd9D,KAAK2E,KAEL3E,KAAK2E,MAAO,EAIZ3E,KAAK6E,WAAWf,EAAGA,EAAEiB,QAASjB,EAAEkB,SAIxCrB,UAAUG,GAEN,GAAI9D,KAAK2E,KACT,CACI,MAAMM,EAAInB,EAAEiB,QACNG,EAAIpB,EAAEkB,QACRhF,KAAKuF,cAAcN,EAAGC,IAEtBlF,KAAKoE,UAKjBT,QAAQG,GAEA9D,KAAK2E,OAELb,EAAE6B,iBACF3F,KAAK4F,aAAa9B,KChR9B,MAAMmC,EACE,KADFA,EAEI,OAFJA,EAGI,OAHJA,EAIK,QAGLC,EAAgB,SAsBf,MAAMC,UAAexG,EAKxBgE,YAAYyC,EAAI9H,EAAU,IACtB+H,QACArG,KAAKoG,GAAKA,EACVpG,KAAK1B,QAAUA,EACf0B,KAAKsG,QAAgC,IAApBtG,KAAK1B,QAAQgI,GAAqBH,EAAOG,KAAOtG,KAAK1B,QAAQgI,GAC9EtG,KAAKuG,gBACLvG,KAAKwG,aAELxG,KAAKyG,QAAS,EACdzG,KAAK0G,WAAY,EAEjB1G,KAAK2G,SAAU,EACf3G,KAAK4G,SAAW,KAChB5G,KAAK6G,QAAU,KACf7G,KAAK8G,cAAgB,KACrB9G,KAAK+G,UAAY,KACjB/G,KAAKgH,kBAAoB,CAAEC,SAAU,GAAIC,WAAY,IACrDlH,KAAKmH,gBAAiB,EACtBnH,KAAKoH,kBAAmB,EAO5BzD,KAAK0D,GACGrH,KAAK2G,UACL3G,KAAKsH,IAAItI,MAAMuI,QAAU,QACzBvH,KAAK2G,SAAU,EACf3G,KAAK6B,KAAK,OAAQ7B,MACbqH,GACDrH,KAAKwH,SAQjB7D,QACI3D,KAAKyG,QAAS,EACVzG,KAAK1B,QAAQmJ,WACbzH,KAAK0H,YAAY1I,MAAM2I,gBAAkB3H,KAAK1B,QAAQsJ,0BAE1D5H,KAAK6B,KAAK,QAAS7B,MAMvB2D,OACI3D,KAAKyG,QAAS,EACVzG,KAAK1B,QAAQmJ,WACbzH,KAAK0H,YAAY1I,MAAM2I,gBAAkB3H,KAAK1B,QAAQuJ,4BAE1D7H,KAAK6B,KAAK,OAAQ7B,MAMtB2D,QACS3D,KAAK2G,UACN3G,KAAK2G,SAAU,EACf3G,KAAKsH,IAAItI,MAAMuI,QAAU,OACzBvH,KAAK6B,KAAK,QAAS7B,OAS3B8H,aACI,OAAO9H,KAAK2G,QAOhB1B,QAAU,OAAOjF,KAAK1B,QAAQ2G,EAC9BA,MAAM8C,GACEA,IAAU/H,KAAK1B,QAAQ2G,IACvBjF,KAAK1B,QAAQ2G,EAAI8C,EACjB/H,KAAK6B,KAAK,SAAU7B,MACpBA,KAAKgI,mBAIbrE,kBACI3D,KAAKsH,IAAItI,MAAMiJ,UAAY,aAAajI,KAAK1B,QAAQ2G,OAAOjF,KAAK1B,QAAQ4G,OAO7EA,QAAU,OAAOlF,KAAK1B,QAAQ4G,EAC9BA,MAAM6C,GACEA,IAAU/H,KAAK1B,QAAQ4G,IACvBlF,KAAK1B,QAAQ4G,EAAI6C,EACjB/H,KAAKgI,kBACLhI,KAAK6B,KAAK,SAAU7B,OAQ5BkI,YAAc,OAAOlI,KAAK1B,QAAQ4J,OAASlI,KAAKsH,IAAIa,YACpDD,UAAUH,GACFA,IAAU/H,KAAK1B,QAAQ4J,QACnBH,GACA/H,KAAKsH,IAAItI,MAAMkJ,MAAWH,EAAH,KACvB/H,KAAK1B,QAAQ4J,MAAQlI,KAAKsH,IAAIa,cAG9BnI,KAAKsH,IAAItI,MAAMkJ,MAAQ,OACvBlI,KAAK1B,QAAQ4J,MAAQ,IAEzBlI,KAAK6B,KAAK,eAAgB7B,OAQlCoI,aAAe,OAAOpI,KAAK1B,QAAQ8J,QAAUpI,KAAKsH,IAAIe,aACtDD,WAAWL,GACHA,IAAU/H,KAAK1B,QAAQ8J,SACnBL,GACA/H,KAAKsH,IAAItI,MAAMoJ,OAAYL,EAAH,KACxB/H,KAAK1B,QAAQ8J,OAASpI,KAAKsH,IAAIe,eAG/BrI,KAAKsH,IAAItI,MAAMoJ,OAAS,OACxBpI,KAAK1B,QAAQ8J,OAAS,IAE1BpI,KAAK6B,KAAK,gBAAiB7B,OASnC2D,OAAOuE,EAAOE,GACVpI,KAAKkI,MAAQA,EACblI,KAAKoI,OAASA,EAQlBzE,KAAKsB,EAAGC,GACJ,MAAMoD,EAAatI,KAAKsI,WACxB,GAAIA,EAAY,CACZ,MAAMC,EAASvI,KAAKuI,QACD,IAAfD,GAAsC,eAAfA,IAEvBrD,GADAA,EAAIA,EAAIjF,KAAKkI,MAAQK,EAAOC,MAAQD,EAAOC,MAAQxI,KAAKkI,MAAQjD,GACxDsD,EAAOE,KAAOF,EAAOE,KAAOxD,IAErB,IAAfqD,GAAsC,aAAfA,IAEvBpD,GADAA,EAAIA,EAAIlF,KAAKoI,OAASG,EAAOG,OAASH,EAAOG,OAAS1I,KAAKoI,OAASlD,GAC5DqD,EAAOI,IAAMJ,EAAOI,IAAMzD,GAGtCD,IAAMjF,KAAK1B,QAAQ2G,IACnBjF,KAAK1B,QAAQ2G,EAAIA,EACjBjF,KAAK6B,KAAK,SAAU7B,OAEpBkF,IAAMlF,KAAK1B,QAAQ4G,IACnBlF,KAAK1B,QAAQ4G,EAAIA,EACjBlF,KAAK6B,KAAK,SAAU7B,OAExBA,KAAKgI,kBAMTrE,WACI,GAAI3D,KAAK1B,QAAQsK,YACb,GAAI5I,KAAK0G,UACL1G,KAAKiF,EAAIjF,KAAK0G,UAAUzB,EACxBjF,KAAKkF,EAAIlF,KAAK0G,UAAUxB,EACxBlF,KAAKkI,MAAQlI,KAAK0G,UAAUwB,MAC5BlI,KAAKoI,OAASpI,KAAK0G,UAAU0B,OAC7BpI,KAAK0G,UAAY,KACjB1G,KAAK6B,KAAK,UAAW7B,MACrBA,KAAK6I,QAAQC,SAAS7J,UAAY,uBAClCe,KAAK6I,QAAQC,SAAS5J,UAAYc,KAAK1B,QAAQyK,mBAE9C,CACD,MAAM9D,EAAIjF,KAAKiF,EAAGC,EAAIlF,KAAKkF,EAAGgD,EAAQlI,KAAKsH,IAAIa,YAAaC,EAASpI,KAAKsH,IAAIe,aAC9ErI,KAAK0G,UAAY,CAAEzB,EAAAA,EAAGC,EAAAA,EAAGgD,MAAAA,EAAOE,OAAAA,GAChCpI,KAAKiF,EAAI,EACTjF,KAAKkF,EAAI,EACTlF,KAAKkI,MAAQlI,KAAKoG,GAAG4C,QAAQb,YAC7BnI,KAAKoI,OAASpI,KAAKoG,GAAG4C,QAAQX,aAC9BrI,KAAK6B,KAAK,WAAY7B,MACtBA,KAAK6I,QAAQC,SAAS7J,UAAY,0BAClCe,KAAK6I,QAAQC,SAAS5J,UAAYc,KAAK1B,QAAQ2K,eAQ3DtF,aACI3D,KAAKoG,GAAG8C,WAAWlJ,MAMvB2D,cACI3D,KAAKoG,GAAG+C,YAAYnJ,MAOxB2D,OACI,MAAMyF,EAAO,GACP1C,EAAY1G,KAAK0G,UAavB,OAZIA,IACA0C,EAAK1C,UAAY,CAAE+B,KAAM/B,EAAU+B,KAAME,IAAKjC,EAAUiC,IAAKT,MAAOxB,EAAUwB,MAAOE,OAAQ1B,EAAU0B,SAE3GgB,EAAKnE,EAAIjF,KAAKiF,EACdmE,EAAKlE,EAAIlF,KAAKkF,OACoB,IAAvBlF,KAAK1B,QAAQ4J,QACpBkB,EAAKlB,MAAQlI,KAAK1B,QAAQ4J,YAEK,IAAxBlI,KAAK1B,QAAQ8J,SACpBgB,EAAKhB,OAASpI,KAAK1B,QAAQ8J,QAE/BgB,EAAKtB,OAAS9H,KAAK2G,QACZyC,EAOXzF,KAAKyF,GACGA,EAAK1C,UACA1G,KAAK0G,WACN1G,KAAK8I,UAAS,GAGb9I,KAAK0G,WACV1G,KAAK8I,UAAS,GAElB9I,KAAKiF,EAAImE,EAAKnE,EACdjF,KAAKkF,EAAIkE,EAAKlE,OACY,IAAfkE,EAAKlB,MACZlI,KAAKkI,MAAQkB,EAAKlB,MAGlBlI,KAAKsH,IAAItI,MAAMkJ,MAAQ,YAEA,IAAhBkB,EAAKhB,OACZpI,KAAKoI,OAASgB,EAAKhB,OAGnBpI,KAAKsH,IAAItI,MAAMoJ,OAAS,OAExBgB,EAAKtB,OACL9H,KAAKqJ,OAAM,GAENrJ,KAAK8H,QACV9H,KAAKsJ,MAAK,GAAM,GAQxBC,YAAc,OAAOvJ,KAAKwJ,OAC1BD,UAAUxB,GACN/H,KAAKyJ,SAASC,UAAY3B,EAC1B/H,KAAK6B,KAAK,eAAgB7B,MAQ9BwI,YAAc,OAAOxI,KAAKiF,EAAIjF,KAAKkI,MACnCM,UAAUT,GACN/H,KAAKiF,EAAI8C,EAAQ/H,KAAKkI,MAO1BQ,aAAe,OAAO1I,KAAKkF,EAAIlF,KAAKoI,OACpCM,WAAWX,GACP/H,KAAKkF,EAAI6C,EAAQ/H,KAAKoI,OAO1BzE,OAAO2D,GACCA,EACAtH,KAAK2J,KACDrC,EAAIrC,EAAIqC,EAAIY,MAAQ,EAAIlI,KAAKkI,MAAQ,EACrCZ,EAAIpC,EAAIoC,EAAIc,OAAS,EAAIpI,KAAKoI,OAAS,GAI3CpI,KAAK2J,KACDC,OAAOC,WAAa,EAAI7J,KAAKkI,MAAQ,EACrC0B,OAAOE,YAAc,EAAI9J,KAAKoI,OAAS,GAoGnDzE,gBAMI,MAAMoG,EAAY,CACdC,cAAe,OACfC,SAAY,SACZC,SAAY,WACZC,YAAanK,KAAK1B,QAAQ8L,SAC1BC,aAAcrK,KAAK1B,QAAQgM,UAC3BpC,MAASqC,MAAMvK,KAAK1B,QAAQ4J,OAASlI,KAAK1B,QAAQ4J,MAAQlI,KAAK1B,QAAQ4J,MAAQ,KAC/EE,OAAUmC,MAAMvK,KAAK1B,QAAQ8J,QAAUpI,KAAK1B,QAAQ8J,OAASpI,KAAK1B,QAAQ8J,OAAS,QAChFpI,KAAK1B,QAAQO,QAGpBmB,KAAKsH,IAAMjJ,EAAK,CACZM,OAASqB,KAAKoG,GAAKpG,KAAKoG,GAAGkB,IAAM,KACjCzI,OAAQkL,EACR9K,UAAWe,KAAK1B,QAAQkM,WAAWlD,IAC7BtH,KAAK1B,QAAQkM,WAAWlD,IAAM,SAC9B,UAGVtH,KAAKyK,OAASpM,EAAK,CACfM,OAAQqB,KAAKsH,IAAKzI,OAAQ,CACtB0I,QAAW,OACXmD,iBAAkB,SAClBxC,MAAS,OACTE,OAAU,OACViC,aAAcrK,KAAK1B,QAAQgM,UAC3BK,mBAAoB3K,KAAK1B,QAAQU,OAErCC,UAAWe,KAAK1B,QAAQkM,WAAWC,OAC7BzK,KAAK1B,QAAQkM,WAAWC,OAAU,aAClC,cAEVzK,KAAK4K,kBAOL5K,KAAK6K,QAAUxM,EAAK,CAChBM,OAAQqB,KAAKyK,OAAQ/L,KAAM,UAAWG,OAAQ,CAC1CwL,aAAcrK,KAAKsK,UACnBQ,aAAc,SACdC,aAAc,QAElB9L,UAAWe,KAAK1B,QAAQkM,WAAWK,UAGnC7K,KAAK1B,QAAQ0M,WACbhL,KAAKiL,gBAGTjL,KAAKgJ,QAAU3K,EAAK,CAChBM,OAAQqB,KAAKsH,IAAKzI,OAAQ,CACtB0I,QAAW,OACX2C,SAAY,WACZzB,KAAQ,EACRE,IAAO,EACPT,MAAS,OACTE,OAAU,QAEdnJ,UAAWe,KAAK1B,QAAQkM,WAAWxB,UAEvChJ,KAAKgJ,QAAQ1E,iBAAiB,YAAcR,IAAQ9D,KAAKkL,cAAcpH,GAAIA,EAAEqH,oBAC7EnL,KAAKgJ,QAAQ1E,iBAAiB,aAAeR,IAAQ9D,KAAKkL,cAAcpH,GAAIA,EAAEqH,oBAC9EnL,KAAKgI,kBAGTrE,cAAcG,GACV,MAAM3D,EAAQH,KAAKoL,kBAAkBtH,GACrC9D,KAAK6G,QAAU,CACX5B,EAAG9E,EAAMkL,MACTnG,EAAG/E,EAAMmL,OAEbtL,KAAK6B,KAAK,aAAc7B,MACxBA,KAAKuL,QAAS,EAGlB5H,kBACI,MAAM6H,EAAe,CACjBxB,cAAe,OACfzC,QAAW,OACXmD,iBAAkB,MAClBT,SAAY,SACZ7B,OAAUpI,KAAK1B,QAAQmN,eACvBpB,aAAcrK,KAAK1B,QAAQmN,gBAG3BzL,KAAK1B,QAAQmJ,WACbzH,KAAK0H,YAAcrJ,EAAK,CACpBM,OAAQqB,KAAKyK,OAAQ/L,KAAM,SAC3BG,OAAQ2M,EACRvM,UAAWe,KAAK1B,QAAQkM,WAAW/C,WAGvCzH,KAAK0L,aAAerN,EAAK,CACrBM,OAAQqB,KAAK0H,YACbzI,UAAW,gBACXE,cAAe,CAACa,KAAK1B,QAAQoN,gBAGjC1L,KAAK2L,YAActN,EAAK,CACpBM,OAAQqB,KAAK0H,YACbrJ,KAAM2B,KAAK1B,QAAQiL,MACnBtK,UAAW,UAGfe,KAAK4L,cAAgBvN,EAAK,CACtBM,OAAQqB,KAAK0H,YACbzI,UAAW,WACXE,cAAea,KAAK1B,QAAQuN,qBAGhC7L,KAAK8L,iBAED9L,KAAK1B,QAAQyN,UACb/L,KAAK0H,YAAYpD,iBAAiB,YAAcR,GAAM9D,KAAKkL,cAAcpH,IACzE9D,KAAK0H,YAAYpD,iBAAiB,aAAeR,GAAM9D,KAAKkL,cAAcpH,KAE1E9D,KAAK1B,QAAQsK,aACb3F,EAAQjD,KAAK0H,YAAa,IAAM1H,KAAK8I,WAAY,CAAE5F,eAAe,EAAMD,SAAS,KAK7FU,iBAEI3D,KAAKgM,eAAiB3N,EAAK,CACvBM,OAAQqB,KAAK0H,YACbzI,UAAW,gBAGfe,KAAK6I,QAAU,GAEX7I,KAAK1B,QAAQ2N,cACbjM,KAAK6I,QAAQqD,SAAW7N,EAAK,CACzBM,OAAQqB,KAAKgM,eACbtN,KAAM,SACNL,KAAM2B,KAAK1B,QAAQ6N,iBAEvBlJ,EAAQjD,KAAK6I,QAAQqD,SAAU,IAAMlM,KAAKkM,aAG1ClM,KAAK1B,QAAQsK,cACb5I,KAAK6I,QAAQC,SAAWzK,EAAK,CACzBM,OAAQqB,KAAKgM,eACb3N,KAAM2B,KAAK1B,QAAQyK,eACnBrK,KAAM,WAEVuE,EAAQjD,KAAK6I,QAAQC,SAAU,IAAM9I,KAAK8I,aAG1C9I,KAAK1B,QAAQ8N,WACbpM,KAAK6I,QAAQQ,MAAQhL,EAAK,CACtBM,OAAQqB,KAAKgM,eACb3N,KAAM2B,KAAK1B,QAAQ+N,YACnB3N,KAAM,WAEVuE,EAAQjD,KAAK6I,QAAQQ,MAAO,IAAMrJ,KAAKqJ,UAG3C,IAAK,IAAIiD,KAAOtM,KAAK6I,QAAS,CAC1B,MAAM0D,EAASvM,KAAK6I,QAAQyD,GAC5BC,EAAOjI,iBAAiB,YAAa,KACjCiI,EAAOvN,MAAMwN,QAAU,IAE3BD,EAAOjI,iBAAiB,WAAY,KAChCiI,EAAOvN,MAAMwN,QAAU,MAKnC7I,iBAwGAA,iBAAiBxD,EAAOsM,GACpB,MAAMC,EAASD,EAAoB,IAAQ,GACrCE,EAAKxH,KAAKC,IAAIjF,EAAMmL,MAAQtL,KAAKkF,GAAKwH,EACtC/H,EAAOQ,KAAKC,IAAIjF,EAAMmL,OAAStL,KAAKkF,EAAIlF,KAAKoI,SAAWsE,EACxDjE,EAAOtD,KAAKC,IAAIjF,EAAMkL,MAAQrL,KAAKiF,GAAKyH,EACxClE,EAAQrD,KAAKC,IAAIjF,EAAMkL,OAASrL,KAAKiF,EAAIjF,KAAKkI,QAAUwE,EAE9D,IAAIE,EACA3F,EAkBJ,GAfIA,EADA0F,EACW1G,EACJtB,EACIsB,EAEA,KAIX2G,EADAnE,EACaxC,EACNuC,EACMvC,EAEA,KAGb2G,GAAc3F,EACd,OAAOwF,GAAqB,CACxBG,WAAAA,EACA3F,SAAAA,GAIR,IAAI4F,EAAUJ,EAAoB,IAAQ,EAE1C,OACItM,EAAMkL,OAAUrL,KAAKiF,EAAI4H,GACzB1M,EAAMkL,OAAWrL,KAAKiF,EAAIjF,KAAKkI,MAAQ2E,GACvC1M,EAAMmL,OAAUtL,KAAKkF,EAAI2H,GACzB1M,EAAMmL,OAAWtL,KAAKkF,EAAIlF,KAAKoI,OAASyE,EACnCJ,GAAqB,GAEvB,KAGX9I,MAAMG,GACF,MAAM3D,EAAQH,KAAKoL,kBAAkBtH,GAC/BgJ,EAAgB9M,KAAK+M,iBAAiB5M,EAAOH,KAAK+G,WA2BxD,GAvBK/G,KAAK+G,WAAc/G,KAAKgN,cAAclJ,IAAkB,IAAZA,EAAEmJ,QAC/CjN,KAAK+G,UAAY+F,GAchB9M,KAAK+G,WAAc/G,KAAKgN,cAAclJ,IAAkB,IAAZA,EAAEmJ,QAC/CjN,KAAK+G,UAAY+F,GAGhB9M,KAAK+G,WAAc/G,KAAKgN,cAAclJ,IAAkB,IAAZA,EAAEmJ,QAC/CjN,KAAK+G,UAAY+F,GAGA,MAAjBA,EAIA,OAHA9M,KAAKsH,IAAIrI,UAAYe,KAAKsH,IAAIrI,UAAUiO,QAAQ,iBAAkB,IAAIC,OACtEnN,KAAK8G,cAAgB,UACrB9G,KAAK+G,UAAY,MAIrB,GAAI+F,EAAcF,YAAcE,EAAc7F,SAAU,CAC/CjH,KAAK+G,WACN/G,KAAK6B,KAAK,gBAGd,MAAMuL,EAAW,CAAClH,EAAe4G,EAAcF,WAAYE,EAAc7F,UAAUoG,OAAOC,SAASC,KAAK,KACpGvN,KAAKsH,IAAIrI,UAAUuO,SAAStH,GAC5BlG,KAAKsH,IAAIrI,UAAYe,KAAKsH,IAAIrI,UAAUiO,QAAQ,iBAAkBE,GAAUD,OAE5EnN,KAAKsH,IAAIrI,WAAa,IAAImO,EAG9BpN,KAAK6G,SAAU,OAEf7G,KAAK6G,SAAU,EAEf7G,KAAKsH,IAAIrI,UAAYe,KAAKsH,IAAIrI,UAAUiO,QAAQ,iBAAkB,IAAIC,OAG1E,MAAMM,EAAKzN,KAAK8G,cAAgB3G,EAAMkL,MAAQrL,KAAK8G,cAAc7B,EAAI,KAC/DyI,EAAK1N,KAAK8G,cAAgB3G,EAAMmL,MAAQtL,KAAK8G,cAAc5B,EAAI,KAOrE,GALAlF,KAAK8G,cAAgB,CACjB7B,EAAG9E,EAAMkL,MACTnG,EAAG/E,EAAMmL,OAGH,MAANmC,GAAoB,MAANC,EACd,OAAwB,MAAjBZ,EAGX,GAAM9M,KAAKgN,cAAclJ,IAAkB,IAAZA,EAAEmJ,OAS5B,GAAIjN,KAAK6G,QACV7G,KAAK2J,KACD3J,KAAKiF,EAAIwI,EACTzN,KAAKkF,EAAIwI,GAGb1N,KAAK6B,KAAK,OAAQ7B,MAClB8D,EAAE6B,sBACC,GAAI3F,KAAK+G,UAAW,CACvB,MAAM4G,EAAab,EAAc7F,WAAahB,EAAsB,GAAK,EACnE2H,EAAad,EAAcF,aAAe3G,EAAwB,GAAK,EAE7EjG,KAAK2J,KACDmD,EAAcF,YAAc3G,EAAwBjG,KAAKiF,EAAIwI,EAAKG,EAAa5N,KAAKiF,EACpF6H,EAAc7F,UAAYhB,EAAsBjG,KAAKkF,EAAIwI,EAAKC,EAAa3N,KAAKkF,SAtBhFlF,KAAK6G,SACL7G,KAAK6N,YAEL7N,KAAK+G,WACL/G,KAAK8N,cAsBb,GAAI9N,KAAK+G,UAAW,CAChB,MAAM4G,EAAab,EAAc7F,WAAahB,GAAuB,EAAI,EACnE2H,EAAad,EAAcF,aAAe3G,GAAyB,EAAI,EAE7EjG,KAAK+N,OACDjB,EAAcF,WAAa5M,KAAKkI,MAAQuF,EAAKG,EAAa5N,KAAKkI,MAC/D4E,EAAc7F,SAAWjH,KAAKoI,OAASsF,EAAKC,EAAa3N,KAAKoI,QAGlEpI,KAAK0G,UAAY,KACjB1G,KAAK6B,KAAK,SAAU7B,MACpB8D,EAAE6B,iBAGN,OAAwB,MAAjBmH,EAGXnJ,MACQ3D,KAAK6G,SACL7G,KAAK6N,YAEL7N,KAAK+G,WACL/G,KAAK8N,cAIbnK,aACI3D,KAAKsH,IAAIhD,iBAAiB,YAAa,IAAMtE,KAAKwH,SAClDxH,KAAKsH,IAAIhD,iBAAiB,aAAc,IAAMtE,KAAKwH,SAGvD7D,YACI3D,KAAK6G,QAAU,KACf7G,KAAK6B,KAAK,WAAY7B,MAG1B2D,cACI3D,KAAK4G,SAAW5G,KAAK+G,UAAY,KACjC/G,KAAK6B,KAAK,aAAc7B,MAG5B2D,cAAcG,GACV,QAAS8F,OAAOoE,YAAelK,aAAa8F,OAAOoE,WAGvDrK,kBAAkBG,GACd,OAAO9D,KAAKgN,cAAclJ,GAAKA,EAAEgB,eAAe,GAAKhB,EAQzDH,eAAesK,EAAWC,GACtBlO,KAAKgH,kBAAkBiH,GAAaC,EAOxCvK,gBAAgB4E,EAAQD,GACpBtI,KAAKuI,OAASA,EACdvI,KAAKsI,WAAaA,EAClB,IAAIrD,EAAIjF,KAAKiF,EACTC,EAAIlF,KAAKkF,EACbD,EAA0C,UAAtCjF,KAAKgH,kBAAkBE,WAAyBqB,EAAOC,MAAQxI,KAAKkI,MAAQjD,EAChFA,EAA0C,SAAtCjF,KAAKgH,kBAAkB4F,WAAwBrE,EAAOE,KAAOxD,EACjEC,EAAwC,WAApClF,KAAKgH,kBAAkBC,SAAwBsB,EAAOG,OAAS1I,KAAKoI,OAASlD,EACjFA,EAAwC,QAApClF,KAAKgH,kBAAkBC,SAAqBsB,EAAOI,IAAMzD,EAC7DlF,KAAK2J,KAAK1E,EAAGC,GAOjBvB,QAAQwK,GACJ,OAAQA,IAAiBnO,KAAK2G,UAAY3G,KAAK1B,QAAQ8P,MAI3DzK,WACI,OAAO3D,KAAK2G,QAGhB0H,QACI,OAAOC,SAAStO,KAAKsH,IAAItI,MAAMuP,QAEnCF,MAAMtG,GACF/H,KAAKsH,IAAItI,MAAMuP,OAASxG,GAIhC5B,EAAOG,GAAK,ECx9BL,MCkCMkI,EAAgB,CACzBvJ,EAAG,EACHC,EAAG,EACHgD,WAAO3F,EACP6F,YAAQ7F,EACR6L,OAAO,EACPK,cAAc,EAEdjE,WAAY,GAEZJ,SAAU,QACVE,UAAW,OACXoE,aAAc,EACd7P,OAAQ,GAER8P,OAAQ,OACR5C,SAAS,EACTf,WAAW,EACXpC,aAAa,EACbqD,aAAa,EACbG,UAAU,EAEV3E,UAAU,EAEV4E,YD1De,6rBC2DftD,eD3DkuB,2rBC4DluBE,cD5Dg9F,+2BC6Dh9FkD,eD7Dm7C,6kBC+Dn7CyC,iBD/DohE,w6BEKlhEC,EAAqB,CACvBC,QAAQ,EACRC,SAAS,EACTC,KAAM,GACNC,MAPkB,UAQlBC,QAAS,EACTC,UARiB,IAWd,MAAMC,EAaTzL,YAAYyC,EAAI9H,EAAQ,IAEpB0B,KAAKoG,GAAKA,EACVpG,KAAK1B,QAAUQ,OAAOC,OAAO,GAAI8P,EAAoBvQ,GACrD0B,KAAKqP,WAAahR,EAAK,CAAEM,OAAQqB,KAAKoG,GAAG4C,QAASnK,OAAQ,CAAEqL,SAAY,cACxElK,KAAK4M,WAAavO,EAAK,CACnBM,OAAQqB,KAAKqP,WAAYxQ,OAAQ,CAC7B0I,QAAS,OACT2C,SAAU,WACV9B,OAAWpI,KAAK1B,QAAQ6Q,UAAhB,KACRT,aAAiB1O,KAAK1B,QAAQ6Q,UAAhB,KACdxH,gBAAiB3H,KAAK1B,QAAQ2Q,SAGtCjP,KAAKiH,SAAW5I,EAAK,CACjBM,OAAQqB,KAAKqP,WAAYxQ,OAAQ,CAC7B0I,QAAS,OACT2C,SAAU,WACVhC,MAAUlI,KAAK1B,QAAQ6Q,UAAhB,KACPT,aAAiB1O,KAAK1B,QAAQ6Q,UAAhB,KACdxH,gBAAiB3H,KAAK1B,QAAQ2Q,SAGtCjP,KAAK4M,WACL5M,KAAKsP,QAAU,GAGnB3L,OAEI3D,KAAKqP,WAAWE,SAChBvP,KAAKwP,SAAU,EAGnB7L,UAAU2D,GAENA,EAAI5E,GAAG,OAAQ,IAAM1C,KAAK2J,KAAKrC,IAC/BA,EAAI5E,GAAG,WAAY,IAAM1C,KAAKyP,QAAQnI,IAG1C3D,WAAW+L,EAAM9C,EAAY3F,GAEzB,MAAMiB,EAAQ1J,SAASmR,KAAKC,YACtBxH,EAAS5J,SAASmR,KAAKE,aACzBH,EAAKjH,KAAOzI,KAAK1B,QAAQ0Q,MAAQ9G,GAASwH,EAAKlH,MAAQxI,KAAK1B,QAAQ0Q,MAAQ,IAExE7J,KAAKC,IAAIsK,EAAK/G,IAAM,IAAM3I,KAAK1B,QAAQ0Q,KAEvCpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAK/G,IAAM,GAAIF,KAAM,EAAGP,MAAAA,EAAOS,IAAK,EAAGoH,KAAM,MAAOjB,QAAQ,IAE5F3J,KAAKC,IAAIsK,EAAKhH,OAASN,IAAWpI,KAAK1B,QAAQ0Q,MAEpDpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKhH,OAASN,GAASK,KAAM,EAAGP,MAAAA,EAAOS,IAAKP,EAAQ2H,KAAM,SAAUjB,QAAQ,KAGrHY,EAAK/G,IAAM3I,KAAK1B,QAAQ0Q,MAAQ5G,GAAUsH,EAAKhH,OAAS1I,KAAK1B,QAAQ0Q,MAAQ,IAEzE7J,KAAKC,IAAIsK,EAAKjH,KAAO,IAAMzI,KAAK1B,QAAQ0Q,KAExC/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKjH,KAAO,GAAIE,IAAK,EAAGP,OAAAA,EAAQK,KAAM,EAAGsH,KAAM,OAAQjB,QAAQ,IAE7F3J,KAAKC,IAAIsK,EAAKlH,MAAQN,IAAUlI,KAAK1B,QAAQ0Q,MAElD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKlH,MAAQN,GAAQS,IAAK,EAAGP,OAAAA,EAAQK,KAAMP,EAAO6H,KAAM,QAASjB,QAAQ,KAKxHnL,YAAYqM,EAAUN,EAAM9C,EAAY3F,GAEpC,IAAK,IAAIK,KAAOtH,KAAKoG,GAAG2I,QAEpB,IAAKzH,EAAIhJ,QAAQ2R,QAAU3I,IAAQ0I,EACnC,CACI,MAAME,EAAQ5I,EAAIA,IAAI6I,wBAClBT,EAAKjH,KAAOzI,KAAK1B,QAAQ0Q,MAAQkB,EAAM1H,OAASkH,EAAKlH,MAAQxI,KAAK1B,QAAQ0Q,MAAQkB,EAAMzH,OAEpFtD,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMxH,SAAW1I,KAAK1B,QAAQ0Q,MAElDpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMxH,QAASD,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMxH,OAAQqH,KAAM,QAC1H5K,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAMzH,OAASzI,KAAK1B,QAAQ0Q,KAEjD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAMzH,MAAOE,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAMzH,KAAMsH,KAAM,OAAQK,WAAW,IAExIjL,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAM1H,QAAUxI,KAAK1B,QAAQ0Q,MAExD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAM1H,OAAQG,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAM1H,MAAOuH,KAAM,QAASK,WAAW,KAGhJjL,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMvH,MAAQ3I,KAAK1B,QAAQ0Q,OAEvDpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMvH,KAAMF,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMvH,IAAKoH,KAAM,WACvH5K,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAMzH,OAASzI,KAAK1B,QAAQ0Q,KAEjD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAMzH,MAAOE,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAMzH,KAAMsH,KAAM,OAAQK,WAAW,IAExIjL,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAM1H,QAAUxI,KAAK1B,QAAQ0Q,MAExD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAM1H,OAAQG,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAM1H,MAAOuH,KAAM,QAASK,WAAW,MAIzJV,EAAK/G,IAAM3I,KAAK1B,QAAQ0Q,MAAQkB,EAAMxH,QAAUgH,EAAKhH,OAAS1I,KAAK1B,QAAQ0Q,MAAQkB,EAAMvH,MAErFxD,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAM1H,QAAUxI,KAAK1B,QAAQ0Q,MAElD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKjH,KAAOyH,EAAM1H,OAAQG,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAM1H,MAAOuH,KAAM,SACxH5K,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMvH,MAAQ3I,KAAK1B,QAAQ0Q,KAE/CpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMvH,KAAMF,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMvH,IAAKoH,KAAM,MAAOK,WAAW,IAErIjL,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMxH,SAAW1I,KAAK1B,QAAQ0Q,MAE1DpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMxH,QAASD,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMxH,OAAQqH,KAAM,SAAUK,WAAW,KAGrJjL,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAMzH,OAASzI,KAAK1B,QAAQ0Q,OAEvD/H,EAASzG,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKlH,MAAQ0H,EAAMzH,MAAOE,IAAKuH,EAAMvH,IAAKP,OAAQ8H,EAAM9H,OAAQK,KAAMyH,EAAMzH,KAAMsH,KAAM,UACvH5K,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMvH,MAAQ3I,KAAK1B,QAAQ0Q,KAE/CpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAK/G,IAAMuH,EAAMvH,KAAMF,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMvH,IAAKoH,KAAM,MAAOK,WAAW,IAErIjL,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMxH,SAAW1I,KAAK1B,QAAQ0Q,MAE1DpC,EAAWpM,KAAK,CAAEsP,SAAU3K,KAAKC,IAAIsK,EAAKhH,OAASwH,EAAMxH,QAASD,KAAMyH,EAAMzH,KAAMP,MAAOgI,EAAMhI,MAAOS,IAAKuH,EAAMxH,OAAQqH,KAAM,SAAUK,WAAW,OAQ9KzM,KAAK2D,GAED,GAAItH,KAAKwP,SAAWlI,EAAIhJ,QAAQ2R,QAAU3I,EAAI+I,UAE1C,OAEJrQ,KAAK4M,WAAW5N,MAAMuI,QAAU,OAChCvH,KAAKiH,SAASjI,MAAMuI,QAAU,OAC9B,MAAMqF,EAAa,GACb3F,EAAW,GACXyI,EAAOpI,EAAIA,IAAI6I,wBASrB,GARInQ,KAAK1B,QAAQwQ,QAEb9O,KAAKsQ,WAAWZ,EAAM9C,EAAY3F,GAElCjH,KAAK1B,QAAQyQ,SAEb/O,KAAKuQ,YAAYjJ,EAAKoI,EAAM9C,EAAY3F,GAExC2F,EAAWlL,OACf,CACIkL,EAAW4D,KAAK,CAACC,EAAGC,IAAeD,EAAEX,SAAWY,EAAEZ,UAClD,MAAMa,EAAO/D,EAAW,GACxB5M,KAAK4M,WAAW5N,MAAMuI,QAAU,QAChCvH,KAAK4M,WAAW5N,MAAMkJ,MAAQyI,EAAKzI,MAAQ,KAC3ClI,KAAK4M,WAAW1H,EAAIyL,EAAKhI,IAAM3I,KAAK1B,QAAQ6Q,UAAY,EACxDnP,KAAK4M,WAAW5N,MAAMiJ,UAAY,aAAa0I,EAAKlI,UAAUzI,KAAK4M,WAAW1H,OAC9ElF,KAAK4M,WAAWmD,KAAOY,EAAKZ,KAC5B/P,KAAK4M,WAAWwD,UAAYO,EAAKP,UACjCpQ,KAAK4M,WAAWkC,OAAS6B,EAAK7B,OAElC,GAAI7H,EAASvF,OACb,CACIuF,EAASuJ,KAAK,CAACC,EAAGC,IAAeD,EAAEX,SAAWY,EAAEZ,UAChD,MAAMa,EAAO1J,EAAS,GACtBjH,KAAKiH,SAASjI,MAAMuI,QAAW,QAC/BvH,KAAKiH,SAASjI,MAAMoJ,OAASuI,EAAKvI,OAAS,KAC3CpI,KAAKiH,SAAShC,EAAI0L,EAAKlI,KAAOzI,KAAK1B,QAAQ6Q,UAAY,EACvDnP,KAAKiH,SAASjI,MAAMiJ,UAAY,aAAajI,KAAKiH,SAAShC,OAAO0L,EAAKhI,SACvE3I,KAAKiH,SAAS8I,KAAOY,EAAKZ,KAC1B/P,KAAKiH,SAASmJ,UAAYO,EAAKP,UAC/BpQ,KAAKiH,SAAS6H,OAAS6B,EAAK7B,QAIpCnL,QAAQ2D,GAEJ,IAAItH,KAAKwP,QAAT,CAIA,GAAsC,UAAlCxP,KAAK4M,WAAW5N,MAAMuI,QAC1B,CACI,MAAM2H,EAAUlP,KAAK4M,WAAWwD,UAAY,EAAIpQ,KAAK1B,QAAQ4Q,QACvD0B,EAAStJ,EAAIuJ,WAAavJ,EAAIc,OAASd,EAAIc,OAASd,EAAIuJ,UAAUC,QAAU,EAAI,EACtF,OAAQ9Q,KAAK4M,WAAWmD,MAEpB,IAAK,MACDzI,EAAIpC,EAAIlF,KAAK4M,WAAW1H,EAAI0L,EAAS1B,EAAUlP,KAAK1B,QAAQ6Q,UAAY,EACxE,MAEJ,IAAK,SACD7H,EAAIoB,OAASvD,KAAK4L,MAAM/Q,KAAK4M,WAAW1H,EAAI0L,EAAS1B,EAAUlP,KAAK1B,QAAQ6Q,UAAY,GAGhG7H,EAAI0J,eAAe,WAAYhR,KAAK4M,WAAWkC,OAAS9O,KAAK4M,WAAWmD,KAAO,IAEnF,GAAoC,UAAhC/P,KAAKiH,SAASjI,MAAMuI,QACxB,CACI,MAAM2H,EAAUlP,KAAKiH,SAASmJ,UAAY,EAAIpQ,KAAK1B,QAAQ4Q,QACrD0B,EAAStJ,EAAIuJ,WAAavJ,EAAIY,MAAQZ,EAAIY,MAAQZ,EAAIuJ,UAAUI,QAAU,EAAI,EACpF,OAAQjR,KAAKiH,SAAS8I,MAElB,IAAK,OACDzI,EAAIrC,EAAIjF,KAAKiH,SAAShC,EAAI2L,EAAS1B,EAAUlP,KAAK1B,QAAQ6Q,UAAY,EACtE,MAEJ,IAAK,QACD7H,EAAIkB,MAAQrD,KAAK4L,MAAM/Q,KAAKiH,SAAShC,EAAI2L,EAAS1B,EAAUlP,KAAK1B,QAAQ6Q,UAAY,GAG7F7H,EAAI0J,eAAe,aAAchR,KAAKiH,SAAS6H,OAAS9O,KAAKiH,SAAS8I,KAAO,IAEjF/P,KAAK4M,WAAW5N,MAAMuI,QAAUvH,KAAKiH,SAASjI,MAAMuI,QAAU,SC5OtE,MAAM2J,EAAuB,CACzBvS,OAAQH,SAASmR,KACjBwB,OAAO,EACP7I,YAAY,EACZ0G,MAAM,8BAaH,MASHrL,YAAYrF,EAAU,GAAIyE,EAAiB,IACvC/C,KAAK+O,QAAU,GACf/O,KAAKyG,OAAS,KACdzG,KAAK1B,QAAUQ,OAAOC,OAAO,GAAImS,EAAsB5S,GACvD0B,KAAK+C,eAAiBjE,OAAOC,OAAO,GAAIyP,EAAezL,GAClD/C,KAAK1B,QAAQ6S,OACd3M,QAAQ4M,IAAI,2CAA4C,kBAE5DpR,KAAKqR,WAAW/S,EAAQK,QAAUH,SAASmR,MACvC3P,KAAK1B,QAAQ0Q,MACbhP,KAAKgP,MAA2B,IAAtBhP,KAAK1B,QAAQ0Q,KAAgB,GAAKhP,KAAK1B,QAAQ0Q,MAE7DpF,OAAOtF,iBAAiB,SAAU,IAAMtE,KAAK+N,UAajDpK,aAAarF,EAAU,IACnB,MAAMgJ,EAAM,IAAInB,EAAOnG,KAAMlB,OAAOC,OAAO,GAAIiB,KAAK+C,eAAgBzE,IAgBpE,OAfAgJ,EAAI5E,GAAG,OAAQ,IAAM1C,KAAKsR,MAAMhK,IAChCA,EAAI5E,GAAG,QAAS,IAAM1C,KAAKuR,OAAOjK,IAClCA,EAAI5E,GAAG,OAAQ,IAAM1C,KAAKwR,MAAMlK,IAChCA,EAAI5E,GAAG,QAAS,IAAM1C,KAAKyR,OAAOnK,IAClCA,EAAIA,IAAIhD,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IACxDwD,EAAIA,IAAIhD,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IACxDwD,EAAIA,IAAIhD,iBAAiB,UAAYR,GAAM9D,KAAK2R,IAAI7N,IACpDwD,EAAIA,IAAIhD,iBAAiB,WAAaR,GAAM9D,KAAK2R,IAAI7N,IACjD9D,KAAK4R,QAAUtT,EAAQ2R,QACvBjQ,KAAK4R,MAAMC,UAAUvK,GAEzBA,EAAIwK,gBAAgB9R,KAAKuI,OAAQvI,KAAK1B,QAAQgK,YAC1ChB,EAAIhJ,QAAQmQ,cACZnH,EAAIgC,OAEDhC,EAUX3D,aAAa2D,GAcT,OAbAA,EAAI5E,GAAG,OAAQ1C,KAAKsR,MAAOtR,MAC3BsH,EAAI5E,GAAG,QAAS1C,KAAKuR,OAAQvR,MAC7BsH,EAAI5E,GAAG,OAAQ1C,KAAKwR,MAAOxR,MAC3BsH,EAAI5E,GAAG,QAAS1C,KAAKyR,OAAQzR,MAC7BA,KAAKsH,IAAI1I,YAAY0I,EAAIA,KACzBA,EAAIlB,GAAKpG,KACTsH,EAAIA,IAAIhD,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IACxDwD,EAAIA,IAAIhD,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IACxDwD,EAAIA,IAAIhD,iBAAiB,UAAYR,GAAM9D,KAAK2R,IAAI7N,IACpDwD,EAAIA,IAAIhD,iBAAiB,WAAaR,GAAM9D,KAAK2R,IAAI7N,IACjD9D,KAAK4R,QAAU5R,KAAK+C,eAAekN,QACnCjQ,KAAK4R,MAAMC,UAAUvK,GAElBA,EAOX3D,KAAKrF,GACD0B,KAAK4R,MAAQ,IAAIxC,EAAKpP,KAAM1B,GAC5B,IAAK,IAAIgJ,KAAOtH,KAAK+O,QACZzH,EAAIhJ,QAAQ2R,QACbjQ,KAAK4R,MAAMC,UAAUvK,GASjC3D,YAAY2D,GACR,MAAMyK,EAAQ/R,KAAK+O,QAAQiD,QAAQ1K,GACnC9C,QAAQyN,QAAkB,IAAXF,EAAc,kDACzBA,IAAU/R,KAAK+O,QAAQrN,OAAS,IAChC1B,KAAK+O,QAAQmD,OAAOH,EAAO,GAC3B/R,KAAK+O,QAAQvO,KAAK8G,GAClBtH,KAAKmS,YAQbxO,WAAW2D,GACP,MAAMyK,EAAQ/R,KAAK+O,QAAQiD,QAAQ1K,GACnC9C,QAAQyN,QAAkB,IAAXF,EAAc,kDACf,IAAVA,IACA/R,KAAK+O,QAAQmD,OAAOH,EAAO,GAC3B/R,KAAK+O,QAAQqD,QAAQ9K,GACrBtH,KAAKmS,YAQbxO,OACI,MAAMyF,EAAO,GACb,IAAK,IAAI5H,EAAI,EAAGA,EAAIxB,KAAK+O,QAAQrN,OAAQF,IAAK,CAC1C,MAAM6Q,EAAQrS,KAAK+O,QAAQvN,GAC3B4H,EAAKiJ,EAAM/L,IAAM+L,EAAMC,OACvBlJ,EAAKiJ,EAAM/L,IAAIiM,MAAQ/Q,EAE3B,OAAO4H,EAQXzF,KAAKyF,GACD,IAAK,IAAI5H,EAAI,EAAGA,EAAIxB,KAAK+O,QAAQrN,OAAQF,IAAK,CAC1C,MAAM6Q,EAAQrS,KAAK+O,QAAQvN,GACvB4H,EAAKiJ,EAAM/L,KACX+L,EAAMG,KAAKpJ,EAAKiJ,EAAM/L,MASlC3C,WACI,IAAK,IAAI2D,KAAOtH,KAAK+O,QACjBzH,EAAI+B,QAERrJ,KAAK+O,QAAU,GACf/O,KAAKyG,OAAS,KAQlB9C,WACI,IAAInC,EAAI,EACR,IAAK,MAAM8F,KAAOtH,KAAK+O,QACdzH,EAAImL,aACLnL,EAAI+G,EAAI7M,KAQpBmC,WAAWhF,GAMPqB,KAAKsH,IAAMjJ,EAAK,CACZM,OAAAA,EAAQE,OAAQ,CACZmL,cAAe,OACf9B,MAAS,OACTE,OAAU,OACV6B,SAAY,SACZyI,WAAY,EACZC,OAAU,aASlB3S,KAAKgJ,QAAU3K,EAAK,CAChBM,OAAQqB,KAAKsH,IAAKzI,OAAQ,CACtBmL,cAAe,OACfE,SAAY,WACZvB,IAAO,EACPF,KAAQ,EACRP,MAAS,OACTE,OAAU,OACV6B,SAAY,YAGpBjK,KAAKgJ,QAAQ1E,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IAC7D9D,KAAKgJ,QAAQ1E,iBAAiB,YAAcR,GAAM9D,KAAK0R,MAAM5N,IAC7D9D,KAAKgJ,QAAQ1E,iBAAiB,UAAYR,GAAM9D,KAAK2R,IAAI7N,IACzD9D,KAAKgJ,QAAQ1E,iBAAiB,WAAaR,GAAM9D,KAAK2R,IAAI7N,IAE1D9D,KAAK4S,aAAevU,EAAK,CACrBM,OAAQqB,KAAKsH,IACbzI,OAAQ,CACJ0I,QAAW,OACXyC,cAAe,OACfE,SAAY,WACZvB,IAAO,EACPF,KAAQ,EACRP,MAAS,OACTE,OAAU,OACV6B,SAAY,SACZ4I,WAAc7S,KAAK+C,eAAe+P,mBAG1C9S,KAAK4S,aAAatO,iBAAiB,YAAcR,IAAQ9D,KAAK0R,MAAM5N,GAAIA,EAAE6B,iBAAkB7B,EAAEqH,oBAC9FnL,KAAK4S,aAAatO,iBAAiB,YAAcR,IAAQ9D,KAAK0R,MAAM5N,GAAIA,EAAE6B,iBAAkB7B,EAAEqH,oBAC9FnL,KAAK4S,aAAatO,iBAAiB,UAAYR,IAAQ9D,KAAK2R,IAAI7N,GAAIA,EAAE6B,iBAAkB7B,EAAEqH,oBAC1FnL,KAAK4S,aAAatO,iBAAiB,WAAaR,IAAQ9D,KAAK2R,IAAI7N,GAAIA,EAAE6B,iBAAkB7B,EAAEqH,oBAC3FnL,KAAK4S,aAAatO,iBAAiB,YAAcR,IAAQA,EAAE6B,iBAAkB7B,EAAEqH,oBAC/EnL,KAAK4S,aAAatO,iBAAiB,aAAeR,IAAQA,EAAE6B,iBAAkB7B,EAAEqH,oBAGpFxH,MAAM2D,GACFtH,KAAK+O,QAAQvO,KAAK8G,GAClBtH,KAAKmS,WACD7K,EAAIhJ,QAAQ8P,OACZpO,KAAK4S,aAAa5T,MAAMuI,QAAU,QAClCvH,KAAK4S,aAAa5T,MAAMuP,OAASjH,EAAI+G,GAGrCrO,KAAK4S,aAAa5T,MAAMuI,QAAU,OAI1C5D,OAAO2D,GACH,GAAItH,KAAKyG,SAAWa,EAChB,OAEAtH,KAAKyG,QACLzG,KAAKyG,OAAOsM,OAEhB,MAAMhB,EAAQ/R,KAAK+O,QAAQiD,QAAQ1K,GACnC9C,QAAQyN,QAAkB,IAAXF,EAAc,2DACzBA,IAAU/R,KAAK+O,QAAQrN,OAAS,IAChC1B,KAAK+O,QAAQmD,OAAOH,EAAO,GAC3B/R,KAAK+O,QAAQvO,KAAK8G,IAEtBtH,KAAKmS,WACLnS,KAAKyG,OAASzG,KAAK+O,QAAQ/O,KAAK+O,QAAQrN,OAAS,GAGrDiC,MAAM2D,GACEtH,KAAKyG,SAAWa,IAChBtH,KAAKyG,OAAS,MAItB9C,OAAO2D,GACH,MAAMyK,EAAQ/R,KAAK+O,QAAQiD,QAAQ1K,GACnC9C,QAAQyN,QAAkB,IAAXF,EAAc,2DAC7B/R,KAAK+O,QAAQmD,OAAOH,EAAO,GAC3B,MAAMiB,EAAOhT,KAAK+O,QAAQ/O,KAAK+O,QAAQrN,OAAS,GAC5C4F,EAAI+I,SAAQ,KACR2C,GAAQA,EAAK3C,UACbrQ,KAAK4S,aAAa5T,MAAMuP,OAASyE,EAAK3E,EAGtCrO,KAAK4S,aAAa5T,MAAMuI,QAAU,QAG1CyL,EAAKxL,QAGT7D,MAAMG,GACF,IAAK,IAAItC,EAAIxB,KAAK+O,QAAQrN,OAAS,EAAGF,GAAK,EAAGA,IAAK,CAC/C,MAAM8F,EAAMtH,KAAK+O,QAAQvN,GACnByR,EAAW3L,EAAIoK,MAAM5N,GAC3B,GAAImP,EAAU,CACV,MAAMlB,EAAQ/R,KAAK+O,QAAQiD,QAAQ1K,GAEnCtH,KAAK+O,QAAQmD,OAAOH,EAAO,GAC3B/R,KAAK+O,QAAQvO,KAAK8G,GAClB,MAEJ9C,QAAQ4M,IAAI6B,IAIpBtP,IAAIG,GACA,IAAK,MAAMwI,KAAOtM,KAAK+O,QACnB/O,KAAK+O,QAAQzC,GAAKqF,IAAI7N,GAI9BH,WAAW2D,GACP,OAAQtH,KAAKoO,OAASpO,KAAKoO,QAAU9G,EAIzCiB,aACI,MAAO,CACHI,IAAK3I,KAAKsH,IAAI4L,UACdxK,OAAQ1I,KAAKsH,IAAI4L,UAAYlT,KAAKsH,IAAIe,aACtCI,KAAMzI,KAAKsH,IAAI6L,WACf3K,MAAOxI,KAAKsH,IAAI6L,WAAanT,KAAKsH,IAAIa,aAI9CxE,SACI,MAAM4E,EAASvI,KAAKuI,OACpB,IAAK,MAAM+D,KAAOtM,KAAK+O,QACnB/O,KAAK+O,QAAQzC,GAAKwF,gBAAgBvJ,EAAQvI,KAAK1B,QAAQgK"}
>>>>>>> refactor-window
